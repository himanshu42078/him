<group name="zscaler-decoy,">
    <rule id="101200" level="0" noalert="1">
        <decoded_as>json</decoded_as>
        <field name="productName" type="pcre2">(?i)^Zscaler-Decoy$</field>
        <description>Zscaler-Decoy Log event detected.</description>
    </rule>
    
    <rule id="101201" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^aws$</field>
        <description>Zscaler-Decoy: AWS Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101202" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^azure$</field>
        <description>Zscaler-Decoy: Azure Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101203" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^credtheft$</field>
        <description>Zscaler-Decoy: Credtheft Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101204" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^email$</field>
        <description>Zscaler-Decoy: Email Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101205" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^filetheft$</field>
        <description>Zscaler-Decoy: Filetheft Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101206" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^amqp$</field>
        <description>Zscaler-Decoy:IoT protocol AMQP interaction detected</description>
        <group>high,one-on-one,s-a,T1040,credential-access,T1557.002,T1029,exfiltration,T1486,impact,T1071.001,</group>
        <mitre>
            <id>T1040</id>
            <id>T1557.002</id>
            <id>T1029</id>
            <id>T1486</id>
            <id>T1071.001</id>
        </mitre>
        <info type="text">
        Description:
         AMQP interaction was detected against an IoT decoy.  Adversaries attempt to access AMQP brokers with the goal of either stealing sensitive information or injecting malicious data.
        </info>
    </rule>
    <rule id="101207" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^network$</field>
        <description>Zscaler-Decoy: Network Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101208" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^endpoint$</field>
        <description>Zscaler-Decoy: Endpoint Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101209" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^itdr$</field>
        <description>Zscaler-Decoy: Itdr Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101210" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^ransomware$</field>
        <description>Zscaler-Decoy:Endpoint - Ransomware-like behavior detected</description>
        <group>high,one-on-one,s-a,T1105,command-control,T1070.004,defense-evasion,T1082,discovery,T1135,discovery,T1569.002,</group>
        <mitre>
            <id>T1105</id>
            <id>T1070.004</id>
            <id>T1082</id>
            <id>T1135</id>
            <id>T1569.002</id>
        </mitre>
        <info type="text">
        Description:
         One or more indicators of ransomware execution and propogation were detected, suggesting that the system is infected.  Specific indicators can be found in the attacker.event_name field in the event logs.
        </info>
    </rule>
    <rule id="101211" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^mitm$</field>
        <description>Zscaler-Decoy:LLMNR / NBT-NS / mDNS poisoning attempt detected</description>
        <group>high,one-on-one,s-a,T1557.001,credential-access,T1071.001,command-control,T1557.002,T1110.003,T1003.006,</group>
        <mitre>
            <id>T1557.001</id>
            <id>T1071.001</id>
            <id>T1557.002</id>
            <id>T1110.003</id>
            <id>T1003.006</id>
        </mitre>
        <info type="text">
        Description:
         Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of hostname resolution. LLMNR / NBT-NS is the fallback mechanism for hostname resolution when hosts file lookups and DNS resolution fail. The machine sends a broadcast request on the local subnet to resolve a hostname. A similar process is implemented by mDNS (or Multicast DNS). Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137)/mDNS (UDP 5353) traffic as though they know the identity of the requested host. This effectively poisons the service so victims will communicate with the adversary-controlled system. The username and NTLMv2 hash will then be sent to the adversary-controlled system if the requested host requires authentication. The adversary can then crack the hashes offline to obtain plaintext passwords.
        </info>
    </rule>
    <rule id="101212" level="1" noalert="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^mongodb$</field>
        <description>Zscaler-Decoy:MongoDB interaction detected</description>
        <group>high,one-on-one,s-a,T1552.001,credential-access,T1071.001,command-control,T1059.007,execution,T1213.003,collection,T1496,</group>
        <mitre>
            <id>T1552.001</id>
            <id>T1071.001</id>
            <id>T1059.007</id>
            <id>T1213.003</id>
            <id>T1496</id>
        </mitre>
        <info type="text">
        Description:
         Adversaries target database servers primarily to extract sensitive information. In some cases, databases may provide command execution capabilities.  Such access to decoy databases should be investigated to determine the adversary's objective.
        </info>
    </rule>
    <rule id="101213" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^postgresql$</field>
        <description>Zscaler-Decoy: Postgresql Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101214" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^recon$</field>
        <description>Zscaler-Decoy: Recon Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101215" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^ssh$</field>
        <description>Zscaler-Decoy: SSH Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101216" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^telnet$</field>
        <description>Zscaler-Decoy: Telnet Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101217" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^web$</field>
        <description>Zscaler-Decoy: Web Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101218" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^SCADA$</field>
        <description>Zscaler-Decoy: SCADA Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <rule id="101219" level="0">
        <if_sid>101200</if_sid>
        <field name="type" type="pcre2">(?i)^windows$</field>
        <description>Zscaler-Decoy: Windows Type log detected</description>
        <group>low,one-on-one,T1078,T1078.003,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text"></info>
    </rule>
    <!--Sub Rule-->
    <rule id="101220" level="1">
        <if_sid>101201</if_sid>
        <field name="sub_type" type="pcre2">(?i)^iam$</field>
        <description>Zscaler-Decoy: AWS IAM decoy credentials used to make API calls</description>
        <group>high,one-on-one,s-a,T1078,T1078.003,defense-evasion,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.003</id>
        </mitre>
        <info type="text">
        Description:
           fake AWS login details (IAM decoy credentials) to try and run commands in AWS. They do this to search for important accounts with more access, allowing them to move through the system and gain higher privileges. If these fake credentials are part of special security traps (Landmine policies), it could mean that some systems or users might be at risk of being compromised.
        </info>
    </rule>
    <rule id="101221" level="1">
        <if_sid>101201</if_sid>
        <field name="sub_type" type="pcre2">(?i)^vmsnapshot$</field>
        <description>Zscaler-Decoy: AWS snapshot or AMI was stolen with live instance created</description>
        <group>high,one-on-one,s-a,T1078,T1530,defense-evasion,collection,T1210,lateral-movement,</group>
        <mitre>
            <id>T1078</id>
            <id>T1530</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
           An AWS snapshot or AMI (Amazon Machine Image) may have been stolen, and a new instance was created from it. Attackers can secretly extract sensitive files or credentials from the stolen snapshot/AMI, allowing them to gain higher privileges or identify new targets for further attacks. They may search for publicly available AMIs in the AWS catalog using keywords linked to your organization, or they may gain access to an identity that has permission to view and list snapshots/AMIs.
        </info>
    </rule>
    <!-- Azure-->
    <rule id="101222" level="1">
        <if_sid>101202</if_sid>
        <field name="sub_type" type="pcre2">(?i)^app_service$</field>
        <field name="azure.properties.cs_uri_query" type="pcre2">.*cmd=.*/</field>
        <description>Zscaler-Decoy:Azure App Service decoy was exploited with code execution</description>
        <group>high,one-on-one,s-a,T1078,T1203,defense-evasion,execution,T1589,reconnaissance,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1589</id>
        </mitre>
        <info type="text">
        Description:
           Azure AppService decoy was exploited with code execution to run some commands on the underlying host OS. This is a high alert which needs to be investigated on priority.
        </info>
    </rule>
    <rule id="101223" level="1">
        <if_sid>101202</if_sid>
        <field name="sub_type" type="pcre2">(?i)^app_service$</field>
        <field name="azure.properties.cs_host" type="pcre2">.*scm.azurewebsites.net.*/</field>
        <description>Zscaler-Decoy:Azure App Service decoy's kudu endpoint was exploited with code execution</description>
        <group>high,one-on-one,s-a,T1078,T1190,defense-evasion,initial-access,T1059,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
           Azure AppService decoy was exploited with code execution using kudu endpoint. This is a high alert which needs to be investigated on priority.
        </info>
    </rule>
    <rule id="101224" level="1">
        <if_sid>101202</if_sid>
        <field name="azure.identity.claim.appid" type="pcre2">.*</field>
        <field name="azure.identity.claim.http_schemas_microsoft_com_identity_claims_objectidentifier" type="pcre2">.*</field>
        <description>Zscaler-Decoy:Azure Managed Identity decoy attached to a production resources was exploited</description>
        <group>high,one-on-one,s-a,T1078,T1098,defense-evasion,persistence,T1071,T1071.001,command and control,</group>
        <mitre>
            <id>T1098</id>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          A Managed Identity connected to a production resource was used to access decoys, indicating that the production resource may be compromised. If this Managed Identity has high privileges, the attacker could gain access to more high resources within the production environment.
          
            <!--An account (Managed Identity) connected to a real system (production resource) was used to access fake traps (decoys). This shows that the real system might be hacked. If the account has a lot of access, the attacker could reach more important parts of the system.-->
        </info>
    </rule>
    <rule id="101225" level="1">
        <if_sid>101202</if_sid>
        <field name="sub_type" type="pcre2">(?i)^azure_service_principal$</field>
        <description>Zscaler-Decoy:Azure Service Principal decoy credentials used to make API calls</description>
        <group>high,one-on-one,s-a,T1078,T1098,defense-evasion,persistence,T1210,lateral-movement,</group>
        <mitre>
            <id>T1098</id>
            <id>T1210</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          Azure Service Principal credentials were used to authenticate and execute API calls. Attackers may be searching for high-privilege cloud accounts to move within the cloud and escalate privileges. If these credentials are tied to sensitive policies, there is a risk of compromise to one or more systems or users.
        </info>
    </rule>
    <rule id="101226" level="1">
        <if_sid>101202</if_sid>
        <field name="sub_type" type="pcre2">(?i)^azure_user$</field>
        <description>Zscaler-Decoy:Azure user decoy credentials used to make API calls</description>
        <group>high,one-on-one,s-a,T1078,T1098,defense-evasion,persistence,T1210,lateral-movement,</group>
        <mitre>
            <id>T1098</id>
            <id>T1210</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          Attackers used decoy Azure user account credentials to authenticate and make API calls. They may be searching for high-privilege cloud accounts to move around the cloud and escalate access. If these decoy credentials are tied to sensitive policies, it could lead to the compromise of systems or users.
          
            <!--Attackers used fake Azure user accounts to make API calls. They might be looking for important accounts to gain more control. If these fake credentials are linked to high policies, it could risk your systems or users.-->
        </info>
    </rule>
    <!--credtheft-->
    <rule id="101227" level="1">
        <if_sid>101203</if_sid>
        <field name="credtheft.event_id" type="pcre2" negate="yes">(?i)^4769$</field>
        <field name="sub_type" type="pcre2" negate="yes">(?i)^honeypot-buster$</field>
        <description>Zscaler-Decoy:Decoy Active Directory account usage detected</description>
        <group>high,one-on-one,s-a,T1078,T1087.002,defense-evasion,persistence,T1078.002,T1087,</group>
        <mitre>
            <id>T1078</id>
            <id>T1078.002</id>
            <id>T1087</id>
            <id>T1087.002</id>
        </mitre>
        <info type="text">
        Description:
          Someone tried to log in using a fake user account. Since decoy accounts shouldn’t be used, this is a serious issue because it could mean an attacker is trying to gain more control.
        </info>
    </rule>
    <rule id="101228" level="1">
        <if_sid>101203</if_sid>
        <field name="credtheft.event_id" type="pcre2">(?i)^4768$</field>
        <field name="credtheft.pre_auth_type" type="pcre2">(?i)^0$</field>
        <description>Zscaler-Decoy:Possible ASREPRoasting attack</description>
        <group>high,one-on-one,s-a,T1078,T1087,T1087.002,defense-evasion,persistence,T1558,T1558.004,credential-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1558</id>
            <id>T1558.004</id>
            <id>T1087</id>
            <id>T1087.002</id>
        </mitre>
        <info type="text">
        Description:
          A fake Active Directory user was targeted in an ASREPRoasting attack. This technique is used by attackers to steal credentials from users who have Kerberos pre-authentication disabled. The attacker gets the user’s Ticket Granting Ticket (TGT) and tries to crack it offline. This attack targeted a decoy account, showing that the attacker was trying to steal credentials.
        </info>
    </rule>
    <rule id="101229" level="1">
        <if_sid>101203</if_sid>
        <field name="sub_type" type="pcre2">(?i)^honeypot-buster$</field>
        <description>Zscaler-Decoy:LDAP enumeration attempt detected</description>
        <group>high,one-on-one,s-a,T1016,T1087,T1087.002,discovery,T1018,</group>
        <mitre>
            <id>T1016</id>
            <id>T1018</id>
            <id>T1087</id>
            <id>T1087.002</id>
        </mitre>
        <info type="text">
        Description:
          Fake Active Directory objects were targeted by suspicious scans using tools like PowerSploit or Honeypot Buster. This is often a warning sign of future attacks on Active Directory. The recorded username was trying to gather information about the decoy objects.
        </info>
    </rule>
    <rule id="101230" level="1">
        <if_sid>101203</if_sid>
        <field name="credtheft.event_id" type="pcre2">(?i)^4769$</field>
        <description>Zscaler-Decoy:Possible Kerberoasting attack</description>
        <group>high,one-on-one,s-a,T1078,T1558,T1558.003,defense-evasion,persistence,credential-access,T1087,T1087.002,</group>
        <mitre>
            <id>T1078</id>
            <id>T1558</id>
            <id>T1558.003</id>
            <id>T1087</id>
            <id>T1087.002</id>
        </mitre>
        <info type="text">
        Description:
          A fake Active Directory user was targeted in a possible Kerberoasting attack. In Kerberos, Service Principal Names (SPNs) are linked to service accounts. Attackers can request tickets for these service accounts, which may be weakly encrypted. If they crack the ticket, they get access to the service account. This event suggests that Kerberoasting was attempted, and the attacker might have obtained password hashes to service accounts.
        </info>
    </rule>
    <!--EMAIL-->
    <rule id="101231" level="1">
        <if_sid>101204</if_sid>
        <field name="email.body.attachments" type="pcre2">.*</field>
        <description>Zscaler-Decoy:Spearphishing attempt contains attachments</description>
        <group>high,one-on-one,s-a,T1566,T1566.001,initial-access,T1204,T1204.002,execution,T1105,command-control,</group>
        <mitre>
            <id>T1566</id>
            <id>T1566.001</id>
            <id>T1105</id>
            <id>T1204</id>
            <id>T1204.002</id>
        </mitre>
        <info type="text">
        Description:
           Spearphishing attachment is different from other forms of spearphishing in that it employs the use of malware attached to an email. All forms of spearphishing are electronically delivered social engineering targeted at a specific individual, company, or industry. In this scenario, adversaries attach a file to the spearphishing email and usually rely upon User Execution to gain execution.
        </info>
    </rule>
    <!--FileTheft-->
    <rule id="101232" level="1">
        <if_sid>101205</if_sid>
        <field name="sub_type" type="pcre2">(?i)^active_monitoring$</field>
        <description>Zscaler-Decoy:File decoy interaction detected</description>
        <group>high,one-on-one,s-a,T1204,T1204.002,execution,T1083,discovery,T1567,T1567.002,exfiltration,</group>
        <mitre>
            <id>T1204</id>
            <id>T1204.002</id>
            <id>T1083</id>
            <id>T1567</id>
            <id>T1567.002</id>
        </mitre>
        <info type="text">
        Description:
          A decoy file was opened. This may indicate data theft and exfiltration.
        </info>
    </rule>
    <!--Network-->
    <rule id="101233" level="1">
        <if_sid>101207</if_sid>
        <field name="sub_type" type="pcre2">(?i)^mqtt$</field>
        <description>Zscaler-Decoy:IoT protocol MQTT interaction detected</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,command-control,T1021,T1021.001,lateral-movement,T1556,credential-access,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1021</id>
            <id>T1021.001</id>
            <id>T1556</id>
        </mitre>
        <info type="text">
        Description:
          An IoT decoy detected an interaction using the MQTT protocol. Attackers may be trying to access the MQTT broker to steal sensitive data or inject malicious information.
        </info>
    </rule>
    <!--Endpoint-->
    <rule id="101234" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^cbf$</field>
        <field name="cbf.is_ad_decoy_credential" type="pcre2">(?i)^true$</field>
        <description>Zscaler-Decoy:Endpoint - Possible brute force attack against an Active Directory decoy user</description>
        <group>high,one-on-one,s-a,T1110.002,credential-access,T1078,T1078.002,defense-evasion,T1110,credential-access,</group>
        <mitre>
            <id>T1110.002</id>
            <id>T1078</id>
            <id>T1078.002</id>
            <id>T1110</id>
        </mitre>
        <info type="text">
        Description:
          Multiple failed authentication attempts were observed for a decoy user account. Adversaries may brute force domain accounts to escalate privileges when passwords are unknown. Since decoy accounts should never be used and privilege escalation significantly increases an adversary's capabilities, this is a high severity alert.
          
            <!--In simple :- There were many failed login attempts for a decoy user account. Attackers may be trying to guess the password to gain access and escalate their privileges. Since decoy accounts should never be used, this is a high-severity alert.-->
        </info>
    </rule>
    <rule id="101235" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^cbf$</field>
        <field name="cbf.is_ad_decoy_credential" type="pcre2">(?i)^false$</field>
        <description>Zscaler-Decoy:Endpoint - Possible brute force attack against a local user</description>
        <group>high,one-on-one,s-a,T1110.002,credential-access,T1078,T1078.002,defense-evasion,T1110,credential-access,</group>
        <mitre>
            <id>T1110.002</id>
            <id>T1078</id>
            <id>T1078.002</id>
            <id>T1110</id>
        </mitre>
        <info type="text">
        Description:
          Adversaries may brute force local accounts to gain access and escalate privileges when passwords are unknown. Since privilege escalation significantly increases an adversary's capabilities, this is a high severity alert.
          
            <!--In Simple :- Attackers may attempt to guess passwords for local accounts to gain access and escalate privileges. Since gaining more privileges makes the attacker more dangerous, this is a high-severity alert.-->
        </info>
    </rule>
    <!-- Check the Based Rule Because there are 2 Different Type 1.Endpoint and 2.itdr ans in this scinario i consider itder based Rule-->
    <!--itdr-->
    <rule id="101236" level="1">
        <if_sid>101209</if_sid>
        <field name="sub_type" type="pcre2">(?i)^dcshadow$</field>
        <description>Zscaler-Decoy:Endpoint - Possible DCShadow attack</description>
        <group>high,one-on-one,s-a,T1484,T1484.002,T1207,defense-evasion,T1098,T1098.002,persistence,</group>
        <mitre>
            <id>T1484</id>
            <id>T1484.002</id>
            <id>T1207</id>
            <id>T1098</id>
            <id>T1098.002</id>
        </mitre>
        <info type="text">
        Description:
          A fake Domain Controller was added to the Active Directory domain for replication. Attackers can use DCShadow to manipulate Active Directory data, including objects, credentials, and keys. Once registered, the rogue Domain Controller can make changes to the AD infrastructure. This suggests a DCShadow attack may have been attempted.
        </info>
    </rule>
    <rule id="101237" level="1">
        <if_sid>101209</if_sid>
        <field name="sub_type" type="pcre2">(?i)^dcsync$</field>
        <description>Zscaler-Decoy:Endpoint - Possible DCSync attack</description>
        <group>high,one-on-one,s-a,T1098,T1003,T1003.006,credential-access,persistence,</group>
        <mitre>
            <id>T1098</id>
            <id>T1003</id>
            <id>T1003.006</id>
        </mitre>
        <info type="text">
        Description:
          Active Directory domain replication was performed by an account that is not a Domain Controller. Active Directory replication is the process by which changes that are made on one domain controller are synchronized with all other domain controllers. Adversaries with necessary permissions can initiate a replication request, allowing them to retrieve the data stored in Active Directory, including password hashes.This event indicates that the DCSync attack has likely been attempted and the adversary may possess password hashes of high accounts.
        </info>
    </rule>
    <!--Endpoint-->
    <!-- Doubt-->
    <rule id="101238" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^file$</field>
        <field name="file.operation" type="pcre2" negate="yes">(?i)^Create$|^Read$</field>
        <description>Zscaler-Decoy:Endpoint - File decoy interaction detected</description>
        <group>high,one-on-one,s-a,T1083,T1070,T1070.004,defense-evasion,discovery,</group>
        <mitre>
            <id>T1083</id>
            <id>T1070.004</id>
            <id>T1070</id>
        </mitre>
        <info type="text">
        Description:
          A file decoy was accessed and possibly edited, renamed, or moved to another location.
        </info>
    </rule>
    <rule id="101239" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^imc$</field>
        <description>Zscaler-Decoy:Endpoint - Attempt to harvest credentials from LSASS's process memory</description>
        <group>high,one-on-one,s-a,T1003.001,T1003,credential-access,T1078,defense-evasion,</group>
        <mitre>
            <id>T1003.001</id>
            <id>T1003</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          Decoy credentials saved in LSASS's(A place in Windows where login details are stored, which attackers try to access.) process memory were accessed indicating a credential harvesting attempt. Windows saves credentials for various logon types in LSASS's process memory. Adversaries can target these in-memory credentials using tools like Mimikatz, and obtain account and password information. These can then be used to gain access to additional network resources.
        </info>
    </rule>
    <rule id="101240" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^kerberoast$</field>
        <field name="kerberoast.is_decoy" type="pcre2">(?i)^true$</field>
        <description>Zscaler-Decoy:Endpoint - Possible Kerberoasting attack</description>
        <group>high,one-on-one,s-a,T1558,T1558.003,T1003,credential-access,T1078,defense-evasion,</group>
        <mitre>
            <id>T1558.003</id>
            <id>T1558</id>
            <id>T1003</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
         A fake Active Directory user was targeted for a potential Kerberoasting attack. In Kerberos, Service Principal Names (SPNs) are linked to service accounts. Attackers can request tickets for these accounts, which may be encrypted using RC4. If attackers crack the encryption, they gain access to the service account. This suggests that an attacker may have attempted Kerberoasting and might have obtained password hashes for service accounts.
        </info>
    </rule>
    <rule id="101241" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^kerberoast$</field>
        <field name="kerberoast.is_decoy" type="pcre2">(?i)^false$</field>
        <description>Zscaler-Decoy:Endpoint - Kerberoasting attack</description>
        <group>high,one-on-one,s-a,T1558.003,T1558,credential-access,T1078,defense-evasion,</group>
        <mitre>
            <id>T1558.003</id>
            <id>T1558</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
         An Active Directory user was likely targeted in a Kerberoasting attack. In Kerberos, service accounts have something called Service Principal Names (SPNs) that are used for authentication. Attackers can look for these SPNs and request tickets for them. These tickets might be encrypted with a weaker method (RC4), which attackers can crack offline. If they crack the ticket, they can gain access to the service account. This event suggests that an attacker has likely tried to perform Kerberoasting and may have obtained password hashes for service accounts. Multiple ticket requests in a short time are highly suspicious and raise the severity of the event.
        </info>
    </rule>
    <rule id="101242" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^mitm$</field>
        <description>Zscaler-Decoy:Endpoint - LLMNR / NBT-NS / mDNS poisoning attempt detected</description>
        <group>high,one-on-one,s-a,T1557,T1557.001,T1212,credential-access,T1078,defense-evasion,</group>
        <mitre>
            <id>T1557</id>
            <id>T1557.001</id>
            <id>T1212</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
         Link-Local Multicast Name Resolution (LLMNR) and NetBIOS Name Service (NBT-NS) are Microsoft Windows components that serve as alternate methods of hostname resolution. LLMNR / NBT-NS is the fallback mechanism for hostname resolution when hosts file lookups and DNS resolution fail. The machine sends a broadcast request on the local subnet to resolve a hostname. A similar process is implemented by mDNS (or Multicast DNS). Adversaries can spoof an authoritative source for name resolution on a victim network by responding to LLMNR (UDP 5355)/NBT-NS (UDP 137)/mDNS (UDP 5353) traffic as though they know the identity of the requested host. This effectively poisons the service so victims will communicate with the adversary-controlled system. The username and NTLMv2 hash will then be sent to the adversary-controlled system if the requested host requires authentication. The adversary can then crack the hashes offline to obtain plaintext passwords.
         
            <!--Simple Explaintion : LLMNR, NBT-NS, and mDNS are used to find computers on a network when normal methods fail. Attackers can trick a computer into sending information to them by pretending to be the correct computer. When this happens, the victim’s username and a hashed version of their password can be sent to the attacker. The attacker can then try to break the password.-->
        </info>
    </rule>
    <rule id="101243" level="1">
        <if_sid>101208</if_sid>
        <field name="sub_type" type="pcre2">(?i)^psexec$</field>
        <description>Zscaler-Decoy:PsExec lateral movement detected</description>
        <group>high,one-on-one,s-a,T1136,T1136.002,T1543,T1543.003,persistence,T1021,T1021.002,lateral-movement,</group>
        <mitre>
            <id>T1136</id>
            <id>T1136.002</id>
            <id>T1543</id>
            <id>T1543.003</id>
            <id>T1021</id>
            <id>T1021.002</id>
        </mitre>
        <info type="text">
        Description:
         The use of PsExec was detected.  PsExec is a light-weight telnet-replacement that allows full remote command execution capabilities provided the adversary has the required rights. This is typically used for lateral movement when administrator level credentials have been obtained.  PsExec usage on non-administrative systems should be relatively rare.
        </info>
    </rule>
    <!--Itdr-->
    <rule id="101244" level="1">
        <if_sid>101209</if_sid>
        <field name="sub_type" type="pcre2">(?i)^monitor_accounts$</field>
        <description>Zscaler-Decoy:Endpoint - Privileged Active Directory account usage detected</description>
        <group>high,one-on-one,s-a,T1098,T1078,credential-access,defense-evasion,</group>
        <mitre>
            <id>T1098</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          Someone tried to log in using a high-level Active Directory account. Attackers may try to get the passwords of important accounts by dumping credentials. They can then use these accounts to move across the network and access important resources. This event suggests that a privileged account was likely the target of a password-based attack.
        </info>
    </rule>
    <rule id="101245" level="1">
        <if_sid>101209</if_sid>
        <field name="sub_type" type="pcre2">(?i)^zerologon$</field>
        <description>Zscaler-Decoy:Endpoint - Possible exploitation of ZeroLogon vulnerability</description>
        <group>high,one-on-one,s-a,T1210,T1068,lateral-movement,privilege-escalation,T1078,defense-evasion,</group>
        <mitre>
            <id>T1210</id>
            <id>T1068</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit vulnerability CVE-2020-1472 (A.K.A ZeroLogon) in Netlogon protocol was detected against a Domain Controller.CVE-2020-1472 is a high vulnerability in Netlogon Remote Protocol (MS-NRPC). The exploitation of vulnerable servers can result in domain privilege escalation.
        </info>
    </rule>
    <rule id="101246" level="1">
        <if_sid>101208</if_sid>
        <field name="attacker.event_name" type="pcre2">(?i)^ransomware_encryption_detected$</field>
        <field name="file.name" type="pcre2">.*\.seccrypt</field>
        <description>Zscaler-Decoy:Endpoint - WastedLocker-like behavior detected</description>
        <group>high,one-on-one,s-a,T1486,T1047,impact,execution,T1078,defense-evasion,</group>
        <mitre>
            <id>T1486</id>
            <id>T1047</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          A system file was encrypted and renamed with an extension associated with the ransomware "WastedLocker".  The presence of this traffic may indicate that the endpoint is infected.
        </info>
    </rule>
    <!--Network-->
    <rule id="101247" level="1">
        <if_sid>101207</if_sid>
        <field name="sub_type" type="pcre2">(?i)^mysql$</field>
        <description>Zscaler-Decoy:MySQL database interaction detected</description>
        <group>high,one-on-one,s-a,T1059,T1059.007,T1190,execution,initial-access,T1078,defense-evasion,</group>
        <mitre>
            <id>T1059</id>
            <id>T1059.007</id>
            <id>T1190</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          Adversaries target database servers primarily to extract sensitive information. In some cases, databases may provide command execution capabilities. Such access to decoy databases should be investigated to determine the adversary's objective.
        </info>
    </rule>
    <rule id="101248" level="1">
        <if_sid>101207</if_sid>
        <field name="threat.alert.severity" type="pcre2">(?i)^1$</field>
        <description>Zscaler-Decoy:A high priority known network threat signature was detected</description>
        <group>high,one-on-one,s-a,T1071,T1069,command-control,discovery,T1078,defense-evasion,</group>
        <mitre>
            <id>T1071</id>
            <id>T1069</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          The adversary's traffic matches a known threat signature. This implies that the traffic is very likely malicious and should be investigated further. Check the event details to see the signatures that were detected.This may include the following threat alert categories: - Attempted user privilege gain - Unsuccessful user privilege gain - Successful user privilege gain - Attempted administrator privilege gain - Successful administrator privilege gain - Executable code was detected - A network trojan was detected - Web application attack - Inappropriate content was detected - Potential corporate privacy violation
        </info>
    </rule>
    <!--Postgresql-->
    <rule id="101249" level="1">
        <if_sid>101213</if_sid>
        <field name="sub_type" type="pcre2">(?i)^connect$</field>
        <description>Zscaler-Decoy:PostgreSQL credentials submitted</description>
        <group>high,one-on-one,s-a,T1212,T1552,T1552.001,credential-access,T1078,defense-evasion,</group>
        <mitre>
            <id>T1212</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          Credential submission has been recorded by a PostgreSQL decoy. This occurs when an adversary has obtained credentials to the database service and is attempting to use them to login.
        </info>
    </rule>
    <!--Recon-->
    <rule id="101250" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">\/cf_scripts\/scripts\/ajax\/ckeditor\/plugins\/filemanager\/iedit\.cfc\?method=.*\.*_cfclient=true</field>
        <field name="recon.request_body" type="pcre2">/_variables=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2023-26360)</description>
        <group>high,one-on-one,s-a,T1190,T1071,T1071.001,initial-access,T1210,lateral-movement,CVE-2023-26360,</group>
        <mitre>
            <id>T1190</id>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          Adobe ColdFusion CVE-2023-26360 was exploited in the wild in Adobe ColdFusion product, a commercial application server for rapid web application development. The vulnerability affects both the 2018 and 2021 versions, allows adversaries to drop malware using HTTP POST commands by improper access control. The CVE encompasses two exploit methods arbitrary file reading and remote code execution which involves making a request with an injected `cfexecute` tag allowing adversaries to execute unauthenticated RCE (Remote Code Execution) without user interaction through untrusted JSON data.
        </info>
    </rule>
    <rule id="101251" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/\/\/CFIDE\/adminapi\/accessmanager\.cfc\?method=foo.*_cfclient=true</field>
        <field name="recon.request_body" type="pcre2">.*argumentCollection=%3CwddxPacket\+version%3D%271\.0.*|.*argumentCollection=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2023-29300)</description>
        <group>high,one-on-one,s-a,T1190,T1071,T1071.001,initial-access,T1210,lateral-movement,CVE-2023-29300,</group>
        <mitre>
            <id>T1190</id>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with an arbitary code execution affecting Adobe ColdFusion (CVE-2023-29300) Adobe ColdFusion versions 2018u16 (and earlier), 2021u6 (and earlier) and 2023.0.0.330468 (and earlier) are affected by a Deserialization of Untrusted Data vulnerability that could result in Arbitrary code execution. Exploitation of this issue does not require user interaction.
        </info>
    </rule>
    <rule id="101252" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/hax\/\.\.CFIDE\/wizards\/common\/utils\.cfc\?method=wizardHash.*inPassword=foo.*_cfclient=true.*returnFormat=wddx|.*\/\/CFIDE\/wizards\/common\/utils\.cfc\?method=wizardHash.*inPassword=foo.*_cfclient=true.*returnFormat=wddx</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2023-29298 and CVE-2023-38205)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,T1210,lateral-movement,CVE-2023-29298,CVE-2023-38205,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has exploited an access control bypass vulnerability affecting Adobe ColdFusion (CVE-2023-29298 and CVE-2023-38205). The affected versions include Adobe ColdFusion 2018u18 (and earlier), 2021u8 (and earlier), and 2023u2 (and earlier). This vulnerability stems from improper access control, which may allow an attacker to bypass security features. By leveraging this vulnerability, the attacker could gain unauthorized access to ColdFusion’s administration CFM and CFC endpoints. Notably, the exploitation of this issue does not require any user interaction.
        </info>
    </rule>
    <rule id="101253" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^GET$</field>
        <field name="recon.request_uri" type="pcre2">.*pms\?module=logging.*file_name=.*.*number_of_lines=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2024-20767)</description>
        <group>high,one-on-one,s-a,T1104,T1078,initial-access,command-control,T1221,defense-evasion,CVE-2024-20767,</group>
        <mitre>
            <id>T1104</id>
            <id>T1078</id>
            <id>T1221</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has taken advantage of a security flaw that lets them bypass protections and access private files. They can also write to the file system without needing to log in. This weakness affects Adobe ColdFusion versions before 2023.6 and 2021.12. It allows attackers to reach restricted parts of the file system by using directory traversal attacks.
        </info>
    </rule>
    <rule id="101254" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/admin\/airflow\/code\?root=.*dag_id=example_passing_params_via_test_command.*|.*\/code\?dag_id=example_passing_params_via_test_command.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of Apache Airflow OS Command Injection vulnerability (CVE-2022-24288)</description>
        <group>high,one-on-one,s-a,T1190,T1203,execution,T1059,T1059.001,CVE-2022-24288,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203</id>
            <id>T1059</id>
            <id>T1059.001</id>
        </mitre>
        <info type="text">
        Description:
          The adversary has made a web request associated with an OS command injection (CVE-2022-24288) in Apache Airflow prior to version 2.2.4 Apache Airflow prior to version 2.2.4 is vulnerable to OS command injection attacks because some example DAGs do not properly sanitize user-provided parameters, making them susceptible to OS Command Injection from the web UI.
        </info>
    </rule>
    <rule id="101255" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*login.action</field>
        <field name="recon.post_data" type="pcre2">.*disabled1system1user6708.*</field>
        <field name="recon.post_data" type="pcre2">.*disabledsystemuser.*</field>
        <description>Zscaler-Decoy:Usage of Atlassian Hardcoded Credentials Detected (CVE-2022-26138)</description>
        <group>high,one-on-one,s-a,T1078.001,T1078,defense-evasion,T1212,credential-access,CVE-2022-26138,</group>
        <mitre>
            <id>T1078.001</id>
            <id>T1078</id>
            <id>T1212</id>
        </mitre>
        <info type="text">
        Description:
          The Atlassian Questions for Confluence app on Confluence Server and Data Center creates a user account called 'disabledsystemuser' in the confluence-users group with a preset password. A remote attacker, without needing to log in, could exploit this by using the hardcoded password to access Confluence and view everything that regular users in the confluence-users group can see.
        </info>
    </rule>
    <rule id="101256" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/InsightPluginShowGeneralConfiguration\.jspa;</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Atlassian Jira Seraph (CVE-2022-0540)</description>
        <group>high,one-on-one,s-a,T1078.001,T1078,defense-evasion,T1190,initial-access,CVE-2022-0540,</group>
        <mitre>
            <id>T1078.001</id>
            <id>T1078</id>
            <id>T1190</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with an Authentication Bypass vulnerability (CVE-2022-0540) in Atlassian Jira Seraph. Jira Seraph allows a remote, unauthenticated attacker to bypass authentication by sending a specially crafted HTTP request. This affects Atlassian Jira Server and Data Center versions before 8.13.18, versions 8.14.0 and later before 8.20.6, and versions 8.21.0 and later before 8.22.0. This also affects Atlassian Jira Service Management Server and Data Center versions before 4.13.18, versions 4.14.0 and later before 4.20.6, and versions 4.21.0 and later before 4.22.0.
        </info>
    </rule>
    <rule id="101257" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*username\"\:\s+\[\".*(admin|administrator|super|root).*</field>
        <description>Zscaler-Decoy:Attempted threat intel login using an administrator account</description>
        <group>high,one-on-one,s-a,T1083,T1078,defense-evasion,discovery,T1212,credential-access,</group>
        <mitre>
            <id>T1083</id>
            <id>T1078</id>
            <id>T1212</id>
        </mitre>
        <info type="text">
        Description:
          Admin, administrator or a root credential submission has been recorded against a external decoy. This could mean: An adversary is testing the validity of credentials that may have been obtained via Credential Access. An adversary is attempting a brute force attack against a decoy. An adversary is testing default credentials against a decoy. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network.
        </info>
    </rule>
    <rule id="101258" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/mgmt\/tm\/util\/bash.*</field>
        <field name="recon.request_body" type="pcre2">.*\{.*command.*\:.*run.*</field>
        <description>Zscaler-Decoy:Possible exploitation of BIG-IP iControl REST vulnerability</description>
        <group>high,one-on-one,s-a,T1210,T1078,defense-evasion,lateral-movement,T1190,initial-access,</group>
        <mitre>
            <id>T1210</id>
            <id>T1078</id>
            <id>T1190</id>
        </mitre>
        <info type="text">
        Description:
          The adversary has made a web request associated with an RCE vulnerability (CVE-2022-1388) in F5 BIG-IP iControl REST authentication. This vulnerability allows the adversary to execute code without authentication.
        </info>
    </rule>
    <rule id="101259" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/%77eb%75i_%77sma_Http|.*\/%2577eb%2575i_%2577sma_Http|.*\/webui_wsma_http</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Cisco IOS XE (CVE-2023-20198)</description>
        <group>high,one-on-one,s-a,T1203,T1078,defense-evasion,execution,T1210,lateral-movement,CVE-2023-20198,T1068,</group>
        <mitre>
            <id>T1203</id>
            <id>T1078</id>
            <id>T1210</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has used Cisco IOS XE Web UI Privilege Escalation vulnerability (CVE-2023-20198) that allows the adversary to gain initial access to the application and further chain it with other vulnerabilities to achieve remote code execution.
        </info>
    </rule>
    <rule id="101260" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/gwtest\/formssso\?event=start.*target=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Citrix ADC (CVE-2023-3519)</description>
        <group>high,one-on-one,s-a,T1203,T1078,defense-evasion,execution,T1210,lateral-movement,CVE-2023-3519,</group>
        <mitre>
            <id>T1203</id>
            <id>T1078</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          CVE-2023-3519 is a high vulnerability in the Citrix ADC. The exploitation of vulnerable unpatched versions can enable unauthenticated remote code execution.
        </info>
    </rule>
    <rule id="101261" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">\/documentum\/upload\.aspx\?parentid=.*.*raw=1.*unzip=on.*uploadid=.*.*filename=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Citrix ShareFile (CVE-2023-24489)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,execution,T1210,lateral-movement,CVE-2023-24489,T1552,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1210</id>
            <id>T1552</id>
        </mitre>
        <info type="text">
        Description:
          A security flaw has been identified in the ShareFile storage zones controller managed by customers. If successfully exploited, this vulnerability could enable an unauthorized attacker to compromise the customer-managed ShareFile storage zones controller remotely. The impact of this vulnerability extends to all currently supported versions of the customer-managed ShareFile storage zones controller that are prior to version 5.11.24.
        </info>
    </rule>
    <rule id="101262" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/file-manager\/backend\/makefile.*|.*\/file-manager\/backend\/text.*|.*\/file-manager\/backend\/permissions.*</field>
        <field name="recon.request_body" type="pcre2">id\=\/htdocs\/app\/files\/public.*|id\=\/htdocs\/app\/files\/public.*|id\=\/htdocs\/app\/files\/public.*</field>
        <description>Zscaler-Decoy:Threat Intel - Potential remote code execution vulnerability in CloudPanel 2  2.3.1 (CVE-2023-35885)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,execution,T1210,lateral-movement,CVE-2023-35885,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          The attack originated from the usage of default secret keys and default user as "clp". This attack begins in the file manager of CloudPanel that have no session authentication which resulted in a broken access control, when the cookie clp-fm encrypted value is inserted with the default secret key. The decrypted cookie value is in a form of a serialize string which attacker could change the user value into default clp user. With the added PHP Object Injection this becomes a heavier matter in terms of impact.
        </info>
    </rule>
    <rule id="101263" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request" type="pcre2">.*headers.Cookie.*clp-fm\=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Potential remote code execution vulnerability in CloudPanel 2  2.3.1 (CVE-2023-35885)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,defense-evasion,execution,T1210,lateral-movement,CVE-2023-35885,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          The attack originated from the usage of default secret keys and default user as "clp". This attack begins in the file manager of CloudPanel that have no session authentication which resulted in a broken access control, when the cookie clp-fm encrypted value is inserted with the default secret key. The decrypted cookie value is in a form of a serialize string which attacker could change the user value into default clp user. With the added PHP Object Injection this becomes a heavier matter in terms of impact.
        </info>
    </rule>
    <rule id="101411" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request" type="pcre2">.cookies.*clp-fm.*.*.</field>
        <description>Zscaler-Decoy:Threat Intel - Potential remote code execution vulnerability in CloudPanel 2  2.3.1 (CVE-2023-35885)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,defense-evasion,execution,T1210,lateral-movement,CVE-2023-35885,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          The attack originated from the usage of default secret keys and default user as "clp". This attack begins in the file manager of CloudPanel that have no session authentication which resulted in a broken access control, when the cookie clp-fm encrypted value is inserted with the default secret key. The decrypted cookie value is in a form of a serialize string which attacker could change the user value into default clp user. With the added PHP Object Injection this becomes a heavier matter in terms of impact.
        </info>
    </rule>
    <rule id="101264" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/server-info\.action\?bootstrapStatusProvider\.applicationConfig\.setupComplete=.*|\/setup\/setupadministrator-start\.action/</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22515)</description>
        <group>high,one-on-one,s-a,T1078.004,T1078,defense-evasion,execution,T1068,privilege-escalation,CVE-2023-22515,</group>
        <mitre>
            <id>T1078.004</id>
            <id>T1078</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
          Adversaries can exploit CVE-2023-22515 (a Broken access control vulnerability) to create a new admin account and authenticate themselves with the admin Privileges. This vulnerability can be used to bypass authentication or escalate privilege
        </info>
    </rule>
    <rule id="101265" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/setup\/setupadministrator\.action</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22515)</description>
        <group>high,one-on-one,s-a,T1078.004,T1078,defense-evasion,execution,T1068,privilege-escalation,CVE-2023-22515,</group>
        <mitre>
            <id>T1078.004</id>
            <id>T1078</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
          Adversaries can exploit CVE-2023-22515 (a Broken access control vulnerability) to create a new admin account and authenticate themselves with the admin Privileges. This vulnerability can be used to bypass authentication or escalate privilege
        </info>
    </rule>
    <rule id="101266" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">\/json\/setup-restore\.action.*</field>
        <field name="recon.request_body" type="pcre2">.*name=\"buildIndex\".*|.*name=%22buildIndex%22.*|.*name=%5Cx22buildIndex%5Cx22.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22518)</description>
        <group>high,one-on-one,s-a,T1078.004,T1078,defense-evasion,execution,T1068,privilege-escalation,CVE-2023-22518,</group>
        <mitre>
            <id>T1078.004</id>
            <id>T1078</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
          Adversaries can exploit CVE-2023-22518 (an improper authorization vulnerability) to upload a backup zip file to restore the Confluence instance without any authentication. This vulnerability is used to reset and create a Confluence instance administrator account and further escalated to achieve RCE and set up a backdoor.
        </info>
    </rule>
    <rule id="101267" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">template/aui/text-inline.vm</field>
        <field name="recon.request_body" type="pcre2">label=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of template injection vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22527)</description>
        <group>high,one-on-one,s-a,T1210,T1078,lateral-movement,defense-evasion,T1059,T1059.008,execution,CVE-2023-22527,</group>
        <mitre>
            <id>T1210</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.008</id>
        </mitre>
        <info type="text">
        Description:
          The vulnerability (CVE-2023-22527) in Atlassian's Confluence Server and Data Center allows unauthenticated attackers to inject OGNL expressions for template injection attack, enabling arbitrary code execution and potential compromise of affected instances. This Remote Code Execution vulnerability affects out-of-date Confluence Data Center and Server 8 versions released before Dec. 5, 2023 as well as 8.4.5 which no longer receives backported fixes in accordance with Security Bug Fix Policy. Atlassian recommends patching to the latest version immediately.
        </info>
    </rule>
    <rule id="101268" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">(?i).*password\"\:\s+\[\".*</field>
        <field name="recon.post_data" type="pcre2" negate="yes">(?i).*username\"\:\s+\[\".*(admin|administrator|super|root).*</field>
        <description>Zscaler-Decoy:Threat Intel - Attempted login</description>
        <group>high,one-on-one,s-a,T1110,T1078,credential-access,defense-evasion,execution,T1566,initial-access,CVE-2023-22527,</group>
        <mitre>
            <id>T1110</id>
            <id>T1078</id>
            <id>T1566</id>
        </mitre>
        <info type="text">
        Description:
          An attacker may be testing the validity of credentials obtained via phishing, external sources, or other credential harvesting techniques. If multiple credentials are submitted, it could indicate a brute force attempt. It may also indicate the use of credentials stolen through techniques such as social engineering. Alternatively, it may be a user accidentally accessing a decoy and attempting to log in. Credential submission has been recorded for a non admin or administrator or a root user.
        </info>
    </rule>
    <rule id="101269" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*username\"\:\s+\[\".*.*(\b)(on\S+)(\s*)=|javascript|(\.*\s*)(\/*)script.*|.*username\"\:\s+\[\".*(alert\(|prompt).*</field>
        <description>Zscaler-Decoy:Threat Intel - Cross Site Scripting (XSS) attempt</description>
        <group>high,one-on-one,s-a,T1189,T1059,T1059.007,credential-access,defense-evasion,execution,T1071,command-control,CVE-2023-22527,T1185,</group>
        <mitre>
            <id>T1189</id>
            <id>T1059</id>
            <id>T1059.007</id>
            <id>T1071</id>
            <id>T1185</id>
        </mitre>
        <info type="text">
        Description:
          Cross Site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in the victim's web browser by including attack code in a legitimate web page. The browser trusts and executes the script when the victim visits the web page. This allows the malicious script to access cookies, session tokens, or other sensitive information retained by the browser for the site.
        </info>
    </rule>
    <rule id="101435" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*password\"\:\s+\[\".*.*(\b)(on\S+)(\s*)=|javascript|(\.*\s*)(\/*)script.*|.*password\"\:\s+\[\".*(alert\(|prompt).*</field>
        <description>Zscaler-Decoy:Threat Intel - Cross Site Scripting (XSS) attempt</description>
        <group>high,one-on-one,s-a,T1189,T1059,T1059.007,credential-access,defense-evasion,execution,T1071,command-control,CVE-2023-22527,T1185,</group>
        <mitre>
            <id>T1189</id>
            <id>T1059</id>
            <id>T1059.007</id>
            <id>T1071</id>
            <id>T1185</id>
        </mitre>
        <info type="text">
        Description:
          Cross Site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in the victim's web browser by including attack code in a legitimate web page. The browser trusts and executes the script when the victim visits the web page. This allows the malicious script to access cookies, session tokens, or other sensitive information retained by the browser for the site.
        </info>
    </rule>
    <rule id="101436" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.user_agent.string" type="pcre2">.*(\b)(on\S+)(\s*)=|javascript|(\.*\s*)(\/*)script.*|.*(alert\(|prompt).*</field>
        <description>Zscaler-Decoy:Threat Intel - Cross Site Scripting (XSS) attempt</description>
        <group>high,one-on-one,s-a,T1189,T1059,T1059.007,credential-access,defense-evasion,execution,T1071,command-control,CVE-2023-22527,T1185,</group>
        <mitre>
            <id>T1189</id>
            <id>T1059</id>
            <id>T1059.007</id>
            <id>T1071</id>
            <id>T1185</id>
        </mitre>
        <info type="text">
        Description:
          Cross Site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in the victim's web browser by including attack code in a legitimate web page. The browser trusts and executes the script when the victim visits the web page. This allows the malicious script to access cookies, session tokens, or other sensitive information retained by the browser for the site.
        </info>
    </rule>
    <rule id="101270" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/dview8\/api\/usersByLevel</field>
        <field name="recon.request.headers.Authorization" type="pcre2">[A-Za-z0-9_-]{2,}(?:\.[A-Za-z0-9_-]{2,}){2}</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in D-Link D-View 8 v2.0.1.28 (CVE-2023-5074)</description>
        <group>high,one-on-one,s-a,T1110,T1078,credential-access,defense-evasion,execution,T1566,initial-access,CVE-2023-5074,</group>
        <mitre>
            <id>T1110</id>
            <id>T1078</id>
            <id>T1566</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with an authentication bypass vulnerability affecting D-Link D-View 8 v2.0.1.28 (CVE-2023-5074) Use of a static key to protect a JWT token used in user authentication can allow an for an authentication bypass Upon D-View 8 installation, there is no API key configured for the default user admin. In addition, the userId for the admin user appears to remain the same (59171d56-e6b4-4789-90ff-a7a27fd48548) across installations. With a known JWT secret key, an unauthenticated remote attacker can craft a valid JWT token and use the token to access protected APIs.
        </info>
    </rule>
    <rule id="101271" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">\/cgi-bin\/nas_sharing\.cgi\?user=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in D-Link Network Attached Storage (CVE-2024-3273)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,defense-evasion,execution,T1059,T1059.001,execution,CVE-2024-3273,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.001</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with a Command Injection vulnerability affecting D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to 20240403 (CVE-2024-3273) A vulnerability, which was classified as high. Affected is an unknown function of the file /cgi-bin/nas_sharing.cgi of the component HTTP GET Request Handler. The manipulation of the argument system leads to command injection. It is possible to launch the attack remotely. The identifier of this vulnerability is VDB-259284. This vulnerability only affects products that are no longer supported by the maintainer.
        </info>
    </rule>
    <rule id="101272" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">\/aspera\/faspex\/package_relay\/relay_package</field>
        <field name="recon.request_body" type="pcre2">.*{"package_file_list": \["\/"], "external_emails": "\\n---\\n- !ruby\/object:Gem::Installer\\n    i: x\\n- !ruby\/object:Gem::SpecFetcher\\n.*|.*{\\x22package_file_list\\x22: \[\\x22\/\\x22], \\x22external_emails\\x22: \\x22\\x5Cn---\\x5Cn- !ruby\/object:Gem::Installer\\x5Cn    i: x\\x5Cn- !ruby\/object:Gem::SpecFetcher\\x5Cn    i: y\\x5Cn.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in IBM Aspera Faspex =4.4.2 PL1 (CVE-2022-47986)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,defense-evasion,execution,T1059,T1059.004,execution,CVE-2022-47986,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.004</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with a Remote Code Execution vulnerability affecting IBM Aspera Faspex =4.4.2 PL1 IBM Aspera Faspex through 4.4.2 Patch Level 1 is susceptible to remote code execution via a YAML deserialization flaw. This can allow an attacker to send a specially crafted obsolete API call and thereby execute arbitrary code, obtain sensitive data, and/or execute other unauthorized operations.
        </info>
    </rule>
    <rule id="101273" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">\/res\/login\.jsf\?javax\.faces\.ViewState.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in IBM Operational Decision Manager (CVE-2024-22320)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,defense-evasion,execution,T1059,T1059.001,T1068,privilege-escalation,CVE-2024-22320,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.001</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with a Remote Code Execution vulnerability affecting IBM Operational Decision Manager 8.10.3, 8.10.4, 8.10.5.1, 8.11, 8.11.0.1, and 8.12.0.1 (CVE-2024-22320) This vulnerability could allow a remote authenticated attacker to execute arbitrary code on the system, caused by an unsafe deserialization. By sending specially crafted request, an attacker could exploit this vulnerability to execute arbitrary code in the context of SYSTEM.
        </info>
    </rule>
    <rule id="101274" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">\/api\/v1\/totp\/user-backup-code\/\.\.\/\.\.\/system\/system-information.*|\/api\/v1\/system\/system-information.*|\/api\/v1\/cav\/client\/status\/\.\.\/\.\.\/admin\/options.*|\/api\/v1\/cav\/admin\/options.*|\/api\/v1\/totp\/user-backup-code\/%2E%2E\/%2E%2E\/system\/system-information.*|\/api\/v1\/cav\/client\/status\/%2E%2E\/%2E%2E\/admin\/options.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2023-46805)</description>
        <group>high,one-on-one,s-a,T1190,T1078,initial-access,defense-evasion,execution,T1556,credential-access,CVE-2023-46805,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1556</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with an Authentication Bypass vulnerability affecting Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2023-46805) An authentication bypass vulnerability in the web component of Ivanti ICS 9.x, 22.x and Ivanti Policy Secure allows a remote attacker to access restricted resources by bypassing control checks.
        </info>
    </rule>
    <rule id="101275" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">\/api\/v1\/totp\/user-backup-code\/\.\.\/\.\.\/license\/keys-status\/%3bcurl%20.*|\/api\/v1\/license\/keys-status\/%3bcurl%20.*|\/api\/v1\/totp\/user-backup-code\/%2E%2E\/%2E%2E\/system\/maintenance\/archiving\/cloud-server-test-connection.*|\/api\/v1\/totp\/user-backup-code\/\.\.\/\.\.\/system\/maintenance\/archiving\/cloud-server-test-connection.*|\/api\/v1\/system\/maintenance\/archiving\/cloud-server-test-connection.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2024-21887)</description>
        <group>high,one-on-one,s-a,T1059,T1078,initial-access,defense-evasion,execution,T1210,lateral-movement,CVE-2024-21887,</group>
        <mitre>
            <id>T1059</id>
            <id>T1078</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with an command injection vulnerability affecting Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2024-21887) A command injection vulnerability in web components of Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) allows an authenticated administrator to send specially crafted requests and execute arbitrary commands on the appliance.
        </info>
    </rule>
    <rule id="101276" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">\/dana-na\/auth\/saml-sso\.cgi.*</field>
        <field name="recon.request_body" type="pcre2">.*SAMLRequest.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2024-22024)</description>
        <group>high,one-on-one,s-a,T1221,T1078,initial-access,defense-evasion,execution,T1600,T1213,collection,CVE-2024-22024,</group>
        <mitre>
            <id>T1221</id>
            <id>T1078</id>
            <id>T1600</id>
            <id>T1213</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with a XXE (XML External Entity) injection vulnerability affecting Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2024-22024) An XML external entity or XXE vulnerability in the SAML component of Ivanti Connect Secure (9.x, 22.x), Ivanti Policy Secure (9.x, 22.x) and ZTA gateways which allows an attacker to access certain restricted resources without authentication.
        </info>
    </rule>
    <rule id="101277" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">dana-ws\/saml20.ws</field>
        <field name="recon.request_body" type="pcre2">.*ds:RetrievalMethod URI.*|.*ds%3ARetrievalMethod%20URI.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Ivanti connect secure (CVE-2024-21893)</description>
        <group>high,one-on-one,s-a,T1210,T1190,initial-access,defense-evasion,lateral-movement,T1071,T1071.001,T1213,command-control,CVE-2024-21893,</group>
        <mitre>
            <id>T1210</id>
            <id>T1190</id>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1213</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated Server Side Request Forgery vulnerability (CVE-2024-21893) affecting Ivanti Connect Secure, Ivanti Policy Secure, and Ivanti Neurons. This vulnerability allows an unauthenticated threat actor to access restricted resources and further chained with CVE-2024-21887 to achieve remote code execution.
        </info>
    </rule>
    <rule id="101278" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/cli\?remoting=false.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Jenkins 2.441 and earlier (CVE-2024-23897)</description>
        <group>high,one-on-one,s-a,T1210,T1190,initial-access,defense-evasion,lateral-movement,T1071,T1071.001,command-control,CVE-2024-23897,</group>
        <mitre>
            <id>T1210</id>
            <id>T1190</id>
            <id>T1071</id>
            <id>T1071.001</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with arbitrary files read vulnerability which leads to Remote Code Execution affecting Jenkins 2.441 and earlier, LTS 2.426.2 and earlier versions (CVE-2024-23897) Jenkins 2.441 and earlier, LTS 2.426.2 and earlier does not disable a feature of its CLI command parser that replaces an '@' character followed by a file path in an argument with the file's contents, allowing unauthenticated attackers to read arbitrary files on the Jenkins controller file system.
        </info>
    </rule>
    <rule id="101279" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/hax\?jsp=\/app\/rest\/server;\.jsp</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in JetBrains TeamCity (CVE-2024-27198)</description>
        <group>high,one-on-one,s-a,T1210,T1078,initial-access,defense-evasion,lateral-movement,T1068,privilege-escalation,CVE-2024-27198,</group>
        <mitre>
            <id>T1210</id>
            <id>T1078</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with a Authentication Bypass vulnerability affecting JetBrains TeamCity before 2023.11.4 (CVE-2024-27198) TeamCity exposes a web server over HTTP port 8111 by default (and can optionally be configured to run over HTTPS). An attacker can craft a URL such that all authentication checks are avoided, allowing endpoints that are intended to be authenticated to be accessed directly by an unauthenticated attacker. A remote unauthenticated attacker can leverage this to take complete control of a vulnerable TeamCity server.
        </info>
    </rule>
    <rule id="101280" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/res\/\.\.\/admin\/diagnostic\.jsp|.*\/\.well-known\/acme-challenge\/\.\.\/\.\.\/admin\/diagnostic\.jsp|.*\/update\/\.\.\/admin\/diagnostic\.jsp</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in JetBrains TeamCity (CVE-2024-27199)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1550,defense-evasion,T1098,privilege-escalation,CVE-2024-27199,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1550</id>
            <id>T1098</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with a Authentication Bypass vulnerability affecting JetBrains TeamCity before 2023.11.4 (CVE-2024-27199) It is an authentication bypass vulnerability in the web component of TeamCity that arises from a path traversal issue and has a CVSS base score of 7.3 vulnerability, CVE-2024-27199 allows for a limited amount of information disclosure and a limited amount of system modification, including the ability for an unauthenticated attacker to replace the HTTPS certificate in a vulnerable TeamCity server with a certificate of the attacker's choosing.
        </info>
    </rule>
    <rule id="101281" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/webauth_operation\.php.*</field>
        <field name="recon.request_body" type="pcre2">rs=do_upload.*rsargs%5B%5D=%5B%7B%22fileData%22%3A\+%22data%3Atext%2Fhtml%3Bbase64%.*|rs=do_upload.*rsargs%5B%5D=%5B%7B%5Cx22fileData%5Cx22%3A\+%5Cx22data%3Atext%2Fhtml%3Bbase64%.*|rs=do_upload.*rsargs\[]=\[{"fileData": "data:text\/html;base64.*|rs=do_upload.*rsargs\[]=\[{\\x22fileData\\x22: \\x22data:text\/html;base64.*|rs=do_upload.*rsargs\[]=\[{"fileName": "{{rand_base\(5, "abc"\)}}\.ini".*|rs=do_upload.*rsargs\[]=\[{\\x22fileName\\x22: \\x22{{rand_base\(5, \\x22abc\\x22\)}}\.ini.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Juniper Networks J-Web (CVE-2023-36844)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1059,T1059.005,CVE-2023-36844,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1059</id>
            <id>T1059.005</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated a Remote Code Execution vulnerability in Juniper Network (CVE-2023-36844). A PHP External Variable Modification vulnerability in J-Web of Juniper Networks Junos OS on EX Series allows an unauthenticated, network-based attacker to control certain, important environments variables.  Utilizing a crafted request an attacker is able to modify certain PHP environments variables leading to partial loss of integrity, which may allow chaining to other vulnerabilities.
        </info>
    </rule>
    <rule id="101282" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.http_basicauth_user" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101424" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.http_referrer" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101425" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.http_x_forwarded_for" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101426" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101427" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101428" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_body" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101429" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.server_name" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101430" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.user_agent.string" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101298" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request.headers.X-Api-Version" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101299" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.X-Api-Version" type="pcre2">.*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1133,persistence,CVE-2021-44228,CVE-2021-45046,</group>
        <mitre>
            <id>T1071.001</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1133</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101283" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.http_basicauth_user" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101415" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.http_referrer" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101416" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.http_x_forwarded_for" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101417" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101418" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101419" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_body" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101420" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.server_name" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101421" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.user_agent.string" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101422" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request.headers.X-Api-Version" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101423" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.X-Api-Version" type="pcre2">.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1499,impact,CVE-2021-44228,CVE-2021-45105,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
          An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101284" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/api\/setup\/validate</field>
        <field name="recon.request_body" type="pcre2">{\"token\":\".*\",\"details\":{\"details\":{.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of vulnerability in Metabase open source web application (CVE-2023-38646)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1203,command-control,execution,T1210,lateral-movement,T1105,CVE-2023-38646,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T1105</id>
        </mitre>
        <info type="text">
        Description:
          Metabase, an open-source business intelligence tool is vulnerable to remote code execution. The vulnerability stemmed from an exposed setup token even after installation, allowing unauthenticated users to access it. By exploiting a SQL injection flaw in the H2 database driver used by Metabase, adversaries could execute arbitrary code. The issue affected instances set up after a specific commit made in January 2022. The exploit involved crafting a specific payload to achieve reliable remote code execution. Metabase have addressed the vulnerability from version v0.46.6.1.
        </info>
    </rule>
    <rule id="101285" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/api\/users\/search_authors</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Microweber (CVE-2022-0281)</description>
        <group>high,one-on-one,s-a,T1592,T1592.002,T1589,reconnaissance,T1530,collection,T1005,CVE-2022-0281,</group>
        <mitre>
            <id>T1592</id>
            <id>T1592.002</id>
            <id>T1589</id>
            <id>T1530</id>
            <id>T1005</id>
        </mitre>
        <info type="text">
        Description:
          An adversary has made a web request associated with an Information Disclosure vulnerability (CVE-2022-0281) in Packagist microweber/microweber prior to 1.2.11. This vulnerability allows any unauthorized/unauthenticated actor can find the PII data of all the users registered in the application. PII - Personally Identifiable Information leaked by this application is first name, last name, email id, picture, username, is_admin status.
        </info>
    </rule>
    <rule id="101286" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^GET$</field>
        <field name="recon.request_uri" type="pcre2">.*\/mifs\/asfV3\/api\/v2\/.*</field>
        <description>Zscaler-Decoy:Threat Intel - Potential MobileIron Core - Remote Unauthenticated API Access (CVE-2023-35082)</description>
        <group>high,one-on-one,s-a,T1190,T1589,initial-access,reconnaissance,T1210,lateral-movement,T1078,defense-evasion,CVE-2023-35082,</group>
        <mitre>
            <id>T1190</id>
            <id>T1589</id>
            <id>T1210</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
          A high API access vulnerability in Ivanti Endpoint Manager Mobile (EPMM), formerly MobileIron Core that was exploited in the wild because of its permissive nature of certain entries in the mifs web application’s security filter chain allows unauthenticated attackers to access the API. An attacker can use these API endpoints to perform a multitude of operations including the ability to disclose personally identifiable information (PII) and perform modifications to the platform.
        </info>
    </rule>
    <rule id="101287" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$|^PUT$</field>
        <field name="recon.request_uri" type="pcre2">.*\/api\/v1\/token|.*\/api\/v1\/auth\/token|.*\/api\/v1\/folders\/[0-9]+\/files|.*\/guestaccess.aspx|.*\/api\/v1\/folders\/[0-9_-]+\/files|.*\/moveitisapi\/moveitisapi.dll.*|.*\/api\/v1\/folders|.*\/api\/v1\/files\/.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in MOVEit Transfer (CVE-2023-34362)</description>
        <group>high,one-on-one,s-a,T1190,T1059,T1059.007,execution,initial-access,reconnaissance,T1210,lateral-movement,T1505,T1505.003,persistence,CVE-2023-34362,</group>
        <mitre>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1059.007</id>
            <id>T1210</id>
            <id>T1505</id>
            <id>T1505.003</id>
        </mitre>
        <info type="text">
        Description:
         Adversary has attempted to exploit CVE-2023-34362 (SQL injection vulnerability) to gain unauthenticated access to the database. Based on the database engine used, the adversary can further gain information, alter tables and execute code on the server.
        </info>
    </rule>
    <rule id="101288" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/oauth\/idp\/\.well-known\/openid-configuration|.*\/logon\/LogonPoint\/Authentication\/GetUserName</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Citrix NetScaler (CVE-2023-4966)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1592,T1203,execution,CVE-2023-4966,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1592</id>
            <id>T1203</id>
        </mitre>
        <info type="text">
        Description:
         An adversary has abused the unauthenticated buffer-related vulnerability (CVE-2023-4966) that causes a high information disclosure in NetScaler ADC and NetScaler Gateway.
        </info>
    </rule>
    <rule id="101289" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/app</field>
        <field name="recon.request_body" type="pcre2">.*service=direct%2F1%2FSetupCompleted%2F%24Form.*sp=S0.*Form0=%24Hidden%2CanalyticsEnabled%2C%24Submit.*%24Hidden=true.*%24Submit=Login.*|.*service=direct%2F1%2FConfigEditor%2FquickFindForm.*sp=S0.*Form0=%24TextField%2CdoQuickFind%2Cclear.*%24TextField=print-and-device\.script\.enabled.*doQuickFind=Go.*|.*service=direct%2F1%2FConfigEditor%2F%24Form.*sp=S1.*Form1=%24TextField%240%2C%24Submit%2C%24Submit%240.*%24TextField%240=Y.*%24Submit=Update.*|.*service=direct%2F1%2FConfigEditor%2FquickFindForm.*sp=S0.*Form0=%24TextField%2CdoQuickFind%2Cclear.*%24TextField=print\.script\.sandboxed.*doQuickFind=Go.*|.*service=direct%2F1%2FConfigEditor%2F%24Form.*sp=S1.*Form1=%24TextField%240%2C%24Submit%2C%24Submit%240.*%24TextField%240=N.*%24Submit=Update.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Papercut MF/NG (CVE-2023-27350)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1078,T1203,execution,CVE-2023-27350,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1203</id>
        </mitre>
        <info type="text">
        Description:
         An adversary has made a web request associated with an RCE vulnerability (CVE-2023-27350) in PaperCut MF/NG 22.0.5 (Build 63914). This vulnerability allows remote attackers to bypass authentication on affected installations of PaperCut NG 22.0.5 Authentication is not required to exploit this vulnerability, the specific flaw exists within the SetupCompleted class and issue results from improper access control. An attacker can leverage this vulnerability to bypass authentication and execute arbitrary code in the context of SYSTEM.
        </info>
    </rule>
    <rule id="101290" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/flash\/addcrypted2.*</field>
        <field name="recon.request_body" type="pcre2">jk=pyimport.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible PyLoad - Pre-auth Remote Code Execution (CVE-2023-0297)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1059,T1203,execution,CVE-2023-27350,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1203</id>
        </mitre>
        <info type="text">
        Description:
         A high Code Injection in GitHub repository of pyload/pyload prior to 0.5.0b3.dev31. Due to the pyimport functionality exposed through the js2py library. An unauthenticated attacker can issue a crafted POST request to the flash/addcrypted2 endpoint to leverage this for code execution.
        </info>
    </rule>
    <rule id="101291" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/render\/info\.html</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in pyLoad (CVE-2024-21644)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1592,T1592.001,T1552,T1552.001,credential-access,CVE-2024-21644,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1592</id>
            <id>T1592.001</id>
            <id>T1552</id>
            <id>T1552.001</id>
        </mitre>
        <info type="text">
        Description:
         An adversary has made a web request associated with a Configuration File Disclosure vulnerability affecting pyLoad 0.5.0b3 (CVE-2024-21644) pyLoad is the free and open-source Download Manager written in pure Python. Any unauthenticated user can browse to a specific URL to expose the Flask config, including the `SECRET_KEY` variable. This issue has been patched in version 0.5.0b3.dev77
        </info>
    </rule>
    <rule id="101292" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">\/login\?next=(https:\/\/www\.|http:\/\/www\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,})(\.[a-zA-Z0-9]{2,})?|\/login\?next=(https:\/\/www\.|http:\/\/www\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,})(\.[a-zA-Z0-9]{2,})?\/logs</field>
        <field name="recon.request_body" type="pcre2">do=login.*username=.*|do=login.*username=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in pyLoad (CVE-2024-21645)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1565,T1589,impact,credential-access,CVE-2024-21645,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1565</id>
            <id>T1589</id>
        </mitre>
        <info type="text">
        Description:
         An adversary has made a web request associated with a log injection vulnerability affecting pyLoad version  0.5.0b3.dev76 (CVE-2024-21645) pyLoad is the free and open-source Download Manager written in pure Python. A log injection vulnerability was identified in pyload. This vulnerability allows any unauthenticated actor to inject arbitrary messages into the logs gathered by pyload.
        </info>
    </rule>
    <rule id="101293" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">.*\/sitecore\_xaml\.ashx\/\-\/xaml\/Sitecore\.Xaml\.Tutorials\.Styles\.Index</field>
        <field name="recon.request_body" type="pcre2">\_\_ISEVENT\=1\.*\_\_SOURCE\=\.*\_\_PARAMETERS\=ParseControl\.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Multiple Sitecore products (CVE-2023-35813)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1210,T1203,lateral-movement,execution,CVE-2023-35813,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1210</id>
            <id>T1203</id>
        </mitre>
        <info type="text">
        Description:
         Adversaries can exploit CVE-2023-35813 by sending a crafted POST request and sending encoded payloads in the body which affects multiple Sitecore products allowing remote code execution. This affects Experience Manager (XM), Experience Platform (XP), and Experience Commerce (XC). The vulnerability impacts all Experience Platform topologies from 9.0 Initial Release to 10.3 Initial Release.
        </info>
    </rule>
    <rule id="101294" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$|^GET$</field>
        <field name="recon.request_uri" type="pcre2">.*\/ws\/msw\/tenant\/.*|.*\/appliance\/applianceMainPage</field>
        <field name="recon.request_body" type="pcre2">action\=login\.*skipSessionCheck\=0\.*needPwdChange\=0\.*clientHash=.*|num\=3232150\.*action\=file\_system\.*task\=search\.*item\=application\_log\.*criteria\=\%2a\.*width\=500\.*searchFolder=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in SonicWall GMS (CVE-2023-34124)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1210,lateral-movement,CVE-2023-35813,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
         This vulnerability in SonicWall Global Management System product allows Web Service Authentication Bypass. By crafting specific requests, an attacker could authenticate without proper credentials and execute commands. This vulnerability impacts GMS versions 9.3.2-SP1 and before.
        </info>
    </rule>
    <rule id="101295" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">.*\/userportal\/Controller\?mode=8700.*operation=1.*datagrid=179.*json=.*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Sophos Firewall (CVE-2022-1040)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1210,T1078,lateral-movement,defense-evasion,CVE-2022-1040,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1210</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
         An adversary has made a web request associated with an Remote Code Execution vulnerability (CVE-2022-1040) in Sophos Firewall Sophos Firewall version v18.5 MR3 and older contains an authentication bypass vulnerability in the User Portal and Webadmin which could allow a remote attacker to execute code.
        </info>
    </rule>
    <rule id="101296" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*class\.module\.classLoader\..*</field>
        <field name="recon.request_uri" type="pcre2">.*class\.module\.classLoader\..*</field>
        <field name="recon.request_body" type="pcre2">.*class\.module\.classLoader\..*</field>
        <description>Zscaler-Decoy:Threat Intel - Possible exploitation of a vulnerability in Spring Framework (CVE-2022-22965)</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1210,lateral-movement,T1105,CVE-2022-22965,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1210</id>
            <id>T1105</id>
        </mitre>
        <info type="text">
        Description:
         CVE-2022-22965 is a high vulnerability in the application development framework, Spring Framework. The exploitation of vulnerable servers can enable unauthenticated users to upload a web shell and execute arbitrary code on the server.
        </info>
    </rule>
    <rule id="101297" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*sleep\.*</field>
        <description>Zscaler-Decoy:Threat Intel - Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1505,T1505.002,persistence,T1555,credential-access,T1059,T1059.007,execution,CVE-2022-22965,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1505</id>
            <id>T1505.002</id>
            <id>T1555</id>
            <id>T1059</id>
            <id>T1059.007</id>
        </mitre>
        <info type="text">
        Description:
         SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101431" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.query_string" type="pcre2">.*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*sleep\.*</field>
        <description>Zscaler-Decoy:Threat Intel - Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1505,T1505.002,persistence,T1555,credential-access,T1059,T1059.007,execution,CVE-2022-22965,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1505</id>
            <id>T1505.002</id>
            <id>T1555</id>
            <id>T1059</id>
            <id>T1059.007</id>
        </mitre>
        <info type="text">
        Description:
         SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101432" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.user_agent.string" type="pcre2">.*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*sleep\.*</field>
        <description>Zscaler-Decoy:Threat Intel - Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1505,T1505.002,persistence,T1555,credential-access,T1059,T1059.007,execution,CVE-2022-22965,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1505</id>
            <id>T1505.002</id>
            <id>T1555</id>
            <id>T1059</id>
            <id>T1059.007</id>
        </mitre>
        <info type="text">
        Description:
         SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101433" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*password\"\:\s+\[\".*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*.*password\"\:\s+\[\"(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*.*password\"\:\s+\[\"sleep\.*</field>
        <description>Zscaler-Decoy:Threat Intel - Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1505,T1505.002,persistence,T1555,credential-access,T1059,T1059.007,execution,CVE-2022-22965,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1505</id>
            <id>T1505.002</id>
            <id>T1555</id>
            <id>T1059</id>
            <id>T1059.007</id>
        </mitre>
        <info type="text">
        Description:
         SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101434" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.post_data" type="pcre2">.*username\"\:\s+\[\".*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*.*username\"\:\s+\[\"(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*.*username\"\:\s+\[\"sleep\.*</field>
        <description>Zscaler-Decoy:Threat Intel - Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1071,T1071.001,T1190,command-control,initial-access,reconnaissance,T1505,T1505.002,persistence,T1555,credential-access,T1059,T1059.007,execution,CVE-2022-22965,</group>
        <mitre>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1190</id>
            <id>T1505</id>
            <id>T1505.002</id>
            <id>T1555</id>
            <id>T1059</id>
            <id>T1059.007</id>
        </mitre>
        <info type="text">
        Description:
         SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <!-- sub rule RECON -->
    <rule id="101300" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">(?i).*index\.php\?c\=blocked\.*action\=continue.*/</field>
        <field name="recon.request_body" type="pcre2">(?i)args_reason\=filetypewarn.*</field>
        <description>Zscaler-Decoy: Threat Intel - Possible Sophos Web Appliance CVE-2023-1671 Exploitation Attempt (via webserver)</description>
        <group>high,one-on-one,s-a,T1190,T1059,T1071,T1071.001,CVE-2023-1671,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1059 </id>
            <id>T1071</id>
            <id>T1071.001</id>
        </mitre>
        <info type="text">
        Description:
            The vulnerability with CVE-2023-1671, which allows for pre-auth RCE in Sophos Web Appliance, could be targeted by adversaries who could exploit it with relative ease.  The attack involves routing UsrBlocked.php through index.php?c=blocked and providing the necessary POST parameters. The Base64-encoded user_encoded parameter is particularly  suitable for executing command injections.
        </info>
    </rule>
    <!-- RECON SysAid -->
    <rule id="101301" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">(?i).*\/userentry\?accountId=\/\.\.\/\.\.\/\.\.\/tomcat\/webapps\/.*.*symbolName=.*.*base64UserName=.*</field>
        <description>Zscaler-Decoy: Threat Intel - Possible exploitation of a vulnerability in SysAid (CVE-2023-47246)</description>
        <group>high,one-on-one,s-a,T1190,T1006,CVE-2023-1671,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1006</id>
        </mitre>
        <info type="text">
        Description:
        CVE-2023-47246 is a path traversal vulnerability that can be exploited by attackers to achieve remote code execution. This flaw allows an attacker to manipulate file paths in order to write malicious files to the Tomcat webroot directory. Once the attacker places a file in this location, it can be executed by the server, leading to full system compromise. The exploitation process often involves bypassing access controls and taking advantage of improper input validation. Once an attacker gains access to the file system in this manner, they can potentially execute arbitrary commands, making it a high threat if unpatched. Proper mitigation includes timely patching and implementing stricter access controls.
        </info>
    </rule>
    <!-- RECON VMware-aria -->
    <rule id="101303" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">(?i).*\/saas.\/resttosaasservlet</field>
        <field name="recon.request_body" type="pcre2">(?i).*\[1,\"createSupportBundle.*|.*\[1,\\x22createSupportBundle.*</field>
        <description>Zscaler-Decoy: Threat Intel - Possible exploitation of a vulnerability in VMware VRealize Network Insight (CVE-2023-20887)</description>
        <group>high,one-on-one,s-a,T1190,T1210 ,T1003 ,CVE-2023-20887,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1210 </id>
            <id>T1003 </id>
        </mitre>
        <info type="text">
        Description:
        CVE-2023-20887 is a high vulnerability in VMware vRealize Network Insight that allows attackers to perform remote code execution without requiring authentication. This flaw enables malicious actors to execute arbitrary code on the affected system, potentially gaining full control over the application and underlying infrastructure. Because the attack doesn't require credentials, it poses a severe risk, particularly if the system is exposed to the internet or lacks sufficient network segmentation. Immediate patching and the implementation of strict access controls are essential to mitigate the impact of this vulnerability.
        </info>
    </rule>
    <rule id="101304" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">(?i).*\/api\/events\/push-notifications</field>
        <field name="recon.request_body" type="pcre2">(?i).*endOffset\":.*|.*endOffset\\x22:.*</field>
        <description>Zscaler-Decoy: Threat Intel - Possible exploitation of a vulnerability in VMware Aria Operations for Networks (CVE-2023-20888)</description>
        <group>high,one-on-one,s-a,T1190,T1210 ,T1003 ,CVE-2023-20888,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1210 </id>
            <id>T1003 </id>
        </mitre>
        <info type="text">
        Description:
      CVE-2023-20888 is a high deserialization vulnerability in VMware vRealize Aria Operations for Networks that allows attackers to perform authenticated remote code execution. This vulnerability occurs when untrusted data is improperly deserialized, enabling attackers with valid credentials to inject malicious code. Once exploited, the attacker can execute arbitrary code on the server, potentially compromising the entire system. Although authentication is required, the risk remains high, particularly if attackers have access to credentials or can leverage other weaknesses. Prompt patching and securing user accounts are crucial steps to prevent exploitation.
        </info>
    </rule>
    <!-- RECON Wordpress -->
    <rule id="101305" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">(?i).*\/wp-admin\/admin\.php\?page=rsvp-admin-export</field>
        <description>Zscaler-Decoy: Threat Intel - Possible exploitation of a vulnerability in WordPress RSVP and Event Management (CVE-2022-1054)</description>
        <group>low,one-on-one,T1190,T1589,T1078,CVE-2022-1054,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1589  </id>
            <id>T1078  </id>
        </mitre>
        <info type="text">
        Description:
     An adversary exploited a missing authorization vulnerability (CVE-2022-1054) in the WordPress RSVP and Event Management plugin versions below 2.7.8. This vulnerability arises because the plugin lacks proper authorization checks when exporting entries, and its export function is tied to the "init" action. As a result, unauthenticated attackers can make a web request to trigger the export functionality and retrieve sensitive personally identifiable information (PII), such as users' first names, last names, and email addresses, registered for events. This flaw exposes event participant data and poses a significant privacy risk if not properly addressed.on.
        </info>
    </rule>
    <rule id="101306" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">(?i).*\/wp-admin\/admin\.php\?page=rsvp-admin-export</field>
        <description>Zscaler-Decoy: Threat Intel - Possible exploitation of a vulnerability in WordPress WPQA (CVE-2022-1598)</description>
        <group>low,one-on-one,T1190,T1589,T1078,CVE-2022-1054,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T0871  </id>
            <id>T1078  </id>
        </mitre>
        <info type="text">
        Description:
     An adversary exploited an improper access control vulnerability (CVE-2022-1598) in the WordPress WPQA plugin versions prior to 5.5. This vulnerability stems from the lack of authentication in a REST API endpoint, allowing an attacker to make a web request and access private questions exchanged between users on the site. Without proper access controls, unauthorized users can potentially view sensitive conversations, leading to a breach of user privacy. To mitigate this risk, it's essential to update the plugin and implement robust authentication for API endpoints
        </info>
    </rule>
    <!-- RECON ws_ftp -->
    <rule id="101437" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^POST$</field>
        <field name="recon.request_uri" type="pcre2">(?i).*\/AHT\/.*</field>
        <field name="recon.request_body" type="pcre2">(?i).*AHT\_DEFAULT\_UPLOAD\_PARAMETER.*|.*AHT\_UPLOAD\_PARAMETER.*</field>
        <description>Zscaler-Decoy: Threat Intel - Possible exploitation of a vulnerability in WS_FTP server Ad Hoc Transfer module of Progress (CVE-2023-40044)</description>
        <group>high,one-on-one,s-a,T1210,T1071.002,T1036,CVE-2023-40044,lateral-movement,</group>
        <mitre>
            <id>T1210 </id>
            <id>T1071.002</id>
            <id>T1036</id>
        </mitre>
        <info type="text">
        Description:
     In WS_FTP Server versions prior to 8.7.4 and 8.8.2, a pre-authenticated attacker could leverage a .NET deserialization vulnerability in the Ad Hoc Transfer module to execute remote commands on the underlying WS_FTP Server operating system. The vulnerability lies in the application's handling of multipart file uploads, which can be exploited by manipulating the content of the request.
        </info>
    </rule>
    <!-- RECON xwikirce -->
    <rule id="101307" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.method" type="pcre2">(?i)^GET$</field>
        <field name="recon.request_uri" type="pcre2">(?i).*.*\/bin\/view\/\%22\%5D\%5D\%20\%7B\%7Basync\%20async\%3D\%22true\%22\%20cached\%3D\%22false\%22\%20context\%3D\%22doc\.reference\%22\%7D\%7D\%7B\%7B.*.\%7B\%7B\%2Fasync\%7D\%7D\?sheet\=SkinsCode\.XWikiSkinsSheet\.*xpage\=view.*|.*.*\/bin\/view\/\%22\%5d\%5d\%20\%7b\%7b\%61\%73\%79\%6e\%63\%20\%61\%73\%79\%6e\%63\%3d\%22\%74\%72\%75\%65\%22\%20\%63\%61\%63\%68\%65\%64\%3d\%22\%66\%61\%6c\%73\%65\%22\%20\%63\%6f\%6e\%74\%65\%78\%74\%3d\%22\%64\%6f\%63\%2e\%72\%65\%66\%65\%72\%65\%6e\%63\%65\%22\%7d\%7d\%7b\%7b.*.\%7b\%7b\%2f\%61\%73\%79\%6e\%63\%7d\%7d\?sheet\=SkinsCode\.XWikiSkinsSheet\.*xpage\=view.*</field>
        <description>Zscaler-Decoy: Threat Intel - Possible XWiki Platform - Remote Code Execution (CVE-2023-37462)</description>
        <group>high,one-on-one,s-a,T1210,T1071.002,T1036,CVE-2023-37462,lateral-movement,</group>
        <mitre>
            <id>T1210 </id>
            <id>T1055</id>
            <id>T1059.006</id>
            <id>T1547</id>
        </mitre>
        <info type="text">
        Description:
     XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Improper escaping in the document 'SkinsCode.XWikiSkinsSheet' leads to an injection vector from view right on that document to programming rights, or in other words, it is possible to execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. The attack works by opening a non-existing page with a name crafted to contain a dangerous payload.
        </info>
    </rule>
    <!-- Sub rule_SCADA_modbus -->
    <rule id="101308" level="1" noalert="1">
        <if_sid>101218</if_sid>
        <field name="subtype" type="pcre2">(?i)^modbus$</field>
        <description>Zscaler-Decoy: SSH modbus log detected</description>
        <info type="text"></info>
        <group>low,one-on-one,T1078,T1078,T1078.003,initial-access,</group>
    </rule>
    <!-- SCADA_mod_enum need to check log for modbus.func -->
    <rule id="101309" level="1">
        <if_sid>101308</if_sid>
        <field name="modbus.func" type="pcre2">(?i)REPORT_SLAVE_ID|ENCAP_INTERFACE_TRANSPORT</field>
        <description>Zscaler-Decoy: Attempt to discover and identify Modbus devices</description>
        <group>low,one-on-one,T1210,T1071.002,T1036,CVE-2023-40044,lateral-movement,</group>
        <mitre>
            <id>T1210 </id>
            <id>T1071.002</id>
            <id>T1036</id>
        </mitre>
        <info type="text">
        Description:
     Modbus is a widely used protocol in SCADA (Supervisory Control and Data Acquisition) systems, and this event suggests that an adversary is attempting to enumerate Modbus devices such as Field Controllers, RTUs (Remote Terminal Units), PLCs (Programmable Logic Controllers), or IEDs (Intelligent Electronic Devices). The attacker is likely seeking information such as vendor details, model numbers, and slave ID data. This reconnaissance activity may involve the use of tools like Nmap scripts or custom malware to scan and gather data from the Modbus network, potentially in preparation for further exploitation. Immediate monitoring and security measures are recommended to prevent unauthorized access to high infrastructure.
        </info>
    </rule>
    <rule id="101310" level="1">
        <if_sid>101308</if_sid>
        <field name="modbus.func" type="pcre2">(?i)READ_COILS|READ_HOLDING_REGISTERS_EXCEPTION|READ_INPUT_REGISTERS|READ_INPUT_REGISTERS_EXCEPTION|READ_HOLDING_REGISTER|READ_DISCRETE_INPUTS_EXCEPTION</field>
        <description>Zscaler-Decoy: Attempt to read coils/registers of Modbus devices</description>
        <group>low,one-on-one,T1210,T1071.002,T1036,CVE-2023-40044,lateral-movement,</group>
        <mitre>
            <id>T1210 </id>
            <id>T1071.002</id>
            <id>T1036</id>
        </mitre>
        <info type="text">
        Description:
     Modbus is one of the popular SCADA protocols. This event indicates that the adversary is trying to read coils/registers data from Modbus devices like Field Controller/RTU/PLC/IED. There is a possibility that the attacker may be using malware or tools like modscan, mbtget to read coils/registers values.further exploitation. Immediate monitoring and security measures are recommended to prevent unauthorized access to high infrastructure.
        </info>
    </rule>
    <rule id="101311" level="1">
        <if_sid>101308</if_sid>
        <field name="modbus.func" type="pcre2">(?i)WRITE_SINGLE_COIL|WRITE_MULTIPLE_REGISTERS_EXCEPTION|WRITE_SINGLE_REGISTER_EXCEPTION</field>
        <description>Zscaler-Decoy: Attempt to wirte coils/registers of Modbus devices</description>
        <group>low,one-on-one,T1210,T1071.002,T1036,CVE-2023-40044,lateral-movement,</group>
        <mitre>
            <id>T1210 </id>
            <id>T1071.002</id>
            <id>T1036</id>
        </mitre>
        <info type="text">
        Description:
     Modbus is one of the popular SCADA protocols. This event indicates that the adversary is trying to write data to coils/registers of Modbus devices like Field Controller/RTU/PLC/IED. There is a possibility that the adversary may be using malware or tools like modscan, mbtget to read coils/registers values. This is a very serious event as it indicates that the adversary may be trying to inject malicious values to the coils/registers in unintended ways which in turn can be an enabler for machines to not function properly or can disrupt operations
        </info>
    </rule>
    <!-- SMB ransomware -->
    <rule id="101312" level="1">
        <if_sid>101218</if_sid>
        <field name="smb_files.action" type="pcre2">(?i)^SMB::FILE_RENAME$</field>
        <field name="smb_files.name" type="pcre2">(?i).*\..*\..*</field>
        <description>Zscaler-Decoy: Ransomware-like behavior detected</description>
        <group>high,one-on-one,s-a,T1210,T1070.004,T1048.002,lateral-movement,</group>
        <mitre>
            <id>T1486 </id>
            <id>T1070.004</id>
            <id>T1048.002</id>
        </mitre>
        <info type="text">
        Description:
     Ransomware-like behavior detected against a decoy.  The host interacted with a decoy SMB share and renamed files. Ransomware can target network file servers and attempt to encrypt the hosted files.  The presence of this traffic may indicate that the host is infected with Ransomware and the variant can be identified by the renamed file extensions.
        </info>
    </rule>
    <!-- SSH subtype-rule -->
    <rule id="101313" level="1" noalert="1">
        <if_sid>101215</if_sid>
        <field name="subtype" type="pcre2">(?i)^auth$</field>
        <description>Zscaler-Decoy: SSH credentials submitted</description>
        <info type="text">
        Description:
        SSH database credential submission has been recorded.This occurs when an adversary has obtained credentials to the SSH service and is attempting to verify it's validity by login in to the decoy.
        </info>
        <group>low,one-on-one,T1078,T1078,T1078.003,initial-access,</group>
    </rule>
    <rule id="101314" level="1">
        <if_sid>101313</if_sid>
        <field name="linux.user" type="pcre2">(?i)^root$</field>
        <description>Zscaler-Decoy: SSH credentials submitted for root</description>
        <info type="text">
        Description:
        SSH service credential submission has been recorded against a decoy with SSH service. The username used was "root"This occurs when an adversary has obtained credentials to the  SSH service and is attempting to use it to login to the SSH service to verify it's validity. 
        </info>
        <group>low,one-on-one,T1078,T1078,T1078.003,initial-access,</group>
    </rule>
    <!-- Telnet Subtype-rule  -->
    <rule id="101315" level="1" noalert="1">
        <if_sid>101216</if_sid>
        <field name="subtype" type="pcre2">(?i)^auth$</field>
        <description>Zscaler-Decoy: Telnet credentials submitted</description>
        <info type="text">
        Description:
        An adversary has attempted to interact with the telnet service on a decoy.Telnet provides a bidirectional interactive text-oriented communication facility using a virtual terminal connection and is therefore a useful service for an adversary.This generally occurs when an adversary has access to the service credentials and is attempting to interact with a service to check the validity of the credentials.
        </info>
        <group>low,one-on-one,T1078,T1078,T1078.003,initial-access,</group>
    </rule>
    <!-- Wannacry -->
    <rule id="101316" level="1">
        <if_sid>101207</if_sid>
        <field name="smb_mapping.path" type="pcre2">(?i).*\\\\192.168.56.20\\IPC\$.*|.*\\\\172.16.99.5\\IPC\$.*/</field>
        <description>Zscaler-Decoy: WannaCry DARKPULSAR ping</description>
        <group>high,one-on-one,s-a,T1210,T1070.002,T1049,T1486,CVE-2017-0144,lateral-movement,</group>
        <mitre>
            <id>T1210</id>
            <id>T1071.002</id>
            <id>T1049</id>
            <id>T1486 </id>
        </mitre>
        <info type="text">
        Description:
     The WannaCry ransomware attempts to propagate across networks via SMB by targeting other hosts using hard-coded SMB paths that include specific IP addresses, such as 192.168.56.20 and 172.16.99.5. Detection of traffic involving these IPs may indicate that the attacking host is infected with WannaCry and is actively trying to spread the infection. This behavior is a key indicator of a WannaCry infection, and immediate steps should be taken to isolate the affected host, analyze the traffic, and prevent further compromise of the network.
        </info>
    </rule>
    <!-- threat magnet -->
    <rule id="101412" level="1">
        <if_sid>101200</if_sid>
        <match type="pcre2">(?i)threatmagnet</match>
        <match type="pcre2">(?i)threatmagnet.system_names</match>
        <description>Zscaler-Decoy: Attempt to access application credentials (ThreatMagnets)</description>
        <group>high,one-on-one,s-a,T1190,T1505,T1555,T1003,CVE-2023-26360,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1555</id>
            <id>T1003</id>
            <id>T1505</id>
        </mitre>
        <info type="text">
        Description:
      Attempt to access application credentials (ThreatMagnets) has been detected. User applications like Chrome, PuTTY can store saved credentials in files or registry. Adversaries can dump these credentials using tools like LaZagne, Mimikatz. After obtaining credentials from various applications and browsers, adversaries can use these credentials to access appropriate servers and applications or reuse them to facilitate Lateral Movement
        </info>
    </rule>
    <!-- web adobe -->
    <rule id="101317" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/cf_scripts\/scripts\/ajax\/ckeditor\/plugins\/filemanager\/iedit\.cfc\?method=.*\.*_cfclient=true</field>
        <field name="web.request_body" type="pcre2">(?i)_variables=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2023-26360)</description>
        <group>high,one-on-one,s-a,T1190,T1105,T1211,CVE-2023-26360,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1105</id>
            <id>T1211</id>
        </mitre>
        <info type="text">
        Description:
      Adobe ColdFusion CVE-2023-26360 was exploited in the wild in Adobe ColdFusion product, a commercial application server for rapid web application development. The vulnerability affects both the 2018 and 2021 versions, allows adversaries to drop malware using HTTP POST commands by improper access control. The CVE encompasses two exploit methods arbitrary file reading and remote code execution which involves making a request with an injected 'cfexecute' tag allowing adversaries to execute unauthenticated RCE (Remote Code Execution) without user interaction through untrusted JSON data.
        </info>
    </rule>
    <rule id="101318" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/\/\/CFIDE\/adminapi\/accessmanager\.cfc\?method=foo.*_cfclient=true</field>
        <field name="web.request_body" type="pcre2">(?i).*argumentCollection=%3CwddxPacket\+version%3D%271\.0.*|.*argumentCollection=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2023-29300)</description>
        <group>high,one-on-one,s-a,T1190,T1105,T1211,CVE-2023-26360,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1105</id>
            <id>T1211</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with an arbitary code execution affecting Adobe ColdFusion (CVE-2023-29300) Adobe ColdFusion versions 2018u16 (and earlier), 2021u6 (and earlier) and 2023.0.0.330468 (and earlier) are affected by a Deserialization of Untrusted Data vulnerability that could result in Arbitrary code execution. Exploitation of this issue does not require user interaction.
        </info>
    </rule>
    <rule id="101319" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/hax\/\.\.CFIDE\/wizards\/common\/utils\.cfc\?method=wizardHash.*inPassword=foo.*_cfclient=true.*returnFormat=wddx/|/.*\/\/CFIDE\/wizards\/common\/utils\.cfc\?method=wizardHash.*inPassword=foo.*_cfclient=true.*returnFormat=wddx/</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2023-29298 and CVE-2023-38205)</description>
        <group>high,one-on-one,s-a,T1190,T1068,T1211,T1213,CVE-2023-29298,CVE-2023-38205,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1068</id>
            <id>T1213</id>
            <id>T1211</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited an access control bypass vulnerability in Adobe ColdFusion, specifically targeting CVE-2023-29298 and CVE-2023-38205. This vulnerability affects Adobe ColdFusion versions 2018u18 (and earlier), 2021u8 (and earlier), and 2023u2 (and earlier). Due to improper access control mechanisms, an attacker can bypass security features and gain unauthorized access to high administration CFM and CFC endpoints. This exploitation can occur without any user interaction, making it a particularly dangerous vulnerability. Immediate patching and tightening of access controls are essential to prevent unauthorized access and potential system compromise.
        </info>
    </rule>
    <rule id="101320" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^GET$</field>
        <field name="web.request_uri" type="pcre2">(?i).*pms\?module=logging.*file_name=.*.*number_of_lines=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Adobe ColdFusion (CVE-2024-20767)</description>
        <group>high,one-on-one,s-a,T1190,T1083,T1485,T1211,CVE-2024-20767,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1083</id>
            <id>T1485</id>
            <id>T1211</id>
        </mitre>
        <info type="text">
        Description:
      The vulnerability exploited by an adversary circumvents security measures in Adobe ColdFusion, allowing unauthorized access to confidential files and enabling arbitrary write operations to the file system without requiring user authentication. This access control flaw affects Adobe ColdFusion versions prior to 2023.6 and 2021.12. The vulnerability allows attackers to exploit directory traversal attacks to reach restricted areas of the file system. Immediate updates to these versions and a review of access controls are high to mitigate potential unauthorized access and system compromise.
        </info>
    </rule>
    <rule id="101321" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/admin\/airflow\/code\?root=.*dag_id=example_passing_params_via_test_command.*|.*\/code\?dag_id=example_passing_params_via_test_command.*</field>
        <description>Zscaler-Decoy: Possible exploitation of Apache Airflow OS Command Injection vulnerability (CVE-2022-24288)</description>
        <group>high,one-on-one,s-a,T1190,T1083,T1485,T1211,CVE-2024-24288,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1083</id>
            <id>T1485</id>
            <id>T1211</id>
        </mitre>
        <info type="text">
        Description:
      The vulnerability exploited by an adversary circumvents security measures in Adobe ColdFusion, allowing unauthorized access to confidential files and enabling arbitrary write operations to the file system without requiring user authentication. This access control flaw affects Adobe ColdFusion versions prior to 2023.6 and 2021.12. The vulnerability allows attackers to exploit directory traversal attacks to reach restricted areas of the file system. Immediate updates to these versions and a review of access controls are high to mitigate potential unauthorized access and system compromise.
        </info>
    </rule>
    <!-- doubt -->
    <rule id="101322" level="1">
        <if_sid>101214</if_sid>
        <field name="recon.request_uri" type="pcre2">(?i).*(\$|%24).*(\{|%7[b|B]).*java.*lang.*Runtime.*exec.*</field>
        <description>Zscaler-Decoy: Possible exploitation of Atlassian Confluence OGNL injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1071,T1005,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203</id>
            <id>T1071</id>
            <id>T1005</id>
        </mitre>
        <info type="text">
        Description:
      The adversary has made a web request associated with an RCE vulnerability (CVE-2022-26134) in Atlassian Confluence Server and Data Center. This vulnerability allows the adversary to execute code without authentication.
        </info>
    </rule>
    <!-- doubt -->
    <rule id="101325" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*(\$|%24).*(\{|%7[b|B]).*java.*lang.*Runtime.*exec.*</field>
        <description>Zscaler-Decoy: Possible exploitation of Atlassian Confluence OGNL injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1071,T1005,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203</id>
            <id>T1071</id>
            <id>T1005</id>
        </mitre>
        <info type="text">
        Description:
      The adversary has made a web request associated with an RCE vulnerability (CVE-2022-26134) in Atlassian Confluence Server and Data Center. This vulnerability allows the adversary to execute code without authentication.
        </info>
    </rule>
    <rule id="101323" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/InsightPluginShowGeneralConfiguration\.jspa;</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Atlassian Jira Seraph (CVE-2022-0540)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1548.002,T1071,T1071.001,CVE-2022-0540,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1548.002</id>
            <id>T1071</id>
            <id>T1071.001 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with an Authentication Bypass vulnerability (CVE-2022-0540) in Atlassian Jira Seraph. Jira Seraph allows a remote, unauthenticated attacker to bypass authentication by sending a specially crafted HTTP request. This affects Atlassian Jira Server and Data Center versions before 8.13.18, versions 8.14.0 and later before 8.20.6, and versions 8.21.0 and later before 8.22.0. This also affects Atlassian Jira Service Management Server and Data Center versions before 4.13.18, versions 4.14.0 and later before 4.20.6, and versions 4.21.0 and later before 4.22.0.
        </info>
    </rule>
    <rule id="101324" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*username\"\:\s+\[\".*(admin|administrator|super|root).*</field>
        <description>Zscaler-Decoy: Attempted web login using an administrator account</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1548.002,T1071,T1071.001,CVE-2022-0540,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1548.002</id>
            <id>T1071</id>
            <id>T1071.001 </id>
        </mitre>
        <info type="text">
        Description:
      Admin, administrator or a root credential submission has been recorded against a Web decoy. This could mean: An adversary is testing the validity of credentials that may have been obtained via Credential Access. An adversary is attempting a brute force attack against a decoy. An adversary is testing default credentials against a decoy. Compromised credentials may also grant an adversary increased privilege to specific systems or access to restricted areas of the network..0.
        </info>
    </rule>
    <rule id="101326" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/%77eb%75i_%77sma_Http/|/.*\/%2577eb%2575i_%2577sma_Http/|/.*\/webui_wsma_http</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Cisco IOS XE (CVE-2023-20198)</description>
        <group>high,one-on-one,s-a,T1190,T1068,T1210,T1078,CVE-2023-20198,lateral-movement,</group>
        <mitre>
            <id>T1190</id>
            <id>T1068</id>
            <id>T1210</id>
            <id>T1078</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited the Cisco IOS XE Web UI Privilege Escalation vulnerability (CVE-2023-20198) to gain initial access to the application. This vulnerability allows the attacker to elevate their privileges within the web UI, which can then be leveraged to chain with other vulnerabilities, ultimately leading to remote code execution. This escalation can compromise the system, enabling the attacker to execute arbitrary commands, potentially taking full control of the affected device. Immediate patching and security measures are necessary to prevent further exploitation and maintain system integrity.
        </info>
    </rule>
    <rule id="101327" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/gwtest\/formssso\?event=start.*target=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Citrix ADC (CVE-2023-3519)</description>
        <group>high,one-on-one,s-a,T1190,T1021,T1040,T1068,CVE-2023-3519,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1021</id>
            <id>T1040</id>
            <id>T1068</id>
        </mitre>
        <info type="text">
        Description:
      CVE-2023-3519 is a high vulnerability in Citrix ADC that allows an attacker to achieve unauthenticated remote code execution on vulnerable, unpatched versions of the software. If exploited, this vulnerability could enable an attacker to execute arbitrary commands on the Citrix ADC, potentially leading to full control over the device and the broader network it manages. This can result in significant security risks, including data breaches, network compromise, and further propagation of attacks. Immediate patching of affected systems is essential to prevent exploitation.
        </info>
    </rule>
    <rule id="101328" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/documentum\/upload\.aspx\?parentid=.*.*raw=1.*unzip=on.*uploadid=.*.*filename=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Citrix ShareFile (CVE-2023-24489)</description>
        <group>high,one-on-one,s-a,T1190,T1039,T1210,T1586,CVE-2023-24489,lateral-movement,</group>
        <mitre>
            <id>T1190</id>
            <id>T1039</id>
            <id>T1210</id>
            <id>T1586</id>
        </mitre>
        <info type="text">
        Description:
      A security flaw has been identified in the ShareFile storage zones controller managed by customers. If successfully exploited, this vulnerability could enable an unauthorized attacker to compromise the customer-managed ShareFile storage zones controller remotely. The impact of this vulnerability extends to all currently supported versions of the customer-managed ShareFile storage zones controller that are prior to version 5.11.24.
        </info>
    </rule>
    <!-- doubt -->
    <rule id="101329" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/file-manager\/backend\/makefile.*|.*\/file-manager\/backend\/text.*|.*\/file-manager\/backend\/permissions.*</field>
        <field name="web.request_body" type="pcre2">(?i)id\=\/htdocs\/app\/files\/public.*|id\=\/htdocs\/app\/files\/public.*|id\=\/htdocs\/app\/files\/public.*/</field>
        <description>Zscaler-Decoy: Potential remote code execution vulnerability in CloudPanel 2  2.3.1 (CVE-2023-35885)</description>
        <group>high,one-on-one,s-a,T1190,T1039,T1210,T1586,CVE-2023-24489,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1039</id>
            <id>T1210</id>
            <id>T1586</id>
        </mitre>
        <info type="text">
        Description:
      The attack exploits a remote code execution vulnerability in CloudPanel versions prior to 2.3.1 (CVE-2023-35885). The attack begins with the use of default secret keys and the default user account named "clp." The file manager in CloudPanel lacks session authentication, leading to broken access control. By inserting a cookie with the clp-fm encrypted value using the default secret key, the attacker can decrypt it into a serialized string. The attacker can then modify the user value to the default "clp" user. When combined with PHP Object Injection, this significantly increases the impact, potentially allowing for remote code execution
        </info>
    </rule>
    <rule id="101330" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request" type="pcre2">.*headers.Cookie.*clp-fm\=.*</field>
        <description>Zscaler-Decoy: Potential remote code execution vulnerability in CloudPanel 2  2.3.1 (CVE-2023-35885)</description>
        <group>high,one-on-one,s-a,T1190,T1039,T1210,T1586,CVE-2023-24489,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1039</id>
            <id>T1210</id>
            <id>T1586</id>
        </mitre>
        <info type="text">
        Description:
      The attack exploits a remote code execution vulnerability in CloudPanel versions prior to 2.3.1 (CVE-2023-35885). The attack begins with the use of default secret keys and the default user account named "clp." The file manager in CloudPanel lacks session authentication, leading to broken access control. By inserting a cookie with the clp-fm encrypted value using the default secret key, the attacker can decrypt it into a serialized string. The attacker can then modify the user value to the default "clp" user. When combined with PHP Object Injection, this significantly increases the impact, potentially allowing for remote code execution
        </info>
    </rule>
    <rule id="101413" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request.cookies.clp-fm" type="pcre2">.*cookies.clp-fm.*.*.</field>
        <description>Zscaler-Decoy: Potential remote code execution vulnerability in CloudPanel 2  2.3.1 (CVE-2023-35885)</description>
        <group>high,one-on-one,s-a,T1190,T1039,T1210,T1586,CVE-2023-24489,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1039</id>
            <id>T1210</id>
            <id>T1586</id>
        </mitre>
        <info type="text">
        Description:
      The attack exploits a remote code execution vulnerability in CloudPanel versions prior to 2.3.1 (CVE-2023-35885). The attack begins with the use of default secret keys and the default user account named "clp." The file manager in CloudPanel lacks session authentication, leading to broken access control. By inserting a cookie with the clp-fm encrypted value using the default secret key, the attacker can decrypt it into a serialized string. The attacker can then modify the user value to the default "clp" user. When combined with PHP Object Injection, this significantly increases the impact, potentially allowing for remote code execution
        </info>
    </rule>
    <!-- doubt -->
    <rule id="101331" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i)\/server-info\.action\?bootstrapStatusProvider\.applicationConfig\.setupComplete=.*|\/setup\/setupadministrator-start\.action</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22515)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1068,T1548.002,CVE-2023-22515,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1068</id>
            <id>T1548.002</id>
        </mitre>
        <info type="text">
        Description:
      Adversaries can exploit CVE-2023-22515, a broken access control vulnerability in Atlassian Confluence Data Center and Server, to create a new admin account and authenticate themselves with administrative privileges. This vulnerability allows attackers to bypass authentication or escalate privileges, leading to potential full control over the Confluence environment
      </info>
    </rule>
    <rule id="101332" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/setup\/setupadministrator\.action</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22515)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1068,T1548.002,CVE-2023-22515,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1068</id>
            <id>T1548.002</id>
        </mitre>
        <info type="text">
        Description:
      Adversaries can exploit CVE-2023-22515, a broken access control vulnerability in Atlassian Confluence Data Center and Server, to create a new admin account and authenticate themselves with administrative privileges. This vulnerability allows attackers to bypass authentication or escalate privileges, leading to potential full control over the Confluence environment
        </info>
    </rule>
    <rule id="101333" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/json\/setup-restore\.action.*</field>
        <field name="web.request_body" type="pcre2">(?i).*name=\"buildIndex\".*|.*name=%22buildIndex%22.*|.*name=%5Cx22buildIndex%5Cx22.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Atlassian Confluence Data center and server (CVE-2023-22518)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1560,T1608,T1608.001,CVE-2023-22518,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1560</id>
            <id>T1608</id>
            <id>T1608.001</id>
        </mitre>
        <info type="text">
        Description:
      Adversaries can exploit CVE-2023-22518, an improper authorization vulnerability in Atlassian Confluence Data Center and Server, to upload a backup ZIP file and restore the Confluence instance without any authentication. This exploitation can be used to reset and create an administrator account, which can be further escalated to achieve remote code execution (RCE) and establish a backdoor for persistent access.
        </info>
    </rule>
    <rule id="101334" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)^/template/aui/text-inline.vm$</field>
        <field name="web.request_body" type="pcre2">(?i)label=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of template injection vulnerability in Atlassian Confluence Data Center and Server (CVE-2023-22527)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1221,T1608,T1059.006,CVE-2023-22527,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1221</id>
            <id>T1608</id>
            <id>T1059.006</id>
        </mitre>
        <info type="text">
        Description:
      The vulnerability (CVE-2023-22527) in Atlassian's Confluence Server and Data Center allows unauthenticated attackers to inject OGNL expressions for template injection attack, enabling arbitrary code execution and potential compromise of affected instances. This Remote Code Execution vulnerability affects out-of-date Confluence Data Center and Server 8 versions released before Dec. 5, 2023 as well as 8.4.5 which no longer receives backported fixes in accordance with Security Bug Fix Policy. Atlassian recommends patching to the latest version immediately.
        </info>
    </rule>
    <rule id="101335" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*password\"\:\s+\[\".*.*</field>
        <field name="web.post_data" type="pcre2" negate="yes">(?i).*username\"\:\s+\[\".*(admin|administrator|super|root).*</field>
        <description>Zscaler-Decoy: Attempted web login</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1110,T1110,T1059.006,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1110</id>
            <id>T1110</id>
            <id>T1059.006</id>
        </mitre>
        <info type="text">
        Description:
      Credential submission has been recorded against a web decoy for non-admin or administrator/root user accounts. This activity could indicate an attacker testing the validity of credentials obtained through phishing, external sources, or credential access techniques. Multiple credential submissions might suggest a brute force attempt. Adversaries may steal credentials using credential access techniques or capture them through social engineering during their reconnaissance process to gain initial access. Compromised credentials could provide increased privileges, bypass access controls, and facilitate persistent access to remote systems, VPNs, Outlook Web Access, or remote desktops. Adversaries might avoid using malware or tools to make their activities less detectable. Alternatively, this could be a legitimate user checking their server credentials
        </info>
    </rule>
    <!-- doubt 101336-37-38 -->
    <rule id="101336" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*.*username\"\:\s+\[\".*(\b)(on\S+)(\s*)=|javascript|(\.*\s*)(\/*)script.*|.*.*username\"\:\s+\[\".*(alert\(|prompt).*</field>
        <description>Zscaler-Decoy: Attempt to exploit Cross Site Scripting Vulnerability</description>
        <group>high,one-on-one,s-a,T1078,T1203,T1059,T1189,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1059</id>
            <id>T1189</id>
        </mitre>
        <info type="text">
        Description:
      Cross-site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in a web browser of the victim by including malicious code in a legitimate web page or web application. The actual attack occurs when the victim visits the web page or web application that executes the malicious code. The web page or web application becomes a vehicle to deliver the malicious script to the user's browser. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site.
        </info>
    </rule>
    <rule id="101337" level="1">
        <if_sid>101217</if_sid>
        <field name=" web.post_data" type="pcre2">(?i).*.*password\"\:\s+\[\".*(\b)(on\S+)(\s*)=|javascript|(\.*\s*)(\/*)script.*|.*.*password\"\:\s+\[\".*(alert\(|prompt).*/</field>
        <description>Zscaler-Decoy: Attempt to exploit Cross Site Scripting Vulnerability</description>
        <group>high,one-on-one,s-a,T1078,T1203,T1059,T1189,initial-access</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1059</id>
            <id>T1189</id>
        </mitre>
        <info type="text">
        Description:
      Cross-site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in a web browser of the victim by including malicious code in a legitimate web page or web application. The actual attack occurs when the victim visits the web page or web application that executes the malicious code. The web page or web application becomes a vehicle to deliver the malicious script to the user's browser. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site.
        </info>
    </rule>
    <rule id="101338" level="1">
        <if_sid>101217</if_sid>
        <field name="web.user_agent.string" type="pcre2">(?i).*(\b)(on\S+)(\s*)=|javascript|(\.*\s*)(\/*)script.*|.*(alert\(|prompt).*/</field>
        <description>Zscaler-Decoy: Attempt to exploit Cross Site Scripting Vulnerability</description>
        <group>high,one-on-one,s-a,T1078,T1203,T1059,T1189,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1059</id>
            <id>T1189</id>
        </mitre>
        <info type="text">
        Description:
      Cross-site Scripting (XSS) is a client-side code injection attack. The attacker aims to execute malicious scripts in a web browser of the victim by including malicious code in a legitimate web page or web application. The actual attack occurs when the victim visits the web page or web application that executes the malicious code. The web page or web application becomes a vehicle to deliver the malicious script to the user's browser. The end user's browser has no way to know that the script should not be trusted, and will execute the script. Because it thinks the script came from a trusted source, the malicious script can access any cookies, session tokens, or other sensitive information retained by the browser and used with that site.
        </info>
    </rule>
    <rule id="101339" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/dview8\/api\/usersByLevel</field>
        <field name="web.request.headers.Authorization" type="pcre2">.*[A-Za-z0-9_-]{2,}(?:\.[A-Za-z0-9_-]{2,}){2}</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in D-Link D-View 8 v2.0.1.28 (CVE-2023-5074)</description>
        <group>high,one-on-one,s-a,T1078,T1552,T1552.001,T1134.002,T1212,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1134.002</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with an authentication bypass vulnerability affecting D-Link D-View 8 v2.0.1.28 (CVE-2023-5074) Use of a static key to protect a JWT token used in user authentication can allow an for an authentication bypass Upon D-View 8 installation, there is no API key configured for the default user admin. In addition, the userId for the admin user appears to remain the same (59171d56-e6b4-4789-90ff-a7a27fd48548) across installations. With a known JWT secret key, an unauthenticated remote attacker can craft a valid JWT token and use the token to access protected APIs.
        </info>
    </rule>
    <rule id="101341" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i)\/cgi-bin\/nas_sharing\.cgi\?user=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in D-Link Network Attached Storage (CVE-2024-3273)</description>
        <group>high,one-on-one,s-a,T1078,T1552,T1552.001,T1134.002,T1212,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1134.002</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a Command Injection vulnerability affecting D-Link DNS-320L, DNS-325, DNS-327L and DNS-340L up to 20240403 (CVE-2024-3273) A vulnerability, which was classified as high. Affected is an unknown function of the file /cgi-bin/nas_sharing.cgi of the component HTTP GET Request Handler. The manipulation of the argument system leads to command injection. It is possible to launch the attack remotely. The identifier of this vulnerability is VDB-259284. This vulnerability only affects products that are no longer supported by the maintainer.
        </info>
    </rule>
    <rule id="101342" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/aspera\/faspex\/package_relay\/relay_package</field>
        <field name="web.request_body" type="pcre2">(?i).*{"package_file_list": \["\/"], "external_emails": "\\n---\\n- !ruby\/object:Gem::Installer\\n    i: x\\n- !ruby\/object:Gem::SpecFetcher\\n.*|.*{\\x22package_file_list\\x22: \[\\x22\/\\x22], \\x22external_emails\\x22: \\x22\\x5Cn---\\x5Cn- !ruby\/object:Gem::Installer\\x5Cn    i: x\\x5Cn- !ruby\/object:Gem::SpecFetcher\\x5Cn    i: y\\x5Cn.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in IBM Aspera Faspex =4.4.2 PL1 (CVE-2022-47986)</description>
        <group>high,one-on-one,s-a,T1078,T1499,T1499.001,T1203,T0871,CVE-2022-47986,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1499</id>
            <id>T1499.001</id>
            <id>T1203</id>
            <id>T0871</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a Remote Code Execution vulnerability affecting IBM Aspera Faspex =4.4.2 PL1 IBM Aspera Faspex through 4.4.2 Patch Level 1 is susceptible to remote code execution via a YAML deserialization flaw. This can allow an attacker to send a specially crafted obsolete API call and thereby execute arbitrary code, obtain sensitive data, and/or execute other unauthorized operations.
        </info>
    </rule>
    <rule id="101343" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i)\/res\/login\.jsf\?javax\.faces\.ViewState.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in IBM Operational Decision Manager (CVE-2024-22320)</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1059,T1210,CVE-2024-22320,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited a Remote Code Execution (RCE) vulnerability in IBM Operational Decision Manager versions 8.10.3, 8.10.4, 8.10.5.1, 8.11, 8.11.0.1, and 8.12.0.1 (CVE-2024-22320). This vulnerability is due to unsafe deserialization, which allows a remote authenticated attacker to execute arbitrary code on the affected system. By sending a specially crafted request, the attacker can execute code in the context of the SYSTEM user, potentially leading to full system compromise. Immediate mitigation steps include applying the latest security patches and monitoring for any suspicious activity.
        </info>
    </rule>
    <rule id="101344" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i)\/api\/v1\/totp\/user-backup-code\/\.\.\/\.\.\/system\/system-information.*|/\/api\/v1\/system\/system-information.*|/\/api\/v1\/cav\/client\/status\/\.\.\/\.\.\/admin\/options.*|/\/api\/v1\/cav\/admin\/options.*|/\/api\/v1\/totp\/user-backup-code\/%2E%2E\/%2E%2E\/system\/system-information.*|/\/api\/v1\/cav\/client\/status\/%2E%2E\/%2E%2E\/admin\/options.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2023-46805)</description>
        <group>high,one-on-one,s-a,T1190,T1068,T1068.001,T1041,CVE-2023-46805,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1068</id>
            <id>T1068.001</id>
            <id>T1041</id>
        </mitre>
        <info type="text">
        Description:
     An adversary has exploited an Authentication Bypass vulnerability (CVE-2023-46805) affecting Ivanti Connect Secure (ICS) versions 9.x and 22.x, as well as Ivanti Policy Secure (IPS) versions 9.x and 22.x. This flaw resides in the web component of these applications, allowing a remote attacker to bypass authentication mechanisms and gain unauthorized access to restricted resources. This access could lead to further exploitation, including privilege escalation, data exfiltration, or network compromise.
        </info>
    </rule>
    <rule id="101345" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i)\/api\/v1\/totp\/user-backup-code\/\.\.\/\.\.\/license\/keys-status\/%3bcurl%20.*|\/api\/v1\/license\/keys-status\/%3bcurl%20.*|\/api\/v1\/totp\/user-backup-code\/%2E%2E\/%2E%2E\/system\/maintenance\/archiving\/cloud-server-test-connection.*|\/api\/v1\/totp\/user-backup-code\/\.\.\/\.\.\/system\/maintenance\/archiving\/cloud-server-test-connection.*|\/api\/v1\/system\/maintenance\/archiving\/cloud-server-test-connection.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2024-21887)</description>
        <group>high,one-on-one,s-a,T1078,T1203,T1074,T1485,CVE-2024-21887,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1074</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited a Command Injection vulnerability (CVE-2024-21887) affecting Ivanti Connect Secure (ICS) versions 9.x and 22.x, as well as Ivanti Policy Secure (IPS) versions 9.x and 22.x. This vulnerability resides in the web components of these applications, where an authenticated administrator can send specially crafted requests to execute arbitrary commands on the appliance. This could lead to full system compromise, allowing the adversary to gain unauthorized control, exfiltrate sensitive data, or disrupt network operations. Immediate patching and robust access controls are crucial to mitigate this risk.
        </info>
    </rule>
    <rule id="101346" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/dana-na\/auth\/saml-sso\.cgi.*</field>
        <field name="web.request_body" type="pcre2">(?i).*SAMLRequest.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Ivanti Connect Secure (9.x, 22.x) and Ivanti Policy Secure (9.x, 22.x) (CVE-2024-22024)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1140,T1221,CVE-2024-22024,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203</id>
            <id>T1140</id>
            <id>T1221 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited an XML External Entity (XXE) injection vulnerability (CVE-2024-22024) affecting Ivanti Connect Secure (ICS) versions 9.x and 22.x, Ivanti Policy Secure (IPS) versions 9.x and 22.x, and ZTA gateways. This XXE vulnerability in the SAML component allows an attacker to access restricted resources without proper authentication. By sending specially crafted XML data, the attacker can exploit this weakness to gain unauthorized access to sensitive information or systems.
        </info>
    </rule>
    <rule id="101347" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)dana-ws\/saml20.ws</field>
        <field name="web.request_body" type="pcre2">(?i).*ds:RetrievalMethod URI.*|.*ds%3ARetrievalMethod%20URI.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Ivanti connect secure (CVE-2024-21893)</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1068,T1210,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>T1068</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited a Server-Side Request Forgery (SSRF) vulnerability (CVE-2024-21893) affecting Ivanti Connect Secure, Ivanti Policy Secure, and Ivanti Neurons. This vulnerability allows an unauthenticated threat actor to send crafted requests that can access restricted resources within the internal network. When combined with CVE-2024-21887, which is a Command Injection vulnerability, the attacker could chain these vulnerabilities to achieve remote code execution on the affected systems. This combination of vulnerabilities could lead to significant security breaches, including unauthorized access, system compromise, and data exfiltration
        </info>
    </rule>
    <rule id="101348" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/cli\?remoting=false.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Jenkins 2.441 and earlier (CVE-2024-23897)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1210,T0807,CVE-2024-23897,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203</id>
            <id>T1210</id>
            <id>T0807</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited an arbitrary file read vulnerability (CVE-2024-23897) affecting Jenkins versions 2.441 and earlier, as well as LTS 2.426.2 and earlier. This vulnerability stems from a feature in Jenkins' CLI command parser that does not disable the handling of '@' characters followed by a file path in an argument. This oversight allows unauthenticated attackers to read arbitrary files on the Jenkins controller file system by injecting crafted commands. If exploited, this vulnerability can lead to Remote Code Execution (RCE), potentially allowing attackers to execute arbitrary code on the Jenkins server and gain full control over the environment.
        </info>
    </rule>
    <rule id="101349" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/hax\?jsp=\/app\/rest\/server;\.jsp</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in JetBrains TeamCity (CVE-2024-27198)</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1071,T1071.001,CVE-2024-27198,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>1071</id>
            <id>T1071.001</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited an Authentication Bypass vulnerability (CVE-2024-27198) affecting JetBrains TeamCity versions before 2023.11.4. The vulnerability exists due to the default exposure of TeamCity’s web server on HTTP port 8111, which can be accessed directly or optionally configured for HTTPS. An attacker can craft a URL to bypass all authentication checks, allowing unauthenticated access to endpoints that should be protected. This can lead to complete control over a vulnerable TeamCity server, enabling unauthorized actions such as data exfiltration, configuration changes, or further system compromises.
        </info>
    </rule>
    <rule id="101340" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/res\/\.\.\/admin\/diagnostic\.jsp|.*\/\.well-known\/acme-challenge\/\.\.\/\.\.\/admin\/diagnostic\.jsp|.*\/update\/\.\.\/admin\/diagnostic\.jsp</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in JetBrains TeamCity (CVE-2024-27199)</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1071,T1071.001,CVE-2024-27198,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>1071</id>
            <id>T1071.001</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a Authentication Bypass vulnerability affecting JetBrains TeamCity before 2023.11.4 (CVE-2024-27199) It is an authentication bypass vulnerability in the web component of TeamCity that arises from a path traversal issue and has a CVSS base score of 7.3 vulnerability, CVE-2024-27199 allows for a limited amount of information disclosure and a limited amount of system modification, including the ability for an unauthenticated attacker to replace the HTTPS certificate in a vulnerable TeamCity server with a certificate of the attacker's choosing.
        </info>
    </rule>
    <rule id="101350" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/webauth_operation\.php.*</field>
        <field name="web.request_body" type="pcre2">(?i)rs=do_upload.*rsargs%5B%5D=%5B%7B%22fileData%22%3A\+%22data%3Atext%2Fhtml%3Bbase64%.*|rs=do_upload.*rsargs%5B%5D=%5B%7B%5Cx22fileData%5Cx22%3A\+%5Cx22data%3Atext%2Fhtml%3Bbase64%.*|rs=do_upload.*rsargs\[]=\[{"fileData": "data:text\/html;base64.*|rs=do_upload.*rsargs\[]=\[{\\x22fileData\\x22: \\x22data:text\/html;base64.*|rs=do_upload.*rsargs\[]=\[{"fileName": "{{rand_base\(5, "abc"\)}}\.ini".*|rs=do_upload.*rsargs\[]=\[{\\x22fileName\\x22: \\x22{{rand_base\(5, \\x22abc\\x22\)}}\.ini.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Juniper Networks J-Web (CVE-2023-36844)</description>
        <group>high,one-on-one,s-a,T1068,T1190,T1600,CVE-2023-36844,initial-access,</group>
        <mitre>
            <id>T1068</id>
            <id>T1190</id>
            <id>T1600</id>
        </mitre>
        <info type="text">
        Description:
     An adversary has exploited a Remote Code Execution vulnerability (CVE-2023-36844) in Juniper Networks J-Web, part of Junos OS on EX Series switches. This vulnerability involves PHP External Variable Modification, where an unauthenticated, network-based attacker can control important environment variables via a crafted request. By manipulating these PHP environment variables, the attacker can achieve partial loss of integrity, potentially chaining this vulnerability with others to execute arbitrary code or compromise the system further.
        </info>
    </rule>
    <rule id="101351" level="1">
        <if_sid>101217</if_sid>
        <field name="web.http_basicauth_user" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a high vulnerability in Apache Log4j has been detected against a decoy. CVE-2021-44228, also known as Log4Shell, is a severe vulnerability in the Log4j logging library that allows unauthenticated users to execute arbitrary code on the server. This vulnerability can be exploited by sending specially crafted log messages that are processed by Log4j, resulting in remote code execution. The initial fix for CVE-2021-44228 was incomplete for certain non-default configurations, leading to the discovery of CVE-2021-45046. This secondary vulnerability exposed additional scenarios where the initial patch was insufficient, requiring further remediation.
        </info>
    </rule>
    <rule id="101352" level="1">
        <if_sid>101217</if_sid>
        <field name="web.http_referrer" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101353" level="1">
        <if_sid>101217</if_sid>
        <field name=" web.http_x_forwarded_for" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101354" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101355" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101356" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_body" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101357" level="1">
        <if_sid>101217</if_sid>
        <field name="web.server_name" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101358" level="1">
        <if_sid>101217</if_sid>
        <field name="web.user_agent.string" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101359" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request.headers.X-Api-Version" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101360" level="1">
        <if_sid>101217</if_sid>
        <field name="web.X-Api-Version" type="pcre2">(?i).*\$\{.*j.*n.*d.*i.*\:(\/|\\).*\}.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-44228/CVE-2021-45046)</description>
        <group>high,one-on-one,s-a,T1190,T1203,T1654,T1210,CVE-2021-44228/CVE-2021-45046,execution,</group>
        <mitre>
            <id>T1190</id>
            <id>T1203 </id>
            <id>T1654</id>
            <id>T1210 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-44228 is a high vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can enable unauthenticated users to execute arbitrary code on the server. The fix to address CVE-2021-44228 was incomplete in certain non-default configurations and is tracked as CVE-2021-45046.
        </info>
    </rule>
    <rule id="101361" level="1">
        <if_sid>101217</if_sid>
        <field name="web.http_basicauth_user" type="pcre2">(?i)/.*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101362" level="1">
        <if_sid>101217</if_sid>
        <field name="web.http_referrer" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101363" level="1">
        <if_sid>101217</if_sid>
        <field name="web.http_x_forwarded_for" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101364" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101365" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101366" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_body" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101367" level="1">
        <if_sid>101217</if_sid>
        <field name="web.server_name" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101368" level="1">
        <if_sid>101217</if_sid>
        <field name="web.user_agent.string" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101369" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request.headers.X-Api-Version" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101370" level="1">
        <if_sid>101217</if_sid>
        <field name="web.X-Api-Version" type="pcre2">(?i).*(\$\{\$\{\:\:\-.*\$\$\{\:\:\-.*\}\}.*\}|\$\{ctx\:.*\}).*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Apache Log4j (CVE-2021-45105)</description>
        <group>high,one-on-one,s-a,T1499,T1654,CVE-2021-45105,impact,</group>
        <mitre>
            <id>T1499</id>
            <id>T1654</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a vulnerability in Apache Log4j detected against a decoy.CVE-2021-45105 is a high severity vulnerability in the logging library, Log4j. The exploitation of vulnerable servers can result in a DOS (Denial of Service) attack.
        </info>
    </rule>
    <rule id="101371" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/api\/setup\/validate</field>
        <field name="web.request_body" type="pcre2">(?i){\"token\":\".*\",\"details\":{\"details\":{.*</field>
        <description>Zscaler-Decoy: Possible exploitation of vulnerability in Metabase open source web application (CVE-2023-38646)</description>
        <group>high,one-on-one,s-a,T1078,T1543,T1543.003,T1134,T1190,CVE-2023-38646,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1543</id>
            <id>T1543.003</id>
            <id>T1134</id>
            <id>T1190</id>
        </mitre>
        <info type="text">
        Description:
      Metabase, an open-source business intelligence tool is vulnerable to remote code execution. The vulnerability stemmed from an exposed setup token even after installation, allowing unauthenticated users to access it. By exploiting a SQL injection flaw in the H2 database driver used by Metabase, adversaries could execute arbitrary code. The issue affected instances set up after a specific commit made in January 2022. The exploit involved crafting a specific payload to achieve reliable remote code execution. Metabase have addressed the vulnerability from version v0.46.6.1.
        </info>
    </rule>
    <rule id="101372" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/api\/users\/search_authors</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Microweber (CVE-2022-0281)</description>
        <group>high,one-on-one,s-a,T1190,T1580,T1071,CVE-2022-0281,initial-access,</group>
        <mitre>
            <id>T1190 </id>
            <id>T1580 </id>
            <id>T1071</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with an Information Disclosure vulnerability (CVE-2022-0281) in Packagist microweber/microweber prior to 1.2.11. This vulnerability allows any unauthorized/unauthenticated actor can find the PII data of all the users registered in the application. PII - Personally Identifiable Information leaked by this application is first name, last name, email id, picture, username, is_admin status.
        </info>
    </rule>
    <rule id="101373" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^GET$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/mifs\/asfV3\/api\/v2\/.*</field>
        <description>Zscaler-Decoy: Possible MobileIron Core - Remote Unauthenticated API Access (CVE-2023-35082)</description>
        <group>high,one-on-one,s-a,T1190,T1580,T1485,CVE-2023-35082,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1580</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      A high API access vulnerability (CVE-2023-35082) in Ivanti Endpoint Manager Mobile (EPMM), formerly known as MobileIron Core, has been exploited in the wild. The vulnerability arises due to permissive entries in the security filter chain of the mifs web application, allowing unauthenticated attackers to access the API. This flaw enables attackers to perform a variety of malicious actions, such as disclosing Personally Identifiable Information (PII) and making unauthorized modifications to the platform.
        </info>
    </rule>
    <rule id="101374" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$|^PUT$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/api\/v1\/token|.*\/api\/v1\/auth\/token|.*\/api\/v1\/folders\/[0-9]+\/files|.*\/guestaccess.aspx|.*\/api\/v1\/folders\/[0-9_-]+\/files|.*\/moveitisapi\/moveitisapi.dll.*|.*\/api\/v1\/folders|.*\/api\/v1\/files\/.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in MOVEit Transfer (CVE-2023-34362)</description>
        <group>high,one-on-one,s-a,T1078,T1552,T1552.001,T1134,T1134.002,T1212,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1134</id>
            <id>T1134.002</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has attempted to exploit CVE-2023-34362, a high SQL injection vulnerability in MOVEit Transfer, which allows for unauthenticated access to the underlying database. This flaw enables the attacker to interact directly with the database, depending on the engine used. An attacker may gain sensitive information, modify or delete records, and potentially execute arbitrary code on the affected server. Due to the severity of this vulnerability, organizations using MOVEit Transfer should apply available patches and implement robust database security measures to prevent unauthorized access.
        </info>
    </rule>
    <rule id="101375" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/oauth\/idp\/\.well-known\/openid-configuration</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Citrix NetScaler (CVE-2023-4966)</description>
        <group>high,one-on-one,s-a,T1190,T1552,T1552.001,T1589,T1592,CVE-2023-4966,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1589</id>
            <id>T1592</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has abused the unauthenticated buffer-related vulnerability (CVE-2023-4966) that causes a high information disclosure in NetScaler ADC and NetScaler Gateway.
        </info>
    </rule>
    <rule id="101414" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/logon\/LogonPoint\/Authentication\/GetUserName</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Citrix NetScaler (CVE-2023-4966)</description>
        <group>high,one-on-one,s-a,T1190,T1552.T1552.001,T1589,T1592,CVE-2023-4966,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1589</id>
            <id>T1592</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has abused the unauthenticated buffer-related vulnerability (CVE-2023-4966) that causes a high information disclosure in NetScaler ADC and NetScaler Gateway.
        </info>
    </rule>
    <rule id="101376" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/app</field>
        <field name="web.request_body" type="pcre2">(?i).*service=direct%2F1%2FSetupCompleted%2F%24Form.*sp=S0.*Form0=%24Hidden%2CanalyticsEnabled%2C%24Submit.*%24Hidden=true.*%24Submit=Login.*|.*service=direct%2F1%2FConfigEditor%2FquickFindForm.*sp=S0.*Form0=%24TextField%2CdoQuickFind%2Cclear.*%24TextField=print-and-device\.script\.enabled.*doQuickFind=Go.*|.*service=direct%2F1%2FConfigEditor%2F%24Form.*sp=S1.*Form1=%24TextField%240%2C%24Submit%2C%24Submit%240.*%24TextField%240=Y.*%24Submit=Update.*|.*service=direct%2F1%2FConfigEditor%2FquickFindForm.*sp=S0.*Form0=%24TextField%2CdoQuickFind%2Cclear.*%24TextField=print\.script\.sandboxed.*doQuickFind=Go.*|.*service=direct%2F1%2FConfigEditor%2F%24Form.*sp=S1.*Form1=%24TextField%240%2C%24Submit%2C%24Submit%240.*%24TextField%240=N.*%24Submit=Update.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Papercut MF/NG (CVE-2023-27350)</description>
        <group>high,one-on-one,s-a,T1059,T1548.002,T1190,T1211,initial-access,</group>
        <mitre>
            <id>T1059</id>
            <id>T1190</id>
            <id>T1548.002</id>
            <id>T1211</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with an RCE vulnerability (CVE-2023-27350) in PaperCut MF/NG 22.0.5 (Build 63914). This vulnerability allows remote attackers to bypass authentication on affected installations of PaperCut NG 22.0.5 Authentication is not required to exploit this vulnerability, the specific flaw exists within the SetupCompleted class and issue results from improper access control. An attacker can leverage this vulnerability to bypass authentication and execute arbitrary code in the context of SYSTEM.
        </info>
    </rule>
    <rule id="101377" level="1">
        <if_sid>101207</if_sid>
        <field name="threat.alert.signature" type="pcre2">(?i)^ET WEB_CLIENT Possible Confluence SSTI Exploitation Attempt - Leads to RCE/LFI (CVE-2019-3396)$</field>
        <description>Zscaler-Decoy: Possible Confluence SSTI Exploitation Attempt (CVE-2019-3396)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T210,T1221,CVE-2019-3396,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1210</id>
            <id>T1221 </id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit a Server-Side Template Injection (SSTI) vulnerability (CVE-2019-3396) in Atlassian Confluence has been detected. This vulnerability allows an unauthenticated attacker to inject malicious code via the Widget Connector macro, which could lead to Remote Code Execution (RCE) or Local File Inclusion (LFI) on the Confluence server. If successfully exploited, the attacker could execute arbitrary commands on the server, leading to data theft, server compromise, or lateral movement within the network.
        </info>
    </rule>
    <rule id="101378" level="1">
        <if_sid>101217</if_sid>
        <field name="threat.alert.signature_id" type="pcre2">(?i)^2027333$</field>
        <description>Zscaler-Decoy: Possible Confluence SSTI Exploitation Attempt (CVE-2019-3396)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1203,T1083,T1221,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1071</id>
            <id>T1203</id>
            <id>T1083</id>
            <id>T1221 </id>
        </mitre>
        <info type="text">
        Description:
      A potential attempt to exploit CVE-2019-3396, a high Server-Side Template Injection (SSTI) vulnerability in Atlassian Confluence, has been detected. This vulnerability allows an unauthenticated remote attacker to inject malicious Object-Graph Navigation Language (OGNL) expressions into the Confluence server, leading to Remote Code Execution (RCE) or Local File Inclusion (LFI). The exploitation typically occurs via a web client through crafted HTTP requests, which can result in the compromise of the affected Confluence instance, giving the attacker the ability to execute arbitrary code or access sensitive files on the server.
        </info>
    </rule>
    <rule id="101379" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/flash\/addcrypted2.*</field>
        <field name="web.request_body" type="pcre2">(?i)jk=pyimport.*</field>
        <description>Zscaler-Decoy: Possible PyLoad - Pre-auth Remote Code Execution (CVE-2023-0297)</description>
        <group>high,one-on-one,s-a,T1190,T1059.007,T1210,T1203,T1499,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1210</id>
            <id>T1059.007</id>
            <id>T1203</id>
            <id>T1499</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit CVE-2023-0297, a high pre-authentication remote code execution vulnerability in PyLoad, has been detected. This vulnerability affects versions prior to 0.5.0b3.dev31 and arises from the pyimport functionality exposed through the js2py library. An unauthenticated attacker can exploit this by sending a specially crafted POST request to the flash/addcrypted2 endpoint, allowing them to inject and execute arbitrary code on the server.
        </info>
    </rule>
    <rule id="101380" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/render\/info\.html</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in pyLoad (CVE-2024-21644)</description>
        <group>high,one-on-one,s-a,T1078,T1552,T1552.001,T1185,T1212,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1185</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a Configuration File Disclosure vulnerability affecting pyLoad 0.5.0b3 (CVE-2024-21644) pyLoad is the free and open-source Download Manager written in pure Python. Any unauthenticated user can browse to a specific URL to expose the Flask config, including the `SECRET_KEY` variable. This issue has been patched in version 0.5.0b3.dev77
        </info>
    </rule>
    <rule id="101381" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i)\/login\?next=(https:\/\/www\.|http:\/\/www\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,})(\.[a-zA-Z0-9]{2,})?/|/\/login\?next=(https:\/\/www\.|http:\/\/www\.|https:\/\/|http:\/\/)?[a-zA-Z0-9]{2,}(\.[a-zA-Z0-9]{2,})(\.[a-zA-Z0-9]{2,})?\/logs</field>
        <field name="web.request_body" type="pcre2">(?i)do=login.*username=.*|do=login.*username=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in pyLoad (CVE-2024-21645)</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1055,T1212,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1055</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a log injection vulnerability affecting pyLoad version  0.5.0b3.dev76 (CVE-2024-21645) pyLoad is the free and open-source Download Manager written in pure Python. A log injection vulnerability was identified in pyload. This vulnerability allows any unauthenticated actor to inject arbitrary messages into the logs gathered by pyload.
        </info>
    </rule>
    <rule id="101382" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/sitecore\_xaml\.ashx\/\-\/xaml\/Sitecore\.Xaml\.Tutorials\.Styles\.Index</field>
        <field name="web.request_body" type="pcre2">(?i)\_\_ISEVENT\=1\.*\_\_SOURCE\=\.*\_\_PARAMETERS\=ParseControl\.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Multiple Sitecore products (CVE-2023-35813)</description>
        <group>high,one-on-one,s-a,T1190,T1059,T1203,</group>
        <mitre>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1203</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has attempted to exploit CVE-2023-35813, a high Remote Code Execution (RCE) vulnerability affecting multiple Sitecore products, including Experience Manager (XM), Experience Platform (XP), and Experience Commerce (XC). The vulnerability is triggered when a crafted POST request with encoded payloads is sent to the affected Sitecore products, allowing attackers to execute arbitrary code on the server. This vulnerability impacts all Experience Platform topologies from 9.0 Initial Release to 10.3 Initial Release, posing a significant risk to affected organizations by enabling remote code execution and system compromise.
        </info>
    </rule>
    <rule id="101383" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^GET$|^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/ws\/msw\/tenant\/.*|.*\/appliance\/applianceMainPage</field>
        <field name="web.request_body" type="pcre2">(?i)action\=login\.*skipSessionCheck\=0\.*needPwdChange\=0\.*clientHash=.*|num\=3232150\.*action\=file\_system\.*task\=search\.*item\=application\_log\.*criteria\=\%2a\.*width\=500\.*searchFolder=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in SonicWall GMS product (CVE-2023-34124)</description>
        <group>high,one-on-one,s-a,T1190,T1102,T1059,T1203,</group>
        <mitre>
            <id>T1190</id>
            <id>T1102</id>
            <id>T1059</id>
            <id>T1203</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has attempted to exploit CVE-2023-34124, a Web Service Authentication Bypass vulnerability affecting SonicWall's Global Management System (GMS) product. This vulnerability allows attackers to bypass authentication by crafting specific web requests, gaining unauthorized access to execute commands and potentially compromising the system. This vulnerability affects GMS versions 9.3.2-SP1 and earlier, making it high for organizations using these versions to apply security patches immediately.
        </info>
    </rule>
    <rule id="101384" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/userportal\/Controller\?mode=8700.*operation=1.*datagrid=179.*json=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in Sophos Firewall (CVE-2022-1040)</description>
        <group>high,one-on-one,s-a,T1190,T1068,T1552,T1552.001,T1021.004,</group>
        <mitre>
            <id>T1190</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1068</id>
            <id>T1021.004</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has attempted to exploit CVE-2022-1040, a Remote Code Execution (RCE) vulnerability affecting Sophos Firewall. This vulnerability, present in Sophos Firewall v18.5 MR3 and earlier, exists in the User Portal and Webadmin interfaces. It allows an unauthenticated attacker to bypass authentication and execute arbitrary code remotely by crafting malicious web requests.
        </info>
    </rule>
    <rule id="101385" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*sleep\.*</field>
        <description>Zscaler-Decoy: Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1059,T1059.003,T1485,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.003</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101386" level="1">
        <if_sid>101217</if_sid>
        <field name="web.query_string" type="pcre2">(?i).*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*sleep\.*</field>
        <description>Zscaler-Decoy: Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1059,T1059.003,T1485,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.003</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101387" level="1">
        <if_sid>101217</if_sid>
        <field name="web.user_agent.string" type="pcre2">(?i).*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*sleep\.*</field>
        <description>Zscaler-Decoy: Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1059,T1059.003,T1485,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.003</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101388" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*.*password\"\:\s+\[\".*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*password\"\:\s+\[\".*('|"|\)) or.*|.*.*password\"\:\s+\[\".*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*.*password\"\:\s+\[\".*sleep\.*</field>
        <description>Zscaler-Decoy: Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1059,T1059.003,T1485,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.003</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101389" level="1">
        <if_sid>101217</if_sid>
        <field name="web.post_data" type="pcre2">(?i).*.*username\"\:\s+\[\".*(\'|\%27|%2527).*(\-\-|\%23|%2523|\#).*|.*.*username\"\:\s+\[\".*('|"|\)) or.*|.*(UNION ALL SELECT|UNION SELECT @@VERSION|ORDER BY).*|.*.*username\"\:\s+\[\".*sleep\.*</field>
        <description>Zscaler-Decoy: Attempt to exploit SQL Injection vulnerability</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1059,T1059.003,T1485,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1059</id>
            <id>T1059.003</id>
            <id>T1485</id>
        </mitre>
        <info type="text">
        Description:
      SQL Injection (SQLi) is a type of an injection attack that makes it possible to execute malicious SQL statements. These statements control a database server behind a web application. Attackers can use SQL Injection vulnerabilities to bypass application security measures. They can go around authentication and authorization of a web page or web application and retrieve the content of the entire SQL database. They can also use SQL Injection to add, modify, and delete records in the database. To perform an SQL Injection attack , an attacker must first find vulnerable user inputs within the web page or web application. A web page or web application that has an SQL Injection vulnerability uses such user input directly in an SQL query. The attacker can create input content. Such content is often called a malicious payload and is the key part of the attack. After the attacker sends this content, malicious SQL commands are executed in the database.This can be used to access, modify, and delete data. In some cases, you can also use SQL commands to run operating system commands.
        </info>
    </rule>
    <rule id="101390" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/userentry\?accountId=\/\.\.\/\.\.\/\.\.\/tomcat\/webapps\/.*.*symbolName=.*.*base64UserName=.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in SysAid (CVE-2023-47246)</description>
        <group>high,one-on-one,s-a,T1190,T1105,T1003,T1059,T1210,</group>
        <mitre>
            <id>T1190 </id>
            <id>T1105</id>
            <id>T1003</id>
            <id>T1059</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has exploited CVE-2023-47246, a Path Traversal vulnerability in SysAid that can lead to Remote Code Execution (RCE). This vulnerability allows attackers to manipulate file paths and write arbitrary files to the Tomcat webroot directory. Once the malicious file is placed in the webroot, the attacker can execute arbitrary code on the server by accessing the file via the web. This vulnerability poses a serious risk, as it could enable attackers to compromise the SysAid server entirely.
        </info>
    </rule>
    <rule id="101391" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/saas.\/resttosaasservlet</field>
        <field name="web.request_body" type="pcre2">(?i).*\[1,\"createSupportBundle.*|.*\[1,\\x22createSupportBundle.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in VMware VRealize Network Insight (CVE-2023-20887)</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1021,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>T1021 </id>
        </mitre>
        <info type="text">
        Description:
      CVE-2023-20887 is a high vulnerability in the VMware VRealize Network Insight that allows the attackers to perform unauthenticated remote code execution.
        </info>
    </rule>
    <rule id="101392" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/api\/events\/push-notifications</field>
        <field name="web.request_body" type="pcre2">(?i) /.*endOffset\":.*|.*endOffset\\x22:.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in VMware Aria Operations for Networks (CVE-2023-20888)</description>
        <group>high,one-on-one,s-a,T1078,T1005,T1203,T1021,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1005</id>
            <id>T1021 </id>
        </mitre>
        <info type="text">
        Description:
      CVE-2023-20888 is a high deserialization vulnerability in the VMware VRealize Aria Operations for Networks that allows the attackers to perform authenticated remote code execution.
        </info>
    </rule>
    <rule id="101393" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/wp-admin\/admin\.php\?page=rsvp-admin-export</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in WordPress RSVP and Event Management (CVE-2022-1054)</description>
        <group>high,one-on-one,s-a,T1078,T1552,T1552.001,T1134.002,T1212,</group>
        <mitre>
            <id>T1078</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1134.002</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a missing authorization vulnerability (CVE-2022-1054) in WordPress RSVP and Event Management 2.7.8 The plugin does not have any authorisation checks when exporting its entries, and has the export function hooked to the init action. As a result, unauthenticated attackers could call it and retrieve PII such as first name, last name and email address of users registered for events
        </info>
    </rule>
    <rule id="101394" level="1">
        <if_sid>101217</if_sid>
        <field name="web.request_uri" type="pcre2">(?i).*\/wp-json\/wp\/v2\/asked-question</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in WordPress WPQA (CVE-2022-1598)</description>
        <group>high,one-on-one,s-a,T1078,T1530,T1190,T1071 ,</group>
        <mitre>
            <id>T1078</id>
            <id>T1530</id>
            <id>T1190</id>
            <id>T1071</id>
        </mitre>
        <info type="text">
        Description:
      An adversary has made a web request associated with a improper access control vulnerability (CVE-2022-1598) in WordPress WPQA plugin before 5.5 The plugin lacks authentication in a REST API endpoint. An attacker can potentially discover private questions sent between users on the site.
        </info>
    </rule>
    <rule id="101395" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^POST$</field>
        <field name="web.request_uri" type="pcre2">(?i).*\/AHT\/.*</field>
        <field name="web.request_body" type="pcre2">(?i).*AHT\_DEFAULT\_UPLOAD\_PARAMETER.*|.*AHT\_UPLOAD\_PARAMETER.*</field>
        <description>Zscaler-Decoy: Possible exploitation of a vulnerability in WS_FTP server Ad Hoc Transfer module of Progress (CVE-2023-40044)</description>
        <group>high,one-on-one,s-a,T1068,T1059,T1059.001,T1098,T1212,</group>
        <mitre>
            <id>T1068</id>
            <id>T1059</id>
            <id>T1059.001</id>
            <id>T1098</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      In WS_FTP Server versions prior to 8.7.4 and 8.8.2, a pre-authenticated attacker could leverage a .NET deserialization vulnerability in the Ad Hoc Transfer module to execute remote commands on the underlying WS_FTP Server operating system. The vulnerability lies in the application's handling of multipart file uploads, which can be exploited by manipulating the content of the request.
        </info>
    </rule>
    <rule id="101396" level="1">
        <if_sid>101217</if_sid>
        <field name="web.method" type="pcre2">(?i)^GET$</field>
        <field name="web.request_uri" type="pcre2">(?i).*.*\/bin\/view\/\%22\%5D\%5D\%20\%7B\%7Basync\%20async\%3D\%22true\%22\%20cached\%3D\%22false\%22\%20context\%3D\%22doc\.reference\%22\%7D\%7D\%7B\%7B.*.\%7B\%7B\%2Fasync\%7D\%7D\?sheet\=SkinsCode\.XWikiSkinsSheet\.*xpage\=view.*|.*.*\/bin\/view\/\%22\%5d\%5d\%20\%7b\%7b\%61\%73\%79\%6e\%63\%20\%61\%73\%79\%6e\%63\%3d\%22\%74\%72\%75\%65\%22\%20\%63\%61\%63\%68\%65\%64\%3d\%22\%66\%61\%6c\%73\%65\%22\%20\%63\%6f\%6e\%74\%65\%78\%74\%3d\%22\%64\%6f\%63\%2e\%72\%65\%66\%65\%72\%65\%6e\%63\%65\%22\%7d\%7d\%7b\%7b.*.\%7b\%7b\%2f\%61\%73\%79\%6e\%63\%7d\%7d\?sheet\=SkinsCode\.XWikiSkinsSheet\.*xpage\=view.*</field>
        <description>Zscaler-Decoy: Possible XWiki Platform - Remote Code Execution (CVE-2023-37462)</description>
        <group>high,one-on-one,s-a,T1078,T1552,T1552.001,T1134,T1134.002,T1212,</group>
        <mitre>
            <id>T1078</id>
            <id>T1552</id>
            <id>T1552.001</id>
            <id>T1134</id>
            <id>T1134.002</id>
            <id>T1212 </id>
        </mitre>
        <info type="text">
        Description:
      XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. Improper escaping in the document 'SkinsCode.XWikiSkinsSheet' leads to an injection vector from view right on that document to programming rights, or in other words, it is possible to execute arbitrary script macros including Groovy and Python macros that allow remote code execution including unrestricted read and write access to all wiki contents. The attack works by opening a non-existing page with a name crafted to contain a dangerous payload.
        </info>
    </rule>
    <rule id="101397" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^mssql$</field>
        <description>Zscaler-Decoy: MSSQL connection detected</description>
        <group>high,one-on-one,s-a,T1078,T1190,TT1083,T1213,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>TT1083</id>
            <id>T1213</id>
        </mitre>
        <info type="text">
        Description:
      MSSQL service activity detected against a decoy. Adversaries target database servers primarily to extract sensitive information. In some cases, databases provide the adversary with command execution capabilities. 
        </info>
    </rule>
    <rule id="101398" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^psexec$</field>
        <description>Zscaler-Decoy: Windows PsExec lateral movement detected</description>
        <group>high,one-on-one,s-a,T1075,T1077,T1078,T1021.002,T1210,</group>
        <mitre>
            <id>T1075</id>
            <id>T1077</id>
            <id>T1078</id>
            <id>T1021.002</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      The use of PsExec was detected on windows decoy.  PsExec is a light-weight telnet-replacement that allows full remote command execution capabilities provided the adversary has the required rights. This is typically used for lateral movement when administrator level credentials have been obtained.
        </info>
    </rule>
    <rule id="101399" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^rdp_connect$|^rdp_disconnect$</field>
        <description>Zscaler-Decoy: Interactive RDP session</description>
        <group>high,one-on-one,s-a,T1078,T1106,T1076,T1021,</group>
        <mitre>
            <id>T1078</id>
            <id>T1106</id>
            <id>T1076</id>
            <id>T1021</id>
        </mitre>
        <info type="text">
        Description:
      Remote desktop is a common feature in operating systems. It allows a user to log into an interactive session with a system desktop graphical user interface on a remote system. Adversaries may connect to a remote system over RDP/RDS to expand access if the service is enabled and allows access to accounts with known credentials.  Adversaries will likely use Credential Access techniques to acquire credentials to use with RDP. Adversaries may also use RDP in conjunction with the Accessibility Features technique for Persistence. Adversaries may also perform RDP session hijacking which involves stealing a legitimate user's remote session. Typically, a user is notified when someone else is trying to steal their session and prompted with a question. With System permissions and using Terminal Services Console, c:\windows\system32\tscon.exe [session number to be stolen], an adversary can hijack a session without the need for credentials or prompts to the user.
        </info>
    </rule>
    <rule id="101400" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^winrm$</field>
        <description>Zscaler-Decoy: WinRM session detected</description>
        <group>high,one-on-one,s-a,T1078,T1021,T1021.001,T1071,T1071.001,T1059,T1059.001,T1212,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1021</id>
            <id>T1021.001</id>
            <id>T1071</id>
            <id>T1071.001</id>
            <id>T1059</id>
            <id>T1059.001</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      Windows Remote Management (WinRM) session detected WinRM is both, a Windows service and a protocol that allows a user to interact with a remote system. WinRM can be used to run an executable, modify the Registry, modify services, etc. Invoke-command and Enter-PSSession can be used to interact with remote systems using WinRM When a Windows Remote Management connection is opened, the client sends requests to port 5985 for HTTP or 5986 for HTTPS on the target host. 
        </info>
    </rule>
    <rule id="101401" level="1">
        <if_sid>101207</if_sid>
        <field name="threat.alert.signature" type="pcre2">(?i)^ET EXPLOIT [NCC GROUP] Possible Inbound RDP Exploitation Attempt (CVE-2019-0708)</field>
        <description>Zscaler-Decoy: Attempt to exploit CVE-2019-0708 (BlueKeep) vulnerability</description>
        <group>high,one-on-one,s-a,T1078,T1203,T1485,T1210,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1485</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit the CVE-2019-0708 vulnerability, also known as BlueKeep, was detected. This high vulnerability affects the Remote Desktop Protocol (RDP) service on older versions of Windows. It allows unauthenticated attackers to connect to a vulnerable system using RDP and send specially crafted requests that can lead to a Blue Screen of Death (BSoD) or Remote Code Execution (RCE). The severity of BlueKeep lies in its potential to propagate automatically, making it a prime candidate for widespread ransomware or worm attacks. 
        </info>
    </rule>
    <rule id="101402" level="1">
        <if_sid>101207</if_sid>
        <field name="threat.alert.signature_id" type="pcre2">(?i)^2027450$</field>
        <description>Zscaler-Decoy: Attempt to exploit CVE-2019-0708 (BlueKeep) vulnerability</description>
        <group>high,one-on-one,s-a,T1078,T1203,T1485,T1210,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1203</id>
            <id>T1485</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to exploit the CVE-2019-0708 vulnerability, also known as BlueKeep, was detected. This high vulnerability affects the Remote Desktop Protocol (RDP) service on older versions of Windows. It allows unauthenticated attackers to connect to a vulnerable system using RDP and send specially crafted requests that can lead to a Blue Screen of Death (BSoD) or Remote Code Execution (RCE). The severity of BlueKeep lies in its potential to propagate automatically, making it a prime candidate for widespread ransomware or worm attacks. 
        </info>
    </rule>
    <rule id="101403" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^process_create$</field>
        <field name="attacker.process.name" type="pcre2">(?i)(tasklist|arp|hostname|ipconfig|net|quser|qwinsta|systeminfo|winver|whoami)\.exe</field>
        <description>Zscaler-Decoy: Attempting to gain situational awareness of a Windows host</description>
        <group>high,one-on-one,s-a,T1078,T1082,T1046,T1012,initial-access,</group>
        <mitre>
            <id>T1082</id>
            <id>T1078</id>
            <id>T1012</id>
            <id>T1046</id>
        </mitre>
        <info type="text">
        Description:
      An adversary is making efforts to gain situational awareness of a Windows host by gathering detailed information about the system. This includes querying for information on the Windows operating system version, installed patches, hotfixes, service packs, and system architecture. Such reconnaissance activities are crucial for attackers as they allow them to tailor their exploitation techniques based on the specific configuration and vulnerabilities of the target system. 
        </info>
    </rule>
    <rule id="101404" level="1">
        <if_sid>101207</if_sid>
        <field name="sub_type" type="pcre2">(?i)^ntlm$</field>
        <field name="ntlm.success" type="pcre2" negate="yes">(?i)^true$</field>
        <field name="ntlm.username" type="pcre2">(?i).*</field>
        <description>Zscaler-Decoy: Windows NTLM logon failure</description>
        <group>high,one-on-one,s-a,T1190,T1078,T1110,T1110.003,T1003,initial-access,</group>
        <mitre>
            <id>T1190</id>
            <id>T1078</id>
            <id>T1110</id>
            <id>T1110.003</id>
            <id>T1003</id>
        </mitre>
        <info type="text">
        Description:
      NTLM logon failure was recorded against a decoy.NT LAN Manager (NTLM) is a suite of Microsoft security protocols that provides authentication, integrity, and confidentiality to users. An NTLM logon failure implies that an adversary attempted to authenticate with NTLM credentials that were rejected.This may be indicative of stolen credentials, or password brute-forcing attempts. 
        </info>
    </rule>
    <rule id="101405" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^process_create$</field>
        <field name="attacker.process.name" type="pcre2">(?i)/powershell\.exe</field>
        <description>Zscaler-Decoy: Windows PowerShell start detected</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1059,T1059.001,T1210,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1059.001</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      Powershell use was detected within a Windows decoy. The specific event pertains to the powershell process starting within the windows decoy. PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer.PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.Administrator permissions are required to use PowerShell to connect to remote systems.A number of PowerShell-based offensive testing tools are available, including Empire, PowerSploit, and PSAttack. 
        </info>
    </rule>
    <rule id="101406" level="1">
        <if_sid>101219</if_sid>
        <field name="sub_type" type="pcre2">(?i)^powershell$</field>
        <description>Zscaler-Decoy: Windows PowerShell commands detected</description>
        <group>high,one-on-one,s-a,T1078,T1190,T1059,T1059.001,T1210,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1190</id>
            <id>T1059</id>
            <id>T1059.001</id>
            <id>T1210</id>
        </mitre>
        <info type="text">
        Description:
      Powershell commands were detected being run within a Windows decoy.PowerShell is a powerful interactive command-line interface and scripting environment included in the Windows operating system. Adversaries can use PowerShell to perform a number of actions, including discovery of information and execution of code. Examples include the Start-Process cmdlet which can be used to run an executable and the Invoke-Command cmdlet which runs a command locally or on a remote computer.PowerShell may also be used to download and run executables from the Internet, which can be executed from disk or in memory without touching disk.Administrator permissions are required to use PowerShell to connect to remote systems.A number of PowerShell-based offensive testing tools are available, including Empire, PowerSploit, and PSAttack. 
        </info>
    </rule>
    <rule id="101407" level="1">
        <if_sid>101207</if_sid>
        <field name="dce_rpc.operation" type="pcre2">(?i)^SamrGetMembersInAlias$</field>
        <description>Zscaler-Decoy: Attempting to remotely enumerate local Windows groups</description>
        <group>high,one-on-one,s-a,T1078,T1069,T1021,T1081,T1070,T1547,initial-access,</group>
        <mitre>
            <id>T1078</id>
            <id>T1069 </id>
            <id>T1021</id>
            <id>T1081</id>
            <id>T1070</id>
            <id>T1081</id>
        </mitre>
        <info type="text">
        Description:
      An adversary is attempting to enumerate Windows local groups. This tactic is used to identify the membership of local groups, especially local 'administrator' group membership or 'Remote Desktop' users. 
        </info>
    </rule>
    <rule id="101408" level="1">
        <if_sid>101207</if_sid>
        <field name="dce_rpc.endpoint" type="pcre2">(?i)^winreg$</field>
        <description>Zscaler-Decoy: Windows remote registry connection attempt detected</description>
        <group>high,one-on-one,s-a,T1078,T1482,T1112,T1547,T1068,T1490,T1021,initial-access,</group>
        <mitre>
            <id>T1012</id>
            <id>T1482</id>
            <id>T1112</id>
            <id>T1547</id>
            <id>T1068</id>
            <id>T1490</id>
            <id>T1021</id>
        </mitre>
        <info type="text">
        Description:
      Adversaries may remotely connect to the Windows registry to enumerate keys for information gathering (for e.g. enumerating locally logged-on users), or modify data to support an attack (for e.g. enabling RDP). 
        </info>
    </rule>
    <rule id="101409" level="1">
        <if_sid>101207</if_sid>
        <field name="dce_rpc.operation" type="pcre2">(?i)^NetrSessionEnum$</field>
        <description>Zscaler-Decoy: Attempt to enumerate Windows SMB sessions remotely</description>
        <group>high,one-on-one,s-a,T1046,T1087,T1087.002,T1021,T1021.002,T1550,T1550.002,T1562,T1562.001,defense-evasion,</group>
        <mitre>
            <id>T1046</id>
            <id>T1087</id>
            <id>T1087.002</id>
            <id>T1021</id>
            <id>T1021.002</id>
            <id>T1550</id>
            <id>T1550.002</id>
            <id>T1562</id>
            <id>T1562.001</id>
        </mitre>
        <info type="text">
        Description:
      After identifying target users, adversaries need to find the computers that they are logged-on to. By enumerating SMB sessions via the NetSessionEnum method against the DC or other file servers, an attacker obtains information about which systems their target users are logged-on to. They can then target those machines in order to compromise the users in question.By default, the NetSessionEnum method can be executed by any authenticated user, including network connected users, which effectively means that any domain user is able to execute it remotely. 
        </info>
    </rule>
    <rule id="101410" level="1">
        <if_sid>101207</if_sid>
        <field name="dce_rpc.endpoint" type="pcre2">(?i)^winreg$</field>
        <field name="dce_rpc.operation" type="pcre2">(?i)^OpenUsers$</field>
        <description>Zscaler-Decoy: Remote user enumeration via Windows registry detected</description>
        <group>high,one-on-one,s-a,T1087,T1087.001,T1112,T1021,T1555,T1555.003,credential-access,</group>
        <mitre>
            <id>T1087</id>
            <id>T1087.001</id>
            <id>T1112</id>
            <id>T1021</id>
            <id>T1555</id>
            <id>T1555.003</id>
        </mitre>
        <info type="text">
        Description:
      An attempt to remotely enumerate users via the Windows Registry has been detected Adversaries may remotely connect to the Windows registry to enumerate users for information gathering. This is often a part of the user-hunting phase of an attack, where the adversary searches for where high-value target users are currently logged on in order to target those endpoints. 
        </info>
    </rule>
    <!--after 101410 rules are been added in middle till 101437-->
</group>
