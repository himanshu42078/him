<!--
Decoder Rule is 100
Rules are start in 1001-1057

Default Rules
102091	SonicWall Emergency message
102092	SonicWall Alert message
102093	SonicWall critical message
102094	SonicWall error message
102095	SonicWall warning message
102096	SonicWall notice message
102097	SonicWall informational message
102098	SonicWall debug message

-->
<group name="sonicwall,">
	<!-- <rule id="4800" level="0" noalert="1" overwrite="yes">
		<decoded_as>sonicwall</decoded_as>
		<description>SonicWall Firewall Events</description>
		<group>info,one-on-one,</group>
	</rule> -->
	<rule id="102089" level="0" noalert="1">
		<decoded_as>json</decoded_as>
		<field name="productName" type="pcre2">(?i)SonicWall</field>
		<description>SonicWall Firewall Events</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102090" level="1" noalert="1">
		<!-- <if_sid>102089,4800</if_sid> -->
		<if_sid>102089</if_sid>
		<description>SonicWall Firewall Events</description>
		<group>info,one-on-one,</group>
	</rule>

<!-- Default Severity base Rules Start -->
	
	<rule id="4801" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall critical message.</description>
        <group>info,one-on-one,</group>
	</rule>
	<rule id="4802" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall critical message.</description>
        <group>info,one-on-one,</group>
	</rule>
	<rule id="4803" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall error message.</description>
        <group>info,one-on-one,</group>
	</rule>
	<rule id="4804" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall warning message.</description>
        <group>info,one-on-one,</group>
	</rule>
	<rule id="4805" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall notice message.</description>
        <group>info,one-on-one,</group>
	</rule>
	<rule id="4806" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall informational message.</description>
        <group>info,one-on-one,</group>
	</rule>
	<rule id="4807" level="0" overwrite="yes">
		<match>djasjljdnvr2123klmckdscds932</match>
		<description>SonicWall debug message.</description>
        <group>info,one-on-one,</group>
	</rule>

<!-- Default Severity base Rules End -->
	
<!-- Custom Severity base Rules start -->
	
	<rule id="102091" level="1" noalert="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^0$</field>
		<description>SonicWall Emergency message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102092" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^1$</field>
		<description>SonicWall Alert message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102093" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^2$</field>
		<description>SonicWall Critical message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102094" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^3$</field>
		<description>SonicWall Error message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102095" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^4$</field>
		<description>SonicWall Warning message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102096" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^5$</field>
		<description>SonicWall Notice message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102097" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^6$</field>
		<description>SonicWall Informational message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<rule id="102098" level="1">
		<if_sid>102090</if_sid>
		<field name="priority_level" type="pcre2">^7$</field>
		<description>SonicWall Debug message.</description>
		<group>info,one-on-one,</group>
	</rule>
	<!-- Custom Severity base Rules end -->
	<!--Updated  Default Rules Start -->
	<rule id="102099" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^236$</field>
        <description>SonicWall: Firewall administrator login.</description>
		<group>low,one-on-one,T1078,defense-evasion,authentication_success,pci_dss_10.2.5,gpg13_3.6,gdpr_IV_32.2,hipaa_164.312.b,nist_800_53_AU.14,nist_800_53_AC.7,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
        <mitre>
			<id>T1078</id>
		</mitre>
        <info type="text">
            Description: 
				This rule logs an administrator login to the firewall. Administrator logins should be closely monitored as they have elevated privileges that can significantly impact firewall configurations and network security. Detecting and auditing these logins ensures accountability and helps prevent unauthorized access or accidental misconfigurations that could compromise the security infrastructure.
        </info>
	</rule>
	<rule id="102100" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^30$|^32$</field>
		<description>SonicWall: Firewall authentication failure.</description>
		<group>medium,one-on-one,s-a,T1110,credential-access,authentication_failed,pci_dss_10.2.4,pci_dss_10.2.5,gpg13_3.6,gdpr_IV_35.7.d,gdpr_IV_32.2,hipaa_164.312.b,nist_800_53_AU.14,nist_800_53_AC.7,tsc_CC6.1,tsc_CC6.8,tsc_CC7.2,tsc_CC7.3,</group>
		<mitre>
			<id>T1110</id>
		</mitre>
        <info type="text">
            Description: 
				This rule logs a failed authentication attempt to the firewall. Repeated authentication failures may indicate unauthorized access attempts, such as brute-force attacks, or misconfigurations. Monitoring these events is essential for ensuring that only authorized users can access firewall settings, helping to prevent potential security breaches and safeguard network infrastructure.
        </info>
	</rule>
	<!--Updated  Default Rules End -->
	<!--Custom Rules Start -->
	<rule id="102101" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^22$</field>
		<description>Sonicwall: Ping of death attack dropped </description>
		<group>medium,one-on-one,s-a,T1498,dos,impact,attack,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
		<info type="text">
            Description: 
				This alert identifies an ICMP "Ping of Death" attack, where an oversized packet is sent in an attempt to crash or exploit a system. The packet was successfully dropped by the security services, preventing potential system disruption or downtime. This detection indicates that your network is actively protected from malicious ICMP traffic
        </info>
	</rule>
	<rule id="102102" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^23$</field>
		<description>Sonicwall: IP spoof attack Dropped </description>
		<group>high,one-on-one,s-a,T1562,T1562.011,spoof,defense-evasion,</group>
		<mitre>
			<id>T1562</id>
			<id>T1562.011</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances where IP spoofing attempts were blocked by security services. IP spoofing involves forging the source IP address in network packets to disguise the attacker's identity. The dropped packet indicates successful prevention of potentially malicious or unauthorized access to the network by blocking spoofed traffic.
        </info>
	</rule>
	<rule id="102103" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^25$</field>
		<description>Sonicwall: Potential SYN Flood attack identified</description>
		<group>high,one-on-one,s-a,T1499,dos,syn,flood,impact,T1499.001,</group>
		<mitre>
			<id>T1499.001</id>
			<id>T1499</id>
		</mitre>
		<info type="text">
            Description: 
				This rule identifies a possible SYN Flood attack, a type of Denial of Service (DoS) attack. It is characterized by a high volume of SYN requests being sent to a server without completing the TCP handshake, potentially overwhelming system resources. This detection signals abnormal traffic patterns that may disrupt normal network services.
        </info>
	</rule>
	<rule id="102104" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^27$</field>
		<description>Sonicwall: LAND Attack Detected</description>
		<group>medium,one-on-one,s-a,impact,T1499,dos,exploit,attack,</group>
		<mitre>
			<id>T1499</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects a Land Attack, a type of Denial of Service (DoS) attack where a malicious packet is sent with the source and destination IP addresses set to the same value. This can cause the target system to enter a loop, leading to resource exhaustion. The detection prevents system disruption by identifying and blocking such malformed packets
        </info>
	</rule>
	<rule id="102105" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^33$</field>
		<description>Sonicwall: User login failed due to invalid credentials</description>
		<group>low,one-on-one,T1078,failure,authentication,credential-access,login,</group>
		<mitre>
			<id>T1078</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances where a user login attempt was denied due to incorrect credentials being provided. This may indicate either a legitimate user mistyping their password or a potential brute force attack. Monitoring such failed login attempts is crucial for identifying unauthorized access attempts and securing user accounts.
        </info>
	</rule>
	<rule id="102106" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^35$</field>
		<description>Sonicwall: Administrator login blocked due to logins being disabled on this interface</description>
		<group>medium,one-on-one,s-a,admin,T1531,deny,impact,block,</group>
		<mitre>
			<id>T1531</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects an attempt to log in as an administrator from a disabled interface %s(version_name). Administrative logins from this interface are blocked for security reasons, and any attempts should be investigated for potential unauthorized access or misconfigurations. Monitoring such events helps prevent improper access to sensitive system functions
        </info>
	</rule>
	<rule id="102107" level="1">
		<if_sid>102098</if_sid>
		<field name="log_id" type="pcre2">^45$</field>
		<description>Sonicwall: ARP Request Timed Out</description>
		<group>low,one-on-one,admin,T1557,credential-access,</group>
		<mitre>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects instances where an ARP (Address Resolution Protocol) request has timed out, indicating that the network was unable to resolve the hardware (MAC) address for the requested IP address. This may suggest network connectivity issues, misconfigurations, or potential malicious activity, such as ARP spoofing or denial-of-service attacks targeting ARP communications.
        </info>
	</rule>
	<rule id="102108" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^65$</field>
		<description>Sonicwall: Invalid IPsec SPI Detected</description>
		<group>medium,one-on-one,T1572,command-and-control,</group>
		<mitre>
			<id>T1572</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects an illegal IPsec SPI (Stateful packet inspection) attempt. The SPI is used to identify IPsec security associations, and an illegal or unknown SPI may indicate a misconfiguration or a potential malicious attempt to bypass secure communication channels. Monitoring these events is essential for maintaining the integrity of IPsec tunnels and preventing unauthorized access
        </info>
	</rule>
	<rule id="102109" level="1">
		<if_sid>102094</if_sid>
		<field name="log_id" type="pcre2">^70$</field>
		<description>Sonicwall: IPsec Packet Detected from an Unauthorized Host</description>
		<group>medium,one-on-one,initial-access,T1190,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects IPsec packets sent from or received by an illegal host. An illegal host is defined as one that is not recognized or authorized within the security policy. This may indicate a potential security breach or misconfiguration, as it could signify unauthorized access attempts or data exfiltration efforts. Continuous monitoring of these packets is vital to safeguarding network integrity.
        </info>
	</rule>
	<rule id="102110" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^81$</field>
		<description>Sonicwall: Smurf Amplification Attack Blocked</description>
		<group>medium,one-on-one,s-a,dos,T1498,impact,attack,block,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances of Smurf Amplification attacks that have been dropped by security mechanisms. A Smurf attack involves sending ICMP requests to a broadcast address, causing multiple devices to respond to a targeted victim, overwhelming their resources. The dropped packets indicate proactive measures taken to prevent network disruption and protect against this type of Denial of Service (DoS) attack.
        </info>
	</rule>
	<rule id="102111" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^82$</field>
		<description>Sonicwall: Potential Port Scanning Activity Detected</description>
		<group>medium,one-on-one,s-a,reconnaissance,T1595,port,</group>
		<mitre>
			<id>T1595</id>
		</mitre>
		<info type="text">
            Description: 
				This rule identifies potential port scanning activity, where an attacker attempts to discover open ports on a target system by sending various connection requests. Port scans are often precursors to unauthorized access attempts, and timely detection is crucial for mitigating potential threats. Monitoring for these activities helps maintain network security and integrity
        </info>
	</rule>
	<rule id="102113" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^165$</field>
		<description>Sonicwall: Forbidden Email Attachment Disabled</description>
		<group>low,one-on-one,s-a,initial-access,T1566,T1566.001,email,</group>
		<mitre>
			<id>T1566.001</id>
			<id>T1566</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances where a forbidden email attachment type has been disabled from being sent or received. Such attachments may pose security risks, including malware delivery or data leakage. Monitoring these events is crucial for maintaining email security policies and protecting the organization from potential threats associated with unsafe file types.
        </info>
	</rule>
	<rule id="102114" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^177$</field>
		<description>Sonicwall: TCP FIN Scanning Activity Detected</description>
		<group>medium,one-on-one,s-a,T1046,discovery,fin,tcp,</group>
		<mitre>
			<id>T1046</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects a probable TCP FIN scan, where an attacker sends TCP FIN packets to various ports on a target system to identify open ports and determine their state. This stealthy scanning technique can bypass certain firewalls and intrusion detection systems. Early detection of such scans is vital for proactive network defense and to thwart potential unauthorized access attempts.
        </info>
	</rule>
	<rule id="102115" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^178$</field>
		<description>Sonicwall: TCP XMAS Scanning Activity Detected</description>
		<group>medium,one-on-one,s-a,T1046,discovery,tcp,</group>
		<mitre>
			<id>T1046</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects a probable TCP XMAS scan, which involves sending TCP packets with the FIN, URG, and PSH flags set to various ports on a target system. This technique aims to identify open ports and gather information about the target's TCP stack behavior. Detection of such scans is crucial for maintaining network security and preventing potential unauthorized access or reconnaissance activities.
        </info>
	</rule>
	<rule id="102116" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^179$</field>
		<description>Sonicwall: TCP NULL Scanning Activity Detected</description>
		<group>medium,one-on-one,s-a,T1046,tcp,discovery,</group>
		<mitre>
			<id>T1046</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects a probable TCP NULL scan, where an attacker sends TCP packets with no flags set to various ports on a target system. This stealthy scanning technique can evade some firewalls and intrusion detection systems by not indicating any legitimate traffic. Early detection is vital for identifying potential reconnaissance activities and securing the network against unauthorized access attempts.
        </info>
	</rule>
	<rule id="102117" level="1">
		<if_sid>102094</if_sid>
		<field name="log_id" type="pcre2">^229$</field>
		<description>Sonicwall: IP Spoofing Detected on Packet to Central Gateway Packet Blocked</description>
		<group>medium,one-on-one,T1016,dhcp,credential-access,block,spoof,</group>
		<mitre>
			<id>T1016</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects an IP spoofing attempt on a packet directed to the Central Gateway, which was subsequently dropped by security mechanisms. IP spoofing involves falsifying the source IP address to disguise the origin of the traffic. The dropped packet indicates effective prevention measures against potential unauthorized access or malicious activity targeting the network.
        </info>
	</rule>
	<rule id="102118" level="1">
		<if_sid>102094</if_sid>
		<field name="log_id" type="pcre2">^248$</field>
		<description>Sonicwall: Retrieving Data due to few moments before attempting to cut or copy again</description>
		<group>medium,one-on-one,collection,T1560,</group>
		<mitre>
			<id>T1560</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs instances where an email attachment retrieval process is underway, prompting the user to wait before attempting to cut or copy the attachment again. This message typically indicates that the system is busy processing the attachment, ensuring that data integrity and access controls are maintained. Monitoring these events helps ensure efficient user experience and system performance.
        </info>
	</rule>
	<rule id="102119" level="1">
		<if_sid>102094</if_sid>
		<field name="log_id" type="pcre2">^446$</field>
		<description>Sonicwall: PASV Response Spoofing Attack dropped.</description>
		<group>medium,one-on-one,s-a,T1071.002,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.002</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances of a PASV response spoof attack against FTP services, which have been dropped by security mechanisms. In this attack, a malicious actor attempts to manipulate the FTP passive mode response to redirect data transfers or gain unauthorized access. The dropped packets indicate effective measures to prevent exploitation of FTP vulnerabilities and protect data integrity..
        </info>
	</rule>
	<rule id="102120" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^527$</field>
		<description>Sonicwall: FTP PORT Bounce Attack dropped</description>
		<group>medium,one-on-one,s-a,T1071,T1071.002,command-and-control,ftp,attack,</group>
		<mitre>
			<id>T1071.002</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances of FTP PORT bounce attacks that have been blocked by security measures. In a bounce attack, an attacker uses the FTP protocol to redirect traffic through the FTP server to another target, potentially bypassing security controls. The blocked attempts indicate proactive measures taken to safeguard the network and prevent unauthorized access or data exfiltration
        </info>
	</rule>
	<rule id="102121" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^528$</field>
		<description>Sonicwall: FTP PASV Response Bounce Attack Blocked</description>
		<group>medium,one-on-one,s-a,T1071,T1071.002,command-and-control,block,attack,ftp,</group>
		<mitre>
			<id>T1071</id>
			<id>T1071.002</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances of FTP PASV response bounce attacks that have been dropped by security measures. In this type of attack, a malicious actor exploits the FTP passive mode to redirect traffic to unintended destinations, potentially compromising security. The dropped packets indicate effective prevention of such attacks, helping to maintain the integrity and security of the network.
        </info>
	</rule>
	<rule id="102122" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^538$</field>
		<description>Sonicwall: FTP Data Connection from Non-Default Port dropped</description>
		<group>low,one-on-one,s-a,T1571,command-and-control,port,</group>
		<mitre>
			<id>T1571</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs instances where an FTP data connection attempt from a non-default port has been dropped. FTP typically operates on well-known ports (21 for commands and 20 for data), and connections from non-standard ports may indicate unauthorized access attempts or misconfigurations. The dropped connections help maintain security by preventing potential exploitation of the FTP service.
        </info>
	</rule>
	<rule id="102123" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^860$</field>
		<description>Sonicwall: SYN Flood Attack Detected.</description>
		<group>medium,one-on-one,s-a,impact,T1499,T1499.001,syn,flood,attack,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects instances of SYN flood attacks, a type of Denial of Service (DoS) attack characterized by a high volume of SYN packets sent to a target system to overwhelm its resources. This detection signals abnormal traffic patterns that may disrupt normal network services. Prompt identification is crucial for implementing mitigation strategies and ensuring the availability of network resources.
        </info>
	</rule>
	<rule id="102124" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^904$</field>
		<description>Sonicwall: Potential RST Flood Attack Detected</description>
		<group>medium,one-on-one,s-a,T1499.001,T1499,impact,dos,flood,attack,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects possible RST flood attacks, characterized by an excessive number of TCP RST (Reset) packets sent to a target system. Such attacks aim to disrupt legitimate TCP connections by forcing them to reset, potentially causing service interruptions. Early detection is essential for identifying abnormal traffic patterns and implementing effective countermeasures to maintain network stability.
        </info>
	</rule>
	<rule id="102125" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^546$</field>
		<description>Sonicwall: Rogue or Man-in-the-Middle Access Point Detected.</description>
		<group>medium,one-on-one,s-a,T1638,collection,mitm,</group>
		<mitre>
			<id>T1638</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects the presence of a rogue or Man-in-the-Middle (MitM) access point within the network. Such access points can pose significant security risks by intercepting or altering communications between users and legitimate networks. Identifying these threats promptly is crucial for safeguarding sensitive data and maintaining network integrity. Immediate action is recommended to mitigate potential risks associated with unauthorized access points.
        </info>
	</rule>
	<rule id="102126" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^815$</field>
		<description>Sonicwall: Excessive Gratuitous ARPs Detected</description>
		<group>medium,one-on-one,T1071,credential-access,arp,T1071.004,</group>
		<mitre>
			<id>T1071.004</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects instances of excessive gratuitous ARP (Address Resolution Protocol) messages on the network. Gratuitous ARPs are typically used to announce or update the IP-to-MAC address mapping, but an unusually high number can indicate potential network issues or malicious activity, such as ARP spoofing attacks. Timely detection is essential for maintaining network health and preventing potential security breaches.
        </info>
	</rule>
	<rule id="102127" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^879$</field>
		<description>Sonicwall: WLAN Radio Frequency Threat Detected</description>
		<group>medium,one-on-one,T1011,exfiltration,wlan,</group>
		<mitre>
			<id>T1011</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects threats related to WLAN (Wireless Local Area Network) radio frequencies, indicating potential interference or unauthorized access attempts. Such threats may include rogue access points, jamming, or other malicious activities targeting wireless communication. Prompt detection is vital for securing wireless networks and protecting sensitive data from unauthorized access or disruption.
        </info>
	</rule>
	<rule id="102128" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^581$</field>
		<description>Sonicwall: Spill-Over Initiated Due to Exceeded Configured Threshold.</description>
		<group>medium,one-on-one,T1030,exfiltration,</group>
		<mitre>
			<id>T1030</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects when WLB spill-over has been initiated due to exceeding the configured threshold. This situation typically arises when the network's load balancing system identifies that the current access points are overloaded and begins directing traffic to alternate access points. Monitoring this event is crucial for maintaining optimal network performance and ensuring balanced resource allocation across the wireless infrastructure
        </info>
	</rule>
	<rule id="102129" level="1">
		<if_sid>102096</if_sid>
		<field name="log_id" type="pcre2">^760$</field>
		<description>Sonicwall: TCP Connection Handshake Violation Detected.</description>
		<group>medium,one-on-one,T1078,violation,defense-evasion,tcp,</group>
		<mitre>
			<id>T1078</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects violations in the TCP handshake process, indicating potential issues in establishing legitimate connections. A TCP handshake violation may occur due to unexpected packets, such as SYN packets received without a corresponding ACK or FIN, potentially signaling malicious activity or misconfiguration. The dropped connection reflects proactive measures taken to maintain network integrity and security.
        </info>
	</rule>
	<rule id="102130" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^606$</field>
		<description>Sonicwall: Spank Attack for Multicast Packet dropped.</description>
		<group>high,one-on-one,s-a,impact,T1498,multicast,attack,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects and logs the dropping of multicast packets associated with a Spank attack. Spank attacks exploit multicast packets to overwhelm network resources, potentially leading to Denial of Service (DoS) conditions. The dropped packets indicate effective security measures in place to mitigate such attacks and protect the network from unauthorized traffic and disruptions.
        </info>
	</rule>
	<rule id="102131" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^752$</field>
		<description>Sonicwall: LDAP Server Certificate with Invalid Hostname.</description>
		<group>medium,one-on-one,T1047,execution,</group>
		<mitre>
			<id>T1047</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects instances where an LDAP (Lightweight Directory Access Protocol) server certificate has been accepted despite having an incorrect host name. This situation can pose security risks, as it may indicate a misconfiguration or a potential Man-in-the-Middle (MitM) attack. Monitoring these events is essential for ensuring proper certificate validation and maintaining the integrity of LDAP communications.
        </info>
	</rule>
	<rule id="102132" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1213$</field>
		<description>Sonicwall: UDP Flood Attack Detected by Firewall Configuration.</description>
		<group>medium,one-on-one,s-a,T1562,T1562.004,udp,defense-evasion,attack,flood,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects UDP flood attacks identified by firewall settings. A UDP flood attack is a type of Denial of Service (DoS) attack that overwhelms a target system with a high volume of UDP packets, potentially disrupting normal operations. Timely detection is crucial for initiating mitigation strategies and ensuring the availability and performance of network services
        </info>
	</rule>
	<rule id="102133" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1214$</field>
		<description>Sonicwall: ICMP Flood Attack detected by firewall Configuration.</description>
		<group>high,one-on-one,s-a,T1562,T1562.004,defense-evasion,flood,attack,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects an ICMP flood attack as identified by firewall configuration. An ICMP flood attack involves sending a high volume of ICMP (ping) packets to a target, overwhelming its ability to respond, potentially leading to a Denial of Service (DoS) condition. Early detection helps in mitigating the attack and preserving network performance and availability
        </info>
	</rule>
	<rule id="102134" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1366$</field>
		<description>Sonicwall: TCP Flooding Detected due to Machine Blacklisted.</description>
		<group>medium,one-on-one,s-a,T1499,T1499.001,dos,impact,flood,tcp,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects instances where a machine (%s: Dynamic version_name) has been blacklisted due to TCP flooding activity. TCP flooding involves overwhelming a target system with numerous TCP connection attempts, leading to potential service disruption or Denial of Service (DoS) conditions. The blacklisting of the offending machine helps prevent further malicious activity and protects the network from potential harm.
        </info>
	</rule>
	<rule id="102135" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^1367$</field>
		<description>Sonicwall: TCP Flood Blacklist due to Ongoing Activity Detected</description>
		<group>medium,one-on-one,T1499,T1499.001,dos,tcp,impact,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects ongoing TCP flood activity that has resulted in a machine being blacklisted. TCP flooding involves excessive connection requests aimed at overwhelming the target system's resources, leading to potential service disruptions. Immediate action is crucial to mitigate the attack and protect the network's integrity by preventing further malicious traffic from the offending source
        </info>
	</rule>
	<rule id="102136" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1378$</field>
		<description>Sonicwall: Machine Removed from TCP Flood Blacklist.</description>
		<group>medium,one-on-one,s-a,T1499,T1499.001,dos,tcp,impact,flood,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs instances where a machine (%s) has been removed from the TCP flood blacklist. The removal indicates that the previously blacklisted machine, identified for participating in a TCP flood attack, is now cleared. Monitoring such events ensures that blacklisting actions are accurately tracked, and the network remains protected from potential threats
        </info>
	</rule>
	<rule id="102137" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1369$</field>
		<description>Sonicwall: Potential TCP Flood Detected on Interface</description>
		<group>high,one-on-one,s-a,T1499,T1499.001,tcp,flood,impact,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects potential TCP flood activity on interface %s. A TCP flood attack involves sending a large number of TCP connection requests in an attempt to overwhelm the target system�s network interface, potentially causing service disruption or Denial of Service (DoS). Prompt detection helps in taking necessary action to prevent further network degradation and mitigate the threat
        </info>
	</rule>
	<rule id="102138" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1370$</field>
		<description>Sonicwall: Potential TCP Flood on Interface Has Stopped.</description>
		<group>medium,one-on-one,s-a,T1499,T1499.001,tcp,flood,impact,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs when possible TCP flood activity on interface %s has ceased. The cessation indicates that the high volume of TCP connection requests has returned to normal levels, potentially signifying the end of an attack or abnormal network behavior. Monitoring this event helps confirm that the network has stabilized after the suspected flood activity
        </info>
	</rule>
	<rule id="102139" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^1371$</field>
		<description>Sonicwall: Potential TCP Flood on Interface is Ongoing.</description>
		<group>medium,one-on-one,T1499,T1499.001,tcp,flood,impact,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects ongoing TCP flood activity on interface %s, indicating that the high volume of TCP connection requests has not subsided. This continued activity may signify a prolonged attack or persistent network disruption, requiring immediate attention to mitigate the threat and prevent potential service degradation or Denial of Service (DoS)
        </info>
	</rule>
	<rule id="102140" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1450$</field>
		<description>Sonicwall: Potential UDPv6 Flood Attack Detected</description>
		<group>medium,one-on-one,s-a,T1557,T1557.003,udp,flood,credential-access,attack,</group>
		<mitre>
			<id>T1557.003</id>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects potential UDPv6 flood attacks, characterized by an overwhelming number of IPv6-based UDP packets targeting a system. Such attacks can disrupt normal network operations and lead to Denial of Service (DoS) conditions. Early detection helps in mitigating the attack and ensuring the continued availability and performance of network resources.
	</info>
	</rule>
	<rule id="102141" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1451$</field>
		<description>Sonicwall: Potential ICMPv6 Flood Attack Detected</description>
		<group>medium,one-on-one,s-a,T1498,flood,impact,icmp,attack,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects potential ICMPv6 flood attacks, characterized by an excessive volume of ICMPv6 packets targeting a system. Such attacks can overwhelm the network resources, leading to performance degradation or Denial of Service (DoS) conditions. Timely detection is crucial for implementing appropriate countermeasures to safeguard network availability and stability.
        </info>
	</rule>
	<rule id="102142" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1507$</field>
		<description>Sonicwall: IPv6 MAC-IP Anti-Spoofing Check Enforced for Hosts</description>
		<group>medium,one-on-one,s-a,credential-access,T1557,Spoofing,</group>
		<mitre>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule indicates that an IPv6 MAC-IP anti-spoof check has been enforced for hosts on the network. This security measure aims to prevent IP spoofing by ensuring that the MAC address corresponds to the correct IP address, thereby protecting against unauthorized access and enhancing network integrity. Monitoring this event is essential for maintaining a secure network environment.
        </info>
	</rule>
	<rule id="102143" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1508$</field>
		<description>Sonicwall: IPv6 MAC-IP Anti-Spoofing Cache Not Found for This Route</description>
		<group>medium,one-on-one,s-a,credential-access,T1557,spoofing,</group>
		<mitre>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule indicates that the IPv6 MAC-IP anti-spoof cache could not be found for the specified router. This absence may hinder the router's ability to verify the association between MAC addresses and their corresponding IP addresses, potentially exposing the network to spoofing attacks. Monitoring this event is critical for ensuring robust network security and addressing potential vulnerabilities
        </info>
	</rule>
	<rule id="102144" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1509$</field>
		<description>Sonicwall:IPv6 MAC-IP Anti-spoof cache found, but it is not a router</description>
		<group>medium,one-on-one,s-a,credential-access,T1557,mac,spoof,</group>
		<mitre>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule indicates that an IPv6 MAC-IP anti-spoof cache entry has been found, but the identified entry is not associated with a router. This situation may suggest a misconfiguration or an unexpected device on the network, which could pose security risks by allowing unauthorized access or spoofing. Monitoring this event is vital for maintaining network integrity and addressing potential vulnerabilities
        </info>
	</rule>
	<rule id="102145" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1316$</field>
		<description>Sonicwall: Possible ARP attack from MAC address</description>
		<group>medium,one-on-one,s-a,credential-access,T1557,T1557.002,arp,attack,mac,</group>
		<mitre>
			<id>T1557.002</id>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects possible ARP (Address Resolution Protocol) attacks originating from a specified MAC address. ARP attacks can involve spoofing or flooding techniques that disrupt normal network operations, potentially allowing unauthorized access or man-in-the-middle (MitM) attacks. Timely detection is crucial for initiating countermeasures to protect the integrity and security of the network.
        </info>
	</rule>
	<rule id="102146" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1376$</field>
		<description>Sonicwall: Nestea/Teardrop Attack dropped</description>
		<group>medium,one-on-one,s-a,T1557,credential-access,attack,</group>
		<mitre>
			<id>T1557</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the dropping of Nestea/Teardrop attack packets. These attacks exploit vulnerabilities in the TCP/IP stack by sending malformed packets that can cause system crashes or instability. The dropped packets indicate effective security measures in place to prevent potential damage and maintain the integrity of the network and its resources.
        </info>
	</rule>
	<rule id="102147" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1387$</field>
		<description>Sonicwall: TCP Null Flag Packet dropped</description>
		<group>medium,one-on-one,T1205,defense-evasion,tcp,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the dropping of TCP packets with null flags. A TCP null scan is a technique used by attackers to probe open ports on a target system without setting any flags, which may indicate an attempt to map the target's network or exploit vulnerabilities. Dropping these packets demonstrates effective security measures to prevent reconnaissance activities and maintain network security
        </info>
	</rule>
	<rule id="102148" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1471$</field>
		<description>Sonicwall: External Intrusion Detection System (IDS)</description>
		<group>medium,one-on-one,s-a,persistence,T1133,ids,</group>
		<mitre>
			<id>T1133</id>
		</mitre>
		<info type="text">
            Description: 
				This rule pertains to the detection and monitoring of external Intrusion Detection Systems (IDS). External IDS are deployed outside the internal network perimeter to identify and respond to potential threats and attacks from external sources. This monitoring is crucial for maintaining situational awareness and enhancing the overall security posture by detecting malicious activities before they reach critical internal systems.
        </info>
	</rule>
	<rule id="102149" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1476$</field>
		<description>Sonicwall: Suspected Botnet Initiator Blocked Source Identified from Custom List</description>
		<group>medium,one-on-one,s-a,resource-development,T1584.005,T1584,block,</group>
		<mitre>
			<id>T1584</id>
			<id>T1584.005</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the blocking of a suspected botnet initiator identified as %s. The detection originates from a custom list of known malicious sources. Botnet initiators attempt to infect or control systems to join a network of compromised machines used for attacks, spam, or data theft. Blocking these sources helps prevent botnet activity and protects network integrity.
        </info>
	</rule>
	<rule id="102150" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1477$</field>
		<description>Sonicwall: Suspected Botnet Responder Blocked Source Identified from Custom List</description>
		<group>medium,one-on-one,s-a,resource-development,T1584.005,T1584,block,botnet,</group>
		<mitre>
			<id>T1584</id>
			<id>T1584.005</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the blocking of a suspected botnet responder identified as %s, detected from a custom list of malicious sources. A botnet responder is a compromised system that participates in communication with a botnet command-and-control server, facilitating malicious activities such as DDoS attacks, data exfiltration, or spamming. Blocking these entities helps prevent further malicious activity and enhances network security.
        </info>
	</rule>
	<rule id="102151" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1518$</field>
		<description>Sonicwall: Suspected Botnet Initiator Blocked Source Identified from Dynamic List</description>
		<group>medium,one-on-one,s-a,resource-development,T1584.005,T1584,block,botnet,</group>
		<mitre>
			<id>T1584</id>
			<id>T1584.005</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the blocking of a suspected botnet initiator identified as %s, sourced from a dynamic list. Botnet initiators attempt to compromise systems and recruit them into a botnet, which can be used for large-scale attacks, spam distribution, or data breaches. Blocking this initiator ensures protection against botnet formation and helps maintain network integrity.
        </info>
	</rule>
	<rule id="102152" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1519$</field>
		<description>Sonicwall: Suspected Botnet Responder Blocked Source Identified from Dynamic List</description>
		<group>medium,one-on-one,s-a,resource-development,T1584.005,T1584,block,botnet,</group>
		<mitre>
			<id>T1584</id>
			<id>T1584.005</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the blocking of a suspected botnet responder identified as %s, detected from a dynamic list. A botnet responder participates in communication with a botnet's command-and-control infrastructure, assisting in malicious operations such as DDoS attacks or data theft. Blocking these responders helps to disrupt botnet activity and safeguards network security.
        </info>
	</rule>
	<rule id="102153" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^548$</field>
		<description>Sonicwall: Association Flood Detected from WLAN Station</description>
		<group>medium,one-on-one,s-a,T1498,impact,dos,wlan,flood,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects an association flood attack originating from a WLAN station. Association flooding occurs when an attacker sends a large number of association requests to a wireless access point, potentially leading to network congestion or denial of service (DoS). Monitoring and blocking such activity is essential to ensure the availability and stability of wireless network services
        </info>
	</rule>
	<!-- New UseCase -->
	<rule id="102154" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^441$</field>
		<description>Sonicwall: Firewall Access Rule Alert Accessed or Modified</description>
		<group>low,one-on-one,T1562.001,T1562,defense-evasion,rule,</group>
		<mitre>
			<id>T1562</id>
			<id>T1562.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the accessing or modification of firewall access rules. Such changes can indicate potential unauthorized attempts to alter security settings, which could lead to vulnerabilities in the network defense. Monitoring these activities is crucial for ensuring the integrity of firewall configurations and maintaining a robust security posture against external threats
        </info>
	</rule>
	<rule id="102155" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^795$</field>
		<description>Sonicwall: Anti-Spyware Detection Alert Detected</description>
		<group>medium,one-on-one,s-a,T1204.002,T1204,spyware,execution,</group>
		<mitre>
			<id>T1204</id>
			<id>T1204.002</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the detection of an anti-spyware alert, indicating the presence of potentially malicious spyware on the system. Spyware can compromise user privacy, steal sensitive information, and lead to unauthorized access. Prompt response to this alert is essential to mitigate risks and protect the integrity of the affected systems and network.
        </info>
	</rule>
	<rule id="102156" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^608$</field>
		<description>Sonicwall: IPS Attack Alert Detected</description>
		<group>medium,one-on-one,execution,T1203,ips,attack,ips,</group>
		<mitre>
			<id>T1203</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the detection of an Intrusion Prevention System (IPS) attack alert, indicating a potential security breach or malicious activity targeting the network. The IPS analyzes traffic patterns and detects attacks in real-time, enabling immediate countermeasures to prevent damage or unauthorized access. Timely response to this alert is crucial for safeguarding network resources and maintaining security.
        </info>
	</rule>
	<rule id="102157" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^277$</field>
		<description>Sonicwall: VPN PKI User Activity Alert for Invalid CRL Format Detected</description>
		<group>medium,one-on-one,s-a,vpn,T1133,persistence,</group>
		<mitre>
			<id>T1133</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs a VPN PKI user activity alert indicating that a bad Certificate Revocation List (CRL) format has been detected. A malformed CRL can prevent proper verification of certificate validity, potentially allowing unauthorized access to the VPN. Prompt attention to this alert is essential to ensure secure connections and protect the integrity of the VPN infrastructure.
        </info>
	</rule>
	<rule id="102158" level="1">
		<if_sid>102094</if_sid>
		<field name="log_id" type="pcre2">^662$</field>
		<description>Sonicwall: Non SonicPoint Traffic Drop</description>
		<group>medium,one-on-one,s-a,T0860,initial-access,</group>
		<mitre>
			<id>T0860</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the dropping of traffic that does not originate from or is not destined to SonicPoint devices. Such drops may indicate potential misconfigurations or unauthorized attempts to communicate with the network. Monitoring this traffic is essential to maintain network integrity and ensure that only legitimate devices interact with the system
        </info>
	</rule>
	<rule id="102159" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^905$</field>
		<description>Sonicwall: Firewall FIN Flood Attack Detected</description>
		<group>medium,one-on-one,s-a,T1498,impact,flood,fin,attack,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the detection of a possible FIN flood attack by the firewall. A FIN flood attack involves sending numerous TCP packets with the FIN flag set, which can overwhelm the target system and lead to resource exhaustion or denial of service. Timely detection and response are critical to prevent service disruption and maintain network availability.
        </info>
	</rule>
	<rule id="102160" level="1">
		<if_sid>102092</if_sid>
		<field name="log_id" type="pcre2">^1098$</field>
		<description>Sonicwall: Potential DNS Rebind Threat Identified</description>
		<group>medium,one-on-one,s-a,command-and-control,dns,T1568,dns,</group>
		<mitre>
			<id>T1568</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the detection of a possible DNS rebind attack. A DNS rebind attack manipulates DNS responses to bypass the same-origin policy, allowing attackers to hijack connections between the target�s browser and internal networks. Such attacks can lead to unauthorized access to internal systems. Immediate investigation is crucial to mitigate this threat and protect network security.
        </info>
	</rule>
	<rule id="102161" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^902$</field>
		<description>Sonicwall: Ongoing FIN Flood Blacklist detected</description>
		<group>medium,one-on-one,s-a,impact,T1499,T1499.001,fin,flood,</group>
		<mitre>
			<id>T1499.001</id>
            <id>T1499</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs instances where a continued FIN flood attack has resulted in a source being added to the blacklist. A FIN flood attack sends numerous TCP packets with the FIN flag set, which can overwhelm network resources. Blacklisting the source helps prevent further malicious activity and protects the integrity and availability of network services.
        </info>
	</rule>
	<rule id="102162" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^899$</field>
		<description>Sonicwall: Ongoing RST Flood Blacklist detected</description>
		<group>medium,one-on-one,s-a,impact,T1499,T1499.001,flood,</group>
		<mitre>
			<id>T1499.001</id>
            <id>T1499</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs instances where a continued RST flood attack has resulted in a source being added to the blacklist. An RST flood attack sends numerous TCP packets with the RST flag set, which can disrupt legitimate traffic and overwhelm network resources. Blacklisting the source is a proactive measure to prevent further malicious activity and ensure network stability and availability.
        </info>
	</rule>
	<rule id="102163" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^862$</field>
		<description>Sonicwall: SYN Flood Blacklist Activated detect</description>
		<group>medium,one-on-one,impact,T1499,T1499.001,syn,flood,</group>
		<mitre>
			<id>T1499.001</id>
            <id>T1499</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the enabling of the SYN flood blacklist, a proactive measure taken to mitigate the impact of SYN flood attacks. By adding identified malicious sources to the blacklist, the system can prevent excessive SYN packets from overwhelming network resources, thus enhancing network stability and safeguarding services against denial of service (DoS) attacks.
        </info>
	</rule>
	<rule id="102164" level="1">
		<if_sid>102095</if_sid>
		<field name="log_id" type="pcre2">^857$</field>
		<description>Sonicwall: User Changed SYN Flood Mode to Watch and Proxy WAN Connections</description>
		<group>medium,one-on-one,impact,T1499,wan,T1499.001,flood,proxy,wan,</group>
		<mitre>
			<id>T1499</id>
			<id>T1499.001</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs a change in the SYN flood protection mode initiated by a user, setting it to 'Watch and Proxy WAN Connections When Under Attack.' This mode enhances network security by monitoring SYN packets and applying proxy techniques to mitigate potential SYN flood attacks. Such adjustments are vital for maintaining service availability and ensuring the resilience of the network against denial of service (DoS) threats.
        </info>
	</rule>
	<rule id="102167" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^1337$</field>
		<description>Sonicwall: Administrators Changed User Password</description>
		<group>low,one-on-one,persistence,T1098,authentication,admin,</group>
		<mitre>
			<id>T1098</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the event of administrators changing a user's password. Such changes are a normal part of user account management but can also indicate potential security incidents if not properly authorized. Monitoring these events is essential to ensure accountability and to detect unauthorized attempts to alter user credentials, thus maintaining the integrity of user access controls.	
        </info>
	</rule>
	<rule id="102175" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^1338$</field>
		<description>Sonicwall: User Password Changed</description>
		<group>low,one-on-one,persistence,T1098,authentication,</group>
		<mitre>
			<id>T1098</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the event of a user changing their password. While password changes are a routine aspect of account management, they can also indicate unauthorized access attempts if done without the user's knowledge. Monitoring these changes is essential for maintaining security, ensuring user accountability, and detecting any suspicious activity that could compromise user credentials.
        </info>
	</rule>
	<rule id="102176" level="1">
		<if_sid>102097</if_sid>
		<field name="log_id" type="pcre2">^1339$</field>
		<description>Sonicwall: Password Rule Changed</description>
		<group>low,one-on-one,persistence,T1098,authentication,</group>
		<mitre>
			<id>T1098</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs the event of a change in the password policy or rules. Modifying password rules can impact security posture by altering requirements such as length, complexity, and expiration. It is important to monitor such changes to ensure they align with organizational security standards and to detect any potentially malicious attempts to weaken security measures..
        </info>
	</rule>

	<rule id="102177" level="1">
    <if_sid>102097</if_sid>
    <field name="log_id" type="pcre2">^31$</field>
    <description>Sonicwall: User Login Authentication from Internal Zone</description>
    <group>low,one-on-one,defense-evasion,T1078,allow,T1078.002,</group>
    <mitre>
        <id>T1078</id>
        <id>T1078.002</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects successful user authentication events from internal network zones in Sonicwall firewalls. Monitoring internal login activities is essential for identifying potential unauthorized access using valid credentials, insider threats, or compromised accounts. Regular monitoring helps ensure authentication attempts align with normal business patterns and security policies.
    </info>
</rule>
<rule id="102178" level="1">
    <if_sid>102097</if_sid>
    <field name="log_id" type="pcre2">^1008$</field>
    <description>Sonicwall: SSO User Session Termination Detected</description>
    <group>low,one-on-one,impact,T1531,logout,</group>
    <mitre>
        <id>T1531</id>
    </mitre>
    <info type="text">
        Description: 
            This rule monitors user logout events detected by Single Sign-On (SSO) in Sonicwall systems. While logouts are normal activities, monitoring these events is crucial for maintaining session security and detecting potential account-based attacks. Unusual logout patterns or mass logouts could indicate account tampering, session hijacking attempts, or deliberate account lockouts that might be part of a broader attack strategy.
    </info>
</rule>
<rule id="102179" level="1">
    <if_sid>102092</if_sid>
    <field name="log_id" type="pcre2">^1179$</field>
    <description>Sonicwall: High Volume of Pending SSO Connection Requests Detected</description>
    <group>medium,one-on-one,s-a,credential-access,T1621,</group>
    <mitre>
        <id>T1621</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects when a user has accumulated an unusually high number of pending SSO connection requests in Sonicwall systems. This behavior could indicate potential network scanning activity, resource exhaustion attempts, or denial of service attacks. High volumes of pending connections may suggest automated tools attempting to overwhelm authentication services or reconnaissance activities to map network resources and user accounts.
    </info>
</rule>
<rule id="102180" level="1">
    <if_sid>102097</if_sid>
    <field name="log_id" type="pcre2">^442$</field>
    <description>Sonicwall: Firewall Access Rule Deletion Detected</description>
    <group>medium,one-on-one,defense-evasion,T1562.004,</group>
    <mitre>
        <id>T1562.004</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects the deletion of access rules in Sonicwall firewall configurations. Access rule deletions can indicate attempts to modify security policies and potentially create security gaps. Such changes could be part of an attacker's attempt to bypass security controls, create unauthorized access paths, or disable security functions. All access rule deletions should be verified against approved change management processes to ensure they are authorized modifications.
    </info>
</rule>
<rule id="102181" level="1">
    <if_sid>102092</if_sid>
    <field name="log_id" type="pcre2">^793$</field>
    <description>Sonicwall: Application Firewall Security Alert Triggered</description>
    <group>medium,one-on-one,s-a,initial-access,T1190,</group>
    <mitre>
        <id>T1190</id>
    </mitre>
    <info type="text">
        Description: 
            This rule monitors application-level firewall alerts from Sonicwall security systems. These alerts indicate potential malicious activities targeting applications, such as exploitation attempts, unauthorized access, or application-layer attacks. Application firewall alerts may signal attempts to exploit vulnerabilities, perform injection attacks, or bypass application security controls. Each alert should be investigated to determine the nature and impact of the potential security threat.
    </info>
</rule>
<rule id="102182" level="1">
    <if_sid>102098</if_sid>
    <field name="log_id" type="pcre2">^1654$</field>
    <description>Sonicwall: Custom Pattern Match Rule Triggered</description>
    <group>medium,one-on-one,defense-evasion,T1562.001,</group>
    <mitre>
        <id>T1562.001</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects when a custom pattern matching rule is triggered in Sonicwall security systems. Custom match rules are specialized filters that can identify specific traffic patterns or behaviors. While these rules are legitimate security controls, their modification or unexpected triggers could indicate attempts to bypass security policies, create backdoors, or modify existing security controls. Monitor these events to ensure they align with authorized security policies and change management procedures.
    </info>
</rule>
<rule id="102183" level="1">
    <if_sid>102095</if_sid>
    <field name="log_id" type="pcre2">^856$</field>
    <description>Sonicwall: SYN Flood Protection Mode Modified to Monitoring State</description>
    <group>medium,one-on-one,impact,T1499.001,syn,flood,</group>
    <mitre>
        <id>T1499.001</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects modifications to SYN Flood protection settings in Sonicwall firewalls, specifically when changed to monitoring mode. Such changes to DDoS protection mechanisms could indicate attempts to weaken security controls or prepare for potential denial of service attacks. While monitoring mode is legitimate for troubleshooting, unauthorized changes to these settings could expose the network to SYN flood attacks. All modifications should be verified against approved change management processes.
    </info>
</rule>
<rule id="102184" level="1">
    <if_sid>102097</if_sid>
    <field name="log_id" type="pcre2">^897$</field>
    <description>Sonicwall: SYN Flood Protection Mode Changed to Active Mitigation</description>
    <group>medium,one-on-one,impact,T1499.001,</group>
    <mitre>
        <id>T1499.001</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects when SYN Flood protection settings in Sonicwall are modified to enable active proxy protection for WAN connections during attacks. While this change enhances protection against SYN flood attacks, unauthorized modifications to these security controls should be monitored. Verify that such changes align with security policies and are performed by authorized personnel, as improper configurations could impact network performance or security posture.
    </info>
</rule>
<rule id="102185" level="1">
    <if_sid>102092</if_sid>
    <field name="log_id" type="pcre2">^1452$</field>
    <description>Sonicwall: TCP SYN Flood Attack Detected Excessive Half-Open Connections</description>
    <group>medium,one-on-one,s-a,impact,T1499.001,</group>
    <mitre>
        <id>T1499.001</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects potential SYN flood attacks by monitoring excessive half-open TCP connections in Sonicwall systems. A high number of half-open connections typically indicates an ongoing TCP SYN flood attack, which aims to exhaust system resources and deny service to legitimate users. This is a critical security event that requires immediate investigation as it could lead to service disruption and system unavailability. The high severity level (10) reflects the potential impact of this attack vector.
    </info>
</rule>
<rule id="102186" level="1">
    <if_sid>102095</if_sid>
    <field name="log_id" type="pcre2">^1195$</field>
    <description>Sonicwall: Botnet Protection Service Subscription Expired</description>
    <group>low,one-on-one,resource-development,T1584.005,</group>
    <mitre>
        <id>T1584.005</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects when the Sonicwall firewall's Botnet Filter subscription has expired. An expired botnet protection service reduces the system's ability to detect and block malicious botnet communications and command-and-control traffic. This security control degradation could leave the network more vulnerable to botnet infections, malware communications, and other malicious activities. Immediate renewal of the subscription is recommended to maintain optimal security posture.
    </info>
</rule>
<rule id="102187" level="1">
    <if_sid>102097</if_sid>
    <field name="log_id" type="pcre2">^243$</field>
    <description>Sonicwall: RADIUS Authentication Failure - User Login Denied</description>
    <group>medium,one-on-one,credential-access,T1556,authentication,Failure,</group>
    <mitre>
        <id>T1556</id>
    </mitre>
    <info type="text">
        Description: 
            This rule detects failed RADIUS authentication attempts in Sonicwall systems. Authentication failures could indicate potential brute force attacks, credential stuffing attempts, or misconfigured user credentials. Multiple RADIUS authentication failures might suggest systematic attempts to gain unauthorized access to network resources. Each failure should be investigated, especially when occurring in patterns or from unexpected sources, to identify potential security threats.
    </info>
</rule>

	<!-- Aggregation -->
	<rule id="102112" level="2" timeframe="120" frequency="5">
		<if_matched_sid>102111</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Sonicwall: Multiple Port Scanning Activity Detected</description>
		<group>high,aggregation,s-a,T1595,reconnaissance,port,</group>
		<mitre>
			<id>T1595</id>
		</mitre>
		<info type="text">
            Description: 
				This rule detects multiple instances of port scanning activity, indicating a concerted effort to identify open ports across a target system or network. Such behavior may suggest an attacker is probing for vulnerabilities to exploit. Early detection of multiple port scans is essential for implementing countermeasures and safeguarding network resources from potential breaches.
        </info>
	</rule>

		<!-- Aggregation -->
	<rule id="102165" level="2" timeframe="120" frequency="5">
		<if_matched_sid>102100</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>SonicWall: Multiple time Firewall authentication failure</description>
		<group>high,aggregation,s-a,execution,T1204.002,T1204,authentication,failed,</group>
		<mitre>
			<id>T1204</id>
			<id>T1204.002</id>
		</mitre>
		<info type="text">
            Description: 
				This rule logs multiple authentication failures to the firewall, indicating repeated unsuccessful attempts to gain access. Such activity may suggest potential brute-force attacks or unauthorized access attempts, warranting immediate investigation. Monitoring these events is essential for maintaining security, ensuring proper access controls, and preventing unauthorized access to critical network resources.
        </info>
	</rule>
</group> 