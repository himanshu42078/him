<!--

{"action":"%s{action}","appclass":"%s{appclass}","appname":"%s{appname}","bwclassname":"%s{bwclassname}","bwrulename":"%s{bwrulename}","bwthrottle":"%s{bwthrottle}","ClientIP":"%s{cip}","clientpublicIP":"%s{cintip}","clientsslcipher":"%s{clientsslcipher}","clientsslsessreuse":"%s{clientsslsessreuse}","clienttlsversion":"%s{clienttlsversion}","clienttranstime":"%d{ctime}","contenttype":"%s{contenttype}","contenttype__1":"%s{contenttype}","department":"%s{dept}","dept":"%s{dept}","deviceappversion":"%s{deviceappversion}","devicemodel":"%s{devicemodel}","devicename":"%s{devicename}","devicename__1":"%s{devicename}","deviceostype":"%s{deviceostype}","deviceostype__1":"%s{deviceostype}","deviceosversion":"%s{deviceosversion}","deviceplatform":"%s{deviceplatform}","dlpdicthitcount":"%s{dlpdicthitcount}","dlpdictionaries":"%s{dlpdict}","dlpengine":"%s{dlpeng}","dlpidentifier":"%d{dlpidentifier}","dlpmd5":"%s{dlpmd5}","ehost":"%s{ehost}","epochtime":"%d{epochtime}","ereferer":"%s{ereferer}","event_id":"%d{recordid}","fileclass":"%s{fileclass}","filename":"%s{filename}","filesubtype":"%s{filesubtype}","filetype":"%s{filetype}","hostname":"%s{ehost}","location":"%s{location}","md5":"%s{bamd5}","mobappcat":"%s{mobappcat}","mobappname":"%s{mobappname}","mobdevtype":"%s{mobdevtype}","module":"%s{module}","login":"%s{login}","pagerisk":"%d{riskscore}","product":"NSS","productversion":"%s{productversion}","protocol":"%s{proto}","reason":"%s{reason}","refererURL":"%s{ereferer}","reqdatasize":"%d{reqdatasize}","reqhdrsize":"%d{reqhdrsize}","requestmethod":"%s{reqmethod}","requestsize":"%d{reqsize}","respdatasize":"%d{respdatasize}","resphdrsize":"%d{resphdrsize}","responsesize":"%d{respsize}","respsize":"%d{respsize}","respversion":"%s{respversion}","rulelabel":"%s{rulelabel}","ruletype":"%s{ruletype}","serverip":"%s{sip}","serversslsessreuse":"%s{serversslsessreuse}","servertranstime":"%d{stime}","srvcertchainvalpass":"%s{srvcertchainvalpass}","srvcertvalidationtype":"%s{srvcertvalidationtype}","srvcertvalidityperiod":"%s{srvcertvalidityperiod}","srvocspresult":"%s{srvocspresult}","srvsslcipher":"%s{srvsslcipher}","srvtlsversion":"%s{srvtlsversion}","srvwildcardcert":"%s{srvwildcardcert}","status":"%s{respcode}","threatcategory":"%s{malwarecat}","threatclass":"%s{malwareclass}","threatname":"%s{threatname}","throttlereqsize":"%d{throttlereqsize}","throttlerespsize":"%d{throttlerespsize}","trafficredirectmethod":"%s{trafficredirectmethod}","transactionsize":"%d{totalsize}","tz":"%s{tz}","ua_token":"%s{ua_token}","uaclass":"%s{uaclass}","url":"%s{eurl}","urlcategory":"%s{urlcat}","urlclass":"%s{urlclass}","urlsupercategory":"%s{urlsupercat}","user":"%s{login}"\}

-->
<!-- 

{"full_log":"Aug 12 16:26:30 5.195.107.202 0|Zscaler|NSSWeblog|5.0|Allowed|Allowed|3|act=Allowed app=HTTP cat=Corporate Marketing dhost=ctldl.windowsupdate.com dst=93.184.221.240 src=10.100.229.24 in=268 outcome=304 out=246 request=ctldl.windowsupdate.com/msdownload/update/v3/static/trustedr/en/pinrulesstl.cab?385453c37881699d rt=Aug 12 2024 16:23:32 sourceTranslatedAddress=5.195.134.42 requestClientApplication=Microsoft-CryptoAPI/10.0 requestMethod=GET suser=avsupport@iffco.com spriv=TIFFANY TOWERS externalId=7402227580825567249 fileType=None reason=Allowed destinationServiceName=General Browsing cn1=0 cn1Label=riskscore cs1=Corporate-Information Services cs1Label=dept cs2=Business and Economy cs2Label=urlsupercat cs3=General Browsing cs3Label=appclass cs4=None cs4Label=malwarecat cs5=None cs5Label=threatname cs6=None cs6Label=dlpeng ZscalerNSSWeblogURLClass=Business Use ZscalerNSSWeblogDLPDictionaries=None requestContext=None contenttype=Other unscannabletype=None deviceowner=avsupport devicehostname=LAEDB2885 keyprotectiontype=N/A tenant=IFFCOSH productName=Zscaler productType=Proxy logType=network","L0":"ddd4b256-d7fe-47b5-bf3c-2c8669f35355","L1":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L2":"a8eee020-d655-40f8-98b8-bdc5a6a9e45c","L3":"fbdbbd91-9eba-479e-902c-6f857cc81365"}


{"full_log":"Aug 12 16:26:30 5.195.107.202 0|Zscaler|NSSWeblog|5.0|Blocked|Not allowed to access this file type|3|act=Blocked app=HTTPS cat=Corporate Marketing dhost=dds.autodesk.com dst=23.208.213.43 src=10.100.18.45 in=15198 outcome=403 out=206 request=dds.autodesk.com/netswdld/odis/prd/1.0/odis/ea5acc81-82cf-339d-9431-6421559b3772/pkg.odis.tar rt=Aug 12 2024 16:23:32 sourceTranslatedAddress=5.195.107.202 requestClientApplication=ODIS/DownloadManager/1.44.0.3 requestMethod=GET suser=mpurayil@iffco.com spriv=IFFCO OLD HO externalId=7402227580825894983 fileType=TAR Files reason=Not allowed to access this file type destinationServiceName=Autodesk cn1=0 cn1Label=riskscore cs1=Plastics cs1Label=dept cs2=Business and Economy cs2Label=urlsupercat cs3=IT Services cs3Label=appclass cs4=None cs4Label=malwarecat cs5=None cs5Label=threatname cs6=None cs6Label=dlpeng ZscalerNSSWeblogURLClass=Business Use ZscalerNSSWeblogDLPDictionaries=None requestContext=None contenttype=application/x_tar unscannabletype=None deviceowner=mpurayil devicehostname=LAE81849 keyprotectiontype=Software Protection tenant=IFFCOSH productName=Zscaler productType=Proxy logType=network","L0":"ddd4b256-d7fe-47b5-bf3c-2c8669f35355","L1":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L2":"a8eee020-d655-40f8-98b8-bdc5a6a9e45c","L3":"fbdbbd91-9eba-479e-902c-6f857cc81365"}


{"full_log":"Aug 12 16:26:30 5.195.107.202 0|Zscaler|NSSWeblog|5.0|Allowed|Allowed|3|act=Allowed app=HTTPS cat=Internet Services dhost=play.google.com dst=142.250.181.174 src=10.101.1.101 in=1255 outcome=200 out=6157 request=play.google.com/log?format%3djson&hasfast%3dtrue&authuser%3d0 rt=Aug 12 2024 16:23:31 sourceTranslatedAddress=82.178.126.251 requestClientApplication=Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36 requestMethod=POST suser=skarthik@iffco.com spriv=Road Warrior externalId=7402227576529944581 fileType=GZIP reason=Allowed destinationServiceName=Google Play cn1=0 cn1Label=riskscore cs1=S&D Oman cs1Label=dept cs2=Internet Communication cs2Label=urlsupercat cs3=Mobile App Download cs3Label=appclass cs4=None cs4Label=malwarecat cs5=None cs5Label=threatname cs6=None cs6Label=dlpeng ZscalerNSSWeblogURLClass=Business Use ZscalerNSSWeblogDLPDictionaries=None requestContext=mail.google.com/ contenttype=text/plain unscannabletype=None deviceowner=skarthik devicehostname=LOM80006 keyprotectiontype=Software Protection tenant=IFFCOSH productName=Zscaler productType=Proxy logType=network","L0":"ddd4b256-d7fe-47b5-bf3c-2c8669f35355","L1":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L2":"a8eee020-d655-40f8-98b8-bdc5a6a9e45c","L3":"fbdbbd91-9eba-479e-902c-6f857cc81365"}

Universal regex 1 - for the values starting with (",',\"\')
parameter\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)
 
Universal regex 2
parameter\s*=\s*(.*?)(?=\s*(\s\w+)=|$)
 -->
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<prematch type="pcre2">\|Zscaler\|NSSWeblog\|</prematch>
	<regex type="pcre2">\|Zscaler\|([^|]+)\|</regex>
	<order>name</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\|Zscaler\|[^|]+\|([^|]+)\|[^|]+\|[^|]+\|[^|]+\|</regex>
	<order>version</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\|Zscaler\|[^|]+\|[^|]+\|[^|]+\|[^|]+\|([^|]+)\|</regex>
	<order>severity</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bact\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>action</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bact\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>action</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bapp\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>protocol</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bapp\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>protocol</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcat\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>url_category</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcat\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>url_category</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdhost\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>dst_host</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdhost\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>dst_host</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdst\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>dst_ip</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdst\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>dst_ip</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsrc\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>src_ip</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsrc\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>src_ip</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bin\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>inbound_bytes</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bin\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>inbound_bytes</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\boutcome\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>outcome</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\boutcome\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>outcome</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bout\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>outbound_bytes</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bout\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>outbound_bytes</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequest\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>request_url</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequest\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>request_url</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brt\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>datetime</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brt\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>datetime</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsourceTranslatedAddress\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>source_translatedaddress</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsourceTranslatedAddress\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>source_translatedaddress</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequestClientApplication\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>request_clientapplication</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequestClientApplication\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>request_clientapplication</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequestMethod\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>request_method</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequestMethod\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>request_method</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsuser\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>src_usr</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsuser\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>src_usr</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bspriv\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>location</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bspriv\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>location</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bexternalId\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>external_id</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bexternalId\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>external_id</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bfileType\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>file_type</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bfileType\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>file_type</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\breason\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>reason</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\breason\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>reason</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdestinationServiceName\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>destination_servicename</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdestinationServiceName\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>destination_servicename</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcn1\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cn1</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcn1\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cn1</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcn1\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cn1Label=riskscore</regex>
	<order>risk_score</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcn1\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cn1Label=riskscore</regex>
	<order>risk_score</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs1\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cs1</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs1\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cs1</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs1\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cs1Label=dept</regex>
	<order>department</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs1\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cs1Label=dept</regex>
	<order>department</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs2\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cs2</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs2\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cs2</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs2\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cs2Label=urlsupercat</regex>
	<order>url_supercategory</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs2\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cs2Label=urlsupercat</regex>
	<order>url_supercategory</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs3\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cs3</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs3\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cs3</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs3\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cs3Label=appclass</regex>
	<order>app_class</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs3\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cs3Label=appclass</regex>
	<order>app_class</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs4\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cs4</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs4\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cs4</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs4\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cs4Label=malwarecat</regex>
	<order>malware_category</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs4\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cs4Label=malwarecat</regex>
	<order>malware_category</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs5\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cs5</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs5\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cs5</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs5\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cs5Label=threatname</regex>
	<order>threat_name</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs5\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cs5Label=threatname</regex>
	<order>threat_name</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs6\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>cs6</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs6\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>cs6</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs6\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$).*cs6Label=dlpeng</regex>
	<order>dlp_engine</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcs6\s*=\s*(.*?)(?=\s*(\s\w+)=|$).*cs6Label=dlpeng</regex>
	<order>dlp_engine</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bZscalerNSSWeblogURLClass\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>ZscalerNSSWeblogURLClass</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bZscalerNSSWeblogURLClass\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>ZscalerNSSWeblogURLClass</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bZscalerNSSWeblogDLPDictionaries\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>ZscalerNSSWeblogDLPDictionaries</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bZscalerNSSWeblogDLPDictionaries\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>ZscalerNSSWeblogDLPDictionaries</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequestContext\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>request_context</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\brequestContext\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>request_context</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcontenttype\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>content_type</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bcontenttype\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>content_type</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bunscannabletype\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>unscannable_type</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bunscannabletype\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>unscannable_type</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdeviceowner\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>device_owner</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdeviceowner\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>device_owner</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdevicehostname\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>device_hostname</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bdevicehostname\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>device_hostname</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">keyprotectiontype=([^,\s]+)"</regex>
	<order>key_protectiontype</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bapp_category\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>url_category</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bapp_category\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>url_category</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\"cust1\"\s*:\s*"((?:\\"|[^"])+)\"</regex>
	<order>logger_id</order>
</decoder>

<!-- Remove after update in Rules -->
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsuser\s*=\s*?[(\\"']?[(\\"'](.*?)(?=('|"|\\"|)\s*(\s\w+)=|$)</regex>
	<order>source_user</order>
</decoder>
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<regex type="pcre2">\bsuser\s*=\s*(.*?)(?=\s*(\s\w+)=|$)</regex>
	<order>source_user</order>
</decoder>
<!-- Do Not Alter or Delete || Keep this at the end of the decoder -->
<decoder name="zscaler-proxy-json">
	<parent>json</parent>
	<plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>