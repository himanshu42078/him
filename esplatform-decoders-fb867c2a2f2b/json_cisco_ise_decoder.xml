<!--
SAMPLE LOGS

{"full_log":" 0000233387 1 0 2024-12-29 22:00:19.708 +07:00 0013821334 5200 NOTICE Passed-Authentication: Authentication succeeded, ConfigVersionId=29, Device IP Address=192.168.113.66, DestinationIPAddress=172.17.1.55, DestinationPort=1812, UserName=74-40-BB-E6-ED-E5, Protocol=Radius, RequestLatency=79, NetworkDeviceName=DPA-WLC.dpa.or.th, User-Name=7440bbe6ede5, NAS-IP-Address=192.168.113.66, NAS-Port=111317, Service-Type=Call Check, Framed-MTU=1485, Called-Station-ID=c8-84-a1-72-1f-00:DPA-WIFI-GUEST, Calling-Station-ID=74-40-bb-e6-ed-e5, NAS-Identifier=DPA-WLC, NAS-Port-Type=Wireless - IEEE 802.11, EAP-Key-Name=, cisco-av-pair=service-type=Call Check, cisco-av-pair=audit-session-id=4271A8C0000DA5CA12EEB07C, cisco-av-pair=method=mab, cisco-av-pair=client-iif-id=620759141, cisco-av-pair=vlan-id=1, cisco-av-pair=cisco-wlan-ssid=DPA-WIFI-GUEST, cisco-av-pair=wlan-profile-name=DPA-WIFI-G_Global_F_9b2215ab, Airespace-Wlan-Id=17, OriginalUserName=7440bbe6ede5, NetworkDeviceProfileName=Cisco, NetworkDeviceProfileId=b0699505-3150-4215-a80e-6753d45bf56c, IsThirdPartyDeviceFlow=false, RadiusFlowType=WirelessMAB, SSID=c8-84-a1-72-1f-00:DPA-WIFI-GUEST, AcsSessionID=DPA-ISE-01\/522584595\/230275, AuthenticationIdentityStore=Internal Endpoints, AuthenticationMethod=Lookup, SelectedAccessService=Default Network Access, SelectedAuthorizationProfiles=DPA-Guest-Portal_Profile, SelectedAuthorizationProfiles=Guests, UseCase=Host Lookup, IdentityGroup=Endpoint Identity Groups:DPAFacescan, Step=11001, Step=11017, Step=11027, Step=15049, Step=15008, Step=15048, Step=15048, Step=15048, Step=15041, Step=15048, Step=22072, Step=15013, Step=24209, Step=24211, Step=22037, Step=24715, Step=15036, Step=15016, Step=15016, Step=11002, SelectedAuthenticationIdentityStores=Internal Endpoints, SelectedAuthenticationIdentityStores=Guest Users, SelectedAuthenticationIdentityStores=Internal Users, AuthenticationStatus=AuthenticationPassed, NetworkDeviceGroups=IPSEC#Is IPSEC Device#No, NetworkDeviceGroups=Location#All Locations, NetworkDeviceGroups=Device Type#All Device Types, IdentityPolicyMatchedRule=Guest-Auth, AuthorizationPolicyMatchedRule=DPA-Guest-Portal_RedirectPolicy, cisco-av-pair=AuthenticationIdentityStore=Internal Endpoints, UserType=Host, CPMSessionID=4271A8C0000DA5CA12EEB07C, EndPointMACAddress=74-40-BB-E6-ED-E5, PostureAssessmentStatus=Pending, EndPointMatchedProfile=Microsoft-Workstation, DeviceRegistrationStatus=notRegistered, ISEPolicySetName=DPA-Guest-Wireless, IdentitySelectionMatchedRule=Guest-Auth, StepData=5= Network Access.Device IP Address, StepData=6= Radius.Called-Station-ID, StepData=7= Normalised Radius.RadiusFlowType, StepData=9= Radius.Called-Station-ID, StepData=10=Internal_Guest_Endpoint, StepData=11=Internal Endpoints, allowEasyWiredSession=false, DTLSSupport=Unknown, HostIdentityGroup=Endpoint Identity Groups:DPAFacescan, Network Device Profile=Cisco, Location=Location#All Locations, Device Type=Device Type#All Device Types, IPSEC=IPSEC#Is IPSEC Device#No, Name=Endpoint Identity Groups:DPAFacescan, Response={UserName=74:40:BB:E6:ED:E5; User-Name=74-40-BB-E6-ED-E5; Class=CACS:4271A8C0000DA5CA12EEB07C:DPA-ISE-01\/522584595\/230275; cisco-av-pair=url-redirect-acl=DNAC_ACL_WEBAUTH_REDIRECT; cisco-av-pair=url-redirect=https:\/\/DPA-ISE-01.dpa.or.th:8443\/portal\/gateway?sessionId=4271A8C0000DA5CA12EEB07C&portal=5174a9e9-a9fc-40a5-bc6d-f7be81ea6e2e&action=cwa&token=0515dbbc8ecdf681b34d7ad5786924c2; cisco-av-pair=cts:security-group-tag=0006-01; cisco-av-pair=profile-name=Microsoft-Workstation; LicenseTypes=1; },#015 tenant=DPA productName=CiscoISE productType=firewall logType=network","tenant":"DPA","productName":"CiscoISE","productType":"firewall","logType":"network","L0":"c2dff664-dc11-438f-a0e0-5e8afba36ac4","L1":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L2":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L3":"15f5a1f2-f61c-44e9-983d-37b442138f06"}

{"full_log":" 0000236336 1 0 2024-12-30 09:24:33.571 +07:00 0013886623 80002 INFO  Profiler: Profiler EndPoint profiling event occurred, ConfigVersionId=29, OperatingSystem=Android, EndpointCertainityMetric=0, EndpointIPAddress=192.168.35.161, EndpointMacAddress=F8:4F:AD:36:01:98, EndpointMatchedPolicy=Unknown, EndpointNADAddress=192.168.113.66, EndpointOUI=Hui Zhou Gaoshengda Technology Co.\\,LTD, EndpointPolicy=Unknown, EndpointProperty=dhcp-class-identifier=android-dhcp-9\\,PolicyVersion=0\\,IPSEC=IPSEC#Is IPSEC Device#No\\,AuthenticationIdentityStore=Internal Endpoints\\,EndPointPolicyID=\\,EndPointVersion=159\\,AuthenticationMethod=Lookup\\,FirstCollection=1733210917478\\,DestinationPort=1812\\,CacheUpdateTime=1735525473545\\,IdentityPolicyMatchedRule=Guest-Auth\\,Name=Endpoint Identity Groups:Unknown\\,StaticAssignment=false\\,User-Name=F8-4F-AD-36-01-98\\,allowEasyWiredSession=false\\,NmapScanCount=0\\,PostureExpiry=\\,SelectedAccessService=Default Network Access\\,NetworkDeviceName=DPA-WLC.dpa.or.th\\,NAS-Port=111317\\,DestinationIPAddress=172.17.1.55\\,AAA-Server=DPA-ISE-01\\,MessageCode=3002\\,SelectedAuthenticationIdentityStores=Internal Endpoints\\, Guest Users\\, Internal Users\\,Ignored-User-Agent=okhttp\/3.12.0\\,Acct-Output-Gigawords=0\\,Device Type=Device Type#All Device Types\\,IsThirdPartyDeviceFlow=false\\,Device IP Address=192.168.113.66\\,PortalUser=\\,AllowedProtocolMatchedRule=Guest-Auth\\,AuthenticationStatus=AuthenticationPassed\\,NetworkDeviceGroups=IPSEC#Is IPSEC Device#No\\, Location#All Locations\\, Device Type#All Device Types\\,BYODRegistration=Unknown\\,IdentitySelectionMatchedRule=Guest-Auth\\,Calling-Station-ID=f8-4f-ad-36-01-98\\,OriginalUserName=f84fad360198\\,FailureReason=-\\,Total Certainty Factor=0\\,Network Device Profile=Cisco\\,MDMServerID=\\,Called-Station-ID=68-7d-b4-fc-c7-2b\\, c8-84-a1-72-0c-00:DPA-WIFI-GUEST\\,UserType=Host\\,IdentityGroupID=aa0e8b20-8bff-11e6-996c-525400b48521\\,dhcp-parameter-request-list=1\\, 3\\, 6\\, 15\\, 26\\, 28\\, 51\\, 58\\, 59\\, 43\\,OperatingSystem=Android\\,PostureApplicable=Yes\\,NAS-Identifier=DPA-WLC\\,NmapSubnetScanID=0\\,Device Identifier=\\,NAS-Port-Type=Wireless - IEEE 802.11\\,StepData=5= Network Access.Device IP Address\\, 6= Radius.Called-Station-ID\\, 7= Normalised Radius.RadiusFlowType\\, 9= Radius.Called-Station-ID\\, 10=Internal_Guest_Endpoint\\, 11=Internal Endpoints\\,RegistrationTimeStamp=0\\,Airespace-Wlan-Id=17\\,PhoneID=\\,Framed-IPv6-Address=fe80::fa4f:adff:fe36:198\\,DeviceRegistrationStatus=NotRegistered\\,RadiusFlowType=WirelessMAB\\,MatchedPolicyID=\\,SSID=c8-84-a1-72-0c-00:DPA-WIFI-GUEST\\,Service-Type=Call Check\\,UserName=F8-4F-AD-36-01-98\\,FeedService=false\\,CreateTime=1683009952092\\,UseCase=Host Lookup\\,SelectedAuthorizationProfiles=DPA-Guest-Portal_Profile\\, Guests\\,NAS-Port-Id=capwap_90000037\\,StaticGroupAssignment=false\\,host-name=\\,DTLSSupport=Unknown\\,LastActivity=1735525473502\\,Response=\\{UserName=F8:4F:AD:36:01:98\\; User-Name=F8-4F-AD-36-01-98\\; Class=CACS:4271A8C0000DA745155E279C:DPA-ISE-01\/522584595\/232564\\; cisco-av-pair=url-redirect-acl=DNAC_ACL_WEBAUTH_REDIRECT\\; cisco-av-pair=url-redirect=https:\/\/DPA-ISE-01.dpa.or.th:8443\/portal\/gateway?sessionId=4271A8C0000DA745155E279C&portal=5174a9e9-a9fc-40a5-bc6d-f7be81ea6e2e&action=cwa&token=83721b8862d38ebdc429df4626198ca9\\; cisco-av-pair=cts:security-group-tag=0006-01\\; cisco-av-pair=profile-name=Unknown\\; LicenseTypes=1\\; \\}\\,LastNmapScanTime=0\\,EndPointMACAddress=F8-4F-AD-36-01-98\\,NetworkDeviceProfileId=b0699505-3150-4215-a80e-6753d45bf56c\\,UpdateTime=1734977763342\\,NetworkDeviceProfileName=Cisco\\,Framed-IP-Address=192.168.35.161\\,AuthorizationPolicyMatchedRule=DPA-Guest-Portal_RedirectPolicy\\,Acct-Input-Gigawords=0\\,Location=Location#All Locations\\,UniqueSubjectID=\\,PostureAssessmentStatus=Pending, EndpointSourceEvent=RADIUS Probe, EndpointUserAgent=Mozilla\/5.0 (Linux\\\\\\; Android 9.0\\\\ Build\/PPR1.180610.011) AppleWebKit\/537.36 (KHTML\\, like Gecko) Chrome\/92.0.4515.159 Safari\/537.36 CrKey\/1.56.500000 DeviceType\/AndroidTV, EndpointIdentityGroup=Unknown, ProfilerServer=DPA-ISE-01.dpa.or.th, #015 tenant=DPA productName=CiscoISE productType=firewall logType=network","tenant":"DPA","productName":"CiscoISE","productType":"firewall","logType":"network","L0":"c2dff664-dc11-438f-a0e0-5e8afba36ac4","L1":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L2":"rrrrrrrr-rrrr-rrrr-rrrr-rrrrrrrrrrrr","L3":"15f5a1f2-f61c-44e9-983d-37b442138f06"}

-->

<decoder name="cisco-ise-json">
	<parent>json</parent>
	<prematch type="pcre2">(?i)productName=CiscoISE|"productName"\s*:\s*"CiscoISE"</prematch>
	<regex type="pcre2">(\d+)\s+([A-Z]+)\s+([A-Za-z-]+):</regex>
	<order>log_id,severity,log_type</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bDevice\s*IP\s*Address\s*="?([\d.]+)"?</regex>
	<order>src_ip</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bDestinationIPAddress\s*="?([\d.]+)"?</regex>
	<order>dst_ip</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bUserName\s*=\s*(.*?)(?=\,(\s\w+)=|$)</regex>
	<order>username</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bUser-Name\s*=\s*([^,\s]+),</regex>
	<order>username</order>
</decoder>
<!-- <decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bAuthenticationMethod\s*=\s*(.*?)(?=\,(\s\w+)=|$)</regex>
	<order>auth_method</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bDetailedInfo\s*=\s*(.*?)(?=\,(\s\w+)=|$)</regex>
	<order>message_text</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bFailureReason\s*=\s*(.*?)(?=\,(\s\w+)=|$)</regex>
	<order>failure_reason</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bNetworkDeviceName\s*=\s*([^,\s]+),</regex>
	<order>network_device_name</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bNAS-IP-Address\s*=\s*([^,\s]+),</regex>
	<order>nas_ip</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bNAS-Port\s*=\s*([^,\s]+),</regex>
	<order>nas_port</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bFramed-IP-Address\s*=\s*([^,\s]+),</regex>
	<order>framed_ip</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bProtocol\s*=\s*([^,\s]+),</regex>
	<order>protocol_name</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bAuthen-Method\s*=\s*([^,\s]+),</regex>
	<order>auth_method</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bAuthenticationStatus\s*=\s*([^,\s]+),</regex>
	<order>auth_status</order>
</decoder>
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<regex type="pcre2">\bEndPointMACAddress\s*=\s*([^,\s]+),</regex>
	<order>endpoint_mac</order>
</decoder> -->
<!-- Do Not Alter or Delete || Keep this at the end of the decoder -->
<decoder name="cisco-ise-json">
	<parent>json</parent>
	<plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>