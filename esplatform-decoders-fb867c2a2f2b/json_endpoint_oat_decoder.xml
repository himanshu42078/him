<!--
{"source": "endpointActivityData", "uuid": "b1bbc343-b2ea-4428-9631-4c64d63206fe", "detectedDateTime": "2024-01-11T07:37:50Z", "filters_0_id": "F5634", "filters_0_name": "Scheduled Task Creation via File", "filters_0_description": "Detect creation/execution of scheduled task", "filters_0_highlightedObjects_0_field": "objectFilePath", "filters_0_highlightedObjects_0_type": "fullpath", "filters_0_highlightedObjects_0_value": "C:\\Windows\\System32\\Tasks\\OneDrive Reporting Task-S-1-5-21-3995503830-178758855-2493544469-469374", "filters_0_highlightedObjects_1_field": "processCmd", "filters_0_highlightedObjects_1_type": "command_line", "filters_0_highlightedObjects_1_value": "C:\\WINDOWS\\system32\\svchost.exe -k netsvcs -p -s Schedule", "filters_0_highlightedObjects_2_field": "parentCmd", "filters_0_highlightedObjects_2_type": "command_line", "filters_0_highlightedObjects_2_value": "C:\\WINDOWS\\system32\\services.exe", "filters_0_mitreTacticIds_0": "TA0002", "filters_0_mitreTacticIds_1": "TA0003", "filters_0_mitreTacticIds_2": "TA0004", "filters_0_mitreTechniqueIds_0": "T1053.005", "filters_0_riskLevel": "info", "filters_0_type": "preset", "detail_endpointGuid": "330b653f-15cc-4927-91eb-df31fc9f4094", "detail_endpointHostName": "YBDT39YWBZ2", "detail_endpointIp_0": "10.102.128.234", "detail_endpointIp_1": "169.254.113.114", "detail_eventId": "2", "detail_eventSubId": 101, "detail_eventTime": "1704958670046", "detail_firstSeen": "1704958670046", "detail_integrityLevel": 16384, "detail_lastSeen": "1704958670046", "detail_objectFilePath": "C:\\Windows\\System32\\Tasks\\OneDrive Reporting Task-S-1-5-21-3995503830-178758855-2493544469-469374", "detail_objectHashId": "-2358631477184590391", "detail_objectSubTrueType": 0, "detail_parentCmd": "C:\\WINDOWS\\system32\\services.exe", "detail_parentFileHashMd5": "e606e7e0d5e94af8222715a24df0776b", "detail_parentFileHashSha1": "e5704d8e560122c2a23de8912ae63b213d67c860", "detail_parentFileHashSha256": "43ec773e0ec626bf6d8a7fd04e64dc36afa6801444a3c36ef4da2a909fa0d83f", "detail_parentFilePath": "C:\\Windows\\System32\\services.exe", "detail_parentPid": 884, "detail_pname": "751", "detail_processCmd": "C:\\WINDOWS\\system32\\svchost.exe -k netsvcs -p -s Schedule", "detail_processFileHashMd5": "145dcf6706eeea5b066885ee17964c09", "detail_processFileHashSha1": "445f5f38365af88ec29b357f4696f0e3ee50a1d8", "detail_processFileHashSha256": "f13de58416730d210dab465b242e9c949fb0a0245eef45b07c381f0c6c8a43c3", "detail_processFilePath": "C:\\Windows\\System32\\svchost.exe", "detail_processHashId": "-640048756142166598", "detail_processName": "C:\\Windows\\System32\\svchost.exe", "detail_processPid": 2008, "detail_processUser": "SYSTEM", "detail_tags_0": "MITRE.T1053.005", "detail_tags_1": "XSAE.F5634", "detail_uuid": "b1bbc343-b2ea-4428-9631-4c64d63206fe", "detail_productCode": "xes", "detail_filterRiskLevel": "info", "detail_osDescription": "Windows 10 Pro (64 bit) build 19045", "detail_deviceType": 0, "detail_parentLaunchTime": 1704951452647.0, "detail_parentFileHashId": -4092577940452904134, "detail_parentHashId": 4062338807385955443, "detail_parentIntegrityLevel": 16384, "detail_parentName": "C:\\Windows\\System32\\services.exe", "detail_parentSigner_0": "Microsoft Windows Publisher", "detail_parentSignerValid_0": true, "detail_parentTrueType": 7, "detail_parentUser": "SYSTEM", "detail_parentUserDomain": "NT AUTHORITY", "detail_processFileHashId": -821808160829839906, "detail_processLaunchTime": 1704951458956.0, "detail_processSigner_0": "Microsoft Windows Publisher", "detail_processSignerValid_0": true, "detail_processTrueType": 7, "detail_processUserDomain": "NT AUTHORITY", "detail_pplat": 5889, "detail_objectFileCreation": "1704958669999", "detail_eventHashId": "7058379221328496365", "detail_sessionId": 0, "detail_processFileModifiedTime": "1704797444532", "detail_parentFileModifiedTime": "1704797478899", "detail_parentFileSize": "716032", "detail_osType": "0x00000030", "detail_parentSessionId": 0, "detail_osVer": "10.0.19045", "detail_plang": 1, "detail_authId": "999", "detail_parentAuthId": "999", "detail_objectFileSize": "3596", "detail_endpointMacAddress_0": "e4:54:e8:64:85:d6", "detail_endpointMacAddress_1": "02:50:f2:00:00:01", "detail_objectFileModifiedTime": "1704958669999", "detail_eventSourceType": 1, "detail_timezone": "UTC+05:30", "detail_parentFileCreation": "1704797478721", "detail_processFileSize": "55456", "detail_osName": "Windows", "detail_processFileCreation": "1704797444505", "detail_pver": "1.2.0.4484", "detail_objectLastSeen": "1704958670046", "detail_objectFirstSeen": "1704958670046", "detail_nativeDeviceType": 7, "detail_nativeDeviceCharacteristics": 131072, "detail_nativeStorageDeviceBusType": 8, "detail_objectFileDaclString": "D:(A;;FR;;;S-1-5-21-3995503830-178758855-2493544469-469374)(A;ID;0x1f019f;;;BA)(A;ID;0x1f019f;;;SY)(A;ID;FA;;;S-1-5-21-3995503830-178758855-2493544469-469374)", "ingestedDateTime": "2024-01-11T07:38:02Z", "entityType": "endpoint", "entityName": "YBDT39YWBZ2(10.102.128.234,169.254.113.114)", "endpoint_ips_0": "10.102.128.234", "endpoint_ips_1": "169.254.113.114", "endpoint_agentGuid": "330b653f-15cc-4927-91eb-df31fc9f4094", "endpoint_endpointName": "YBDT39YWBZ2", "tenant": "StraitsFinancial", "productName": "visionone", "productType": "XDR", "productModule": "oat", "logType": "Endpoint"}

-->
<decoder name="oat">
	<parent>json</parent>
	<prematch>^\s+{\s*"source":\s*"endpointActivityData"</prematch>
	<regex type="pcre2">"detail_endpointGuid":\s*"([^"]*)"</regex>
	<order>endpoint_id</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_endpointHostName":\s*"([^"]*)"</regex>
	<order>endpoint_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_endpointHostName":\s*"([^"]*)"</regex>
	<order>src_usr</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_endpointIp_0":\s*"([^"]*)"</regex>
	<order>endpoint_ip</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_eventId":\s*"([^"]*)"</regex>
	<order>id</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_eventSubId":\s*(\d+)</regex>
	<order>subid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_eventTime":\s*"([^"]*)"</regex>
	<order>event_time</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_integrityLevel":\s*(\d+)</regex>
	<order>integrity_level</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_objectHashId":\s*"([^"]*)"</regex>
	<order>object_processhashID</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectRegistryKeyHandle"\s*:\s*"((?:\\"|[^"])+)"</regex>
	<order>registry_key</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_objectRegistryValue":\s*"([^"]*)"</regex>
	<order>registry_value</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentCmd"\s*:\s*"((?:\\"|[^"])+)"</regex>
	<order>parent_cli_command</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentFileHashMd5":\s*"([^"]*)"</regex>
	<order>parent_file_md5</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentFileHashSha1":\s*"([^"]*)"</regex>
	<order>parent_file_sha1</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentFileHashSha256":\s*"([^"]*)"</regex>
	<order>parent_file_sha256</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentFilePath":\s*"([^"]*)"</regex>
	<order>parent_file_path</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentPid":\s*(\d+)</regex>
	<order>parent_pid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_pname":\s*"([^"]*)"</regex>
	<order>product_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processCmd"\s*:\s*"((?:\\"|[^"])+)"</regex>
	<order>process_cli_command</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processFileHashMd5":\s*"([^"]*)"</regex>
	<order>process_file_md5</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processFileHashSha1":\s*"([^"]*)"</regex>
	<order>process_file_sha1</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processFileHashSha256":\s*"([^"]*)"</regex>
	<order>process_file_sha256</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processFilePath":\s*"([^"]*)"</regex>
	<order>process_file_path</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processHashId":\s*"([^"]*)"</regex>
	<order>process_hashID</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processName":\s*"([^"]*)"</regex>
	<order>process_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processPid":\s*(\d+)</regex>
	<order>process_pid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processUser":\s*"([^"]*)"</regex>
	<order>process_user</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_tags_0":\s*"([^"]*)"</regex>
	<order>tag</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"uuid":\s*"([^"]*)"</regex>
	<order>unique_id</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_productCode":\s*"([^"]*)"</regex>
	<order>product_code</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_filterRiskLevel":\s*"([^"]*)"</regex>
	<order>risk_level</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_osDescription":\s*"([^"]*)"</regex>
	<order>os_description</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentLaunchTime":\s*(\d+)</regex>
	<order>parent_time</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentFileHashId":\s*([+-]?\d+)</regex>
	<order>parentfile_hashID</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentHashId":\s*(\d+)</regex>
	<order>parent_hashID</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentIntegrityLevel":\s*(\d+)</regex>
	<order>parent_integrity</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentName":\s*"([^"]*)"</regex>
	<order>parent_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentSigner_0":\s*"([^"]*)"</regex>
	<order>parent_signer</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentSignerValid_0":\s*([^"]*),</regex>
	<order>parent_signer_valid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentTrueType":\s*(\d+)</regex>
	<order>parent_type</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentUser":\s*"([^"]*)"</regex>
	<order>parent_user</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_parentUserDomain":\s*"([^"]*)"</regex>
	<order>parent_userdomain</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processFileHashId":\s*([+-]?\d+)</regex>
	<order>processfile_hashID</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_processLaunchTime":\s*(\d+)</regex>
	<order>process_launchtime</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_processSigner_0":\s*"([^"]*)"</regex>
	<order>processfile_signer</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_processSignerValid_0":\s*([^"]*),</regex>
	<order>processfile_signer_valid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_processTrueType":\s*([^"]*),</regex>
	<order>process_type</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_processUserDomain":\s*"([^"]*)"</regex>
	<order>process_userdomain</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_objectCmd"\s*:\s*"((?:\\"|[^"])+)"</regex>
	<order>cli_command</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectFilePath":\s*"([^"]*)"</regex>
	<order>file_path</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_dpt":\s+(\d+)</regex>
	<order>dstport</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_dst":\s*"([^"]*)"</regex>
	<order>dstip</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_spt":\s+(\d+)</regex>
	<order>srcport</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_winEventId":\s+(\d+)</regex>
	<order>win_eventid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectPort":\s+(\d+)</regex>
	<order>object_port</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectHostName"\s*:\s*"((?:\\"|[^"])+)"</regex>
	<order>domain_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectBmData"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>eventbm_data</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectAppName"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>application_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_srcFilePath"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>src_file_path</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectRawDataStr_0"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>objectraw_data</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_eventDataOperation"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>event_operation</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectUser"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>user</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectRegistryData"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>registry_data</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectSignerValid_0"\s*:\s+(\w+)</regex>
	<order>process_signer_valid</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_hostName"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>host_domain_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_app"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>application_category</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_osDescription"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>os_description</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_providerName"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>provider_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_objectRunAsLocalAccount"\s*:(?:\s+|)(\w+)</regex>
	<order>object_local_account</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">detail_osName"\s*:\s*"((?:\\"|[^"])+)</regex>
	<order>os_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">\"detail_attachmentFileName_0\"[:=]\s+?"?([^"']*)?["']?[,]</regex>
	<order>file_name</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_src_0\"[:=]\s+?"?([^"']*)?["']?[,]</regex>
	<order>src_ip</order>
</decoder>
<decoder name="oat">
	<parent>json</parent>
	<regex type="pcre2">"detail_dst_0\"[:=]\s+?"?([^"']*)?["']?[,]</regex>
	<order>dst_ip</order>
</decoder>
<!-- Do Not Alter or Delete || Keep this at the end of the decoder -->
<decoder name="oat">
	<parent>json</parent>
	<plugin_decoder>JSON_Decoder</plugin_decoder>
</decoder>