<!-- 
fortigate : 111500 to 112000
unused id : 111587,111623,
start with : 
Iffco usecases start range : 111696 
kalupur usecase start range : 111792
fortiauthenticator: 111900 to 111950



Jun 13 18:19:48 10-4-29-125.prometheus-prometheus-node-exporter.monitoring.svc.cluster.local 0|Fortinet|FortiGate-101F|7.2.7, (GA)|0100032132|system event enable|5|start=Jun 13 2024 18:17:00 logver=702071577 deviceExternalId=FG101FTK21023438 dvchost=ae-dxb-ifbs-gfsrvrm-pfw01 ad.vd=root ad.eventtime=1718288219907489969 ad.tz=+0400 ad.logid=0100032132 cat=event ad.subtype=system deviceSeverity=notice ad.logdesc=Local user added duser=t_kdeenathayalan@FortiManager sproc=fgfm_tunnel ad.name=guest ad.status=enable msg=User t_kdeenathayalan@FortiManager added local user guest from fgfm_tunnel tz="+0400" tenant=IFFCOSH productName=FortiAnalyzer productType=firewall logType=network

-->
<group name="fortigate,">
	<rule id="111500" level="0" noalert="1">
		<decoded_as>forti-analyzer</decoded_as>
		<description>Fortigate: Fortianalyzer events.</description>
		<group>info,one-on-one</group>
	</rule>

	<rule id="111618" level="0" noalert="1">
		<decoded_as>json</decoded_as>
		<field name="productName" type="pcre2">(?i)^Fortigate|^FortiAnalyzer</field>
		<description>Fortigate: Fortigate json events.</description>
		<group>info,one-on-one</group>
	</rule>

	<rule id="111501" level="1" noalert="1">
		<description>Fortigate messages grouped.</description>
		<if_sid>111500,111618</if_sid>
		<group>info,one-on-one</group>
	</rule>

	<!-- Fortigate: File reported infected by Outbreak Prevention. -->
	<rule id="111502" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008202$</field>
		<description>Fortigate: File reported infected by Outbreak Prevention.</description>
		<info type="text">
    Description: Outbreak Prevention is a security feature designed to detect and block potential malware outbreaks within a network. When a file is reported as infected by Outbreak Prevention, it indicates that the system has identified a file as malicious or potentially harmful. The detection could be based on heuristic analysis, pattern matching, or behavior-based techniques aimed at preventing the spread of malware.
    </info>
		<group>low,one-on-one,T1205,defense-evasion,file,malicious,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
	</rule>

	<!-- Notice -->
	<!-- Fortigate: File reported infected by Outbreak Prevention. -->
	<rule id="111814" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008203$</field>
		<description>Fortigate: File reported infected by Outbreak Prevention.</description>
		<info type="text">
    Description: Outbreak Prevention is a security feature designed to detect and block potential malware outbreaks within a network. When a file is reported as infected by Outbreak Prevention, it indicates that the system has identified a file as malicious or potentially harmful. The detection could be based on heuristic analysis, pattern matching, or behavior-based techniques aimed at preventing the spread of malware.
    </info>
		<group>low,one-on-one,T1205,defense-evasion,file,malicious,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
	</rule>

	<!-- Fortigate: MIME data reported infected by external malware list. -->
	<!-- Impact:
1.Security Risk: The infected MIME data poses a direct security threat, potentially leading to malware infections on the network or compromised systems.
2.Operational Disruption: If not addressed, it could result in data breaches or loss of integrity in network operations.
3.Compliance Issues: Failure to manage and respond to such threats could result in non-compliance with security standards or regulations.
Recommendation:
1.Review Alert Details: Identify the infected MIME data’s specifics, such as file type, source, and destination.
2.Analyze the Threat: Check the external malware list for details on the reported malware and its known impacts.
3.Verify the Affected Data: Inspect the file or data to confirm the presence of malware and assess its potential impact.
4.Check for Spread: Determine if the malware has spread or if other similar threats have been detected.
5.Contain and Mitigate: Quarantine the infected file, block related traffic, and update security measures to prevent further infections. -->
	<rule id="111503" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008214$</field>
		<description>Fortigate: MIME data reported infected by external malware list.</description>
		<group>medium,one-on-one,malware,T1204.002,T1204,execution,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: The alert "MESGID_MIME_MALWARE_LIST_WARNING" was triggered because an email message was identified containing a MIME type (Multipurpose Internet Mail Extensions) that matches a known list of malicious indicators. This typically means that the email includes attachments or content flagged as potentially harmful, such as malware, based on predefined patterns and signatures. This rule is designed to detect and prevent the distribution of malicious files through email, ensuring that potentially dangerous content does not reach the intended recipient.
      </info>
	</rule>

	<rule id="111815" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008215$</field>
		<description>Fortigate: MIME data reported infected by external malware list.</description>
		<group>low,one-on-one,malware,T1204.002,T1204,execution,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: The alert "MESGID_MIME_MALWARE_LIST_WARNING" was triggered because an email message was identified containing a MIME type (Multipurpose Internet Mail Extensions) that matches a known list of malicious indicators. This typically means that the email includes attachments or content flagged as potentially harmful, such as malware, based on predefined patterns and signatures. This rule is designed to detect and prevent the distribution of malicious files through email, ensuring that potentially dangerous content does not reach the intended recipient.
      </info>
	</rule>

	<!-- Fortigate: File reported infected by EMS threat feed. -->
	<rule id="111504" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008216$</field>
		<description>Fortigate: File reported infected by EMS threat feed.</description>
		<info type="text">
      Description: The EMS (Endpoint Management System) has identified a file as infected based on threat intelligence feeds. This means the file has been flagged as containing malicious code or behaving in a way that matches known threat patterns.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,execution,T1204.002,T1204,malicious,</group>
	</rule>

	<!-- Notice -->
	<!-- Fortigate: File reported infected by EMS threat feed. -->
	<rule id="111816" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008217$</field>
		<description>Fortigate: File reported infected by EMS threat feed.</description>
		<info type="text">
      Description: The EMS (Endpoint Management System) has identified a file as infected based on threat intelligence feeds. This means the file has been flagged as containing malicious code or behaving in a way that matches known threat patterns.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>low,one-on-one,execution,T1204.002,T1204,malicious,</group>
	</rule>

	<!-- Fortigate: MIME data reported infected by EMS threat feed. -->
	<!-- Impact:
1.Compromise of Sensitive Data: If the infected MIME data is delivered to or accessed by users, it could result in the compromise of sensitive data.
2.Malware Propagation: The malware could spread to other systems within the organization, potentially leading to widespread infection and disruption.
3.Phishing or Spear Phishing: If the MIME data is part of a phishing email, it could trick users into divulging confidential information or credentials.
4.Business Disruption: Infected files might lead to system outages, data loss, or the need for extensive incident response efforts.
Recommendation:
1.Validate the Alert: Check the hash values, sender details, and subject line of the email to see if they match known malicious indicators.
2.Analyze the Infected MIME Data: If possible, detonate the MIME attachment in a sandbox environment to observe its behavior and understand its payload.
3.Check User Activity: Review the activity of the user who received the infected email to see if they opened it or interacted with the attachment. -->
	<rule id="111505" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008218$</field>
		<description>Fortigate: MIME data reported infected by EMS threat feed.</description>
		<info type="text">
      Description: MIME (Multipurpose Internet Mail Extensions) data refers to a standard used for formatting files attached to emails or sent via other internet protocols. The EMS (Email Security) threat feed has flagged a specific MIME attachment or data as infected, indicating that it contains malware or potentially harmful content.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,soar-alert,file,execution,T1204.002,T1204,malicious,phishing,</group>
	</rule>

	<!-- notice -->
	<rule id="111817" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008219$</field>
		<description>Fortigate: MIME data reported infected by EMS threat feed.</description>
		<info type="text">
      Description: MIME (Multipurpose Internet Mail Extensions) data refers to a standard used for formatting files attached to emails or sent via other internet protocols. The EMS (Email Security) threat feed has flagged a specific MIME attachment or data as infected, indicating that it contains malware or potentially harmful content.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>low,one-on-one,execution,T1204.002,T1204,malicious,phishing,</group>
	</rule>

	<!-- Fortigate: File reported infected by FortiNDR. -->
	<rule id="111506" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008220$</field>
		<description>Fortigate: File reported infected by FortiNDR.</description>
		<info type="text">
      Description: FortiNDR (Fortinet Network Detection and Response) has detected a file within the network that is reported as infected. This detection typically indicates that the file contains malware or other malicious code, which could compromise the security of the network and its assets.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,soar-alert,file,malicious,execution,T1204.002,T1204,malicious,</group>
	</rule>

	<!-- notice -->
	<!-- Fortigate: File reported infected by FortiNDR. -->
	<rule id="111818" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008221$</field>
		<description>Fortigate: File reported infected by FortiNDR.</description>
		<info type="text">
      Description: FortiNDR (Fortinet Network Detection and Response) has detected a file within the network that is reported as infected. This detection typically indicates that the file contains malware or other malicious code, which could compromise the security of the network and its assets.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>low,one-on-one,file,malicious,execution,T1204.002,T1204,malicious,</group>
	</rule>

	<!-- Fortigate: MIME data reported infected by FortiNDR. -->
	<rule id="111687" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008222$</field>
		<description>Fortigate: MIME data reported infected by FortiNDR.</description>
		<info type="text">
      Description: FortiNDR (Fortinet Network Detection and Response) has detected MIME (Multipurpose Internet Mail Extensions) data that is reported as infected. MIME data is commonly used to format files attached to emails or other internet transmissions. An infection in this context typically indicates that the MIME data contains malicious content, such as malware or a malicious script.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,soar-alert,file,malicious,execution,T1204.002,T1204,phishing,</group>
	</rule>

	<!-- notice -->
	<!-- Fortigate: MIME data reported infected by FortiNDR. -->
	<rule id="111830" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008223$</field>
		<description>Fortigate: MIME data reported infected by FortiNDR.</description>
		<info type="text">
      Description: FortiNDR (Fortinet Network Detection and Response) has detected MIME (Multipurpose Internet Mail Extensions) data that is reported as infected. MIME data is commonly used to format files attached to emails or other internet transmissions. An infection in this context typically indicates that the MIME data contains malicious content, such as malware or a malicious script.
      </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>low,one-on-one,file,malicious,execution,T1204.002,T1204,phishing,</group>
	</rule>


	<!-- warning -->
	<!-- Fortigate: File reported infected by FortiSandbox. -->
	<rule id="111819" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008232$</field>
		<action type="pcre2">(?i)blocked</action>
		<description>Fortigate: File reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: This alert indicates that a file was processed by FortiSandbox, which determined the file to be infected. FortiSandbox is a cloud-based advanced threat protection solution that analyzes files in a sandbox environment to detect zero-day threats, malware, and other malicious activities.
      </info>
		<group>medium,one-on-one,soar-alert,T1204.002,T1204,file,malicious,execution,</group>
	</rule>

	<!-- notice -->
	<rule id="111820" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008233$</field>
		<action type="pcre2">(?i)blocked</action>
		<description>Fortigate: File reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: This alert indicates that a file was processed by FortiSandbox, which determined the file to be infected. FortiSandbox is a cloud-based advanced threat protection solution that analyzes files in a sandbox environment to detect zero-day threats, malware, and other malicious activities.
      </info>
		<group>low,one-on-one,T1204.002,T1204,file,malicious,execution,sidbi,</group>
	</rule>

	<!-- SIDBI -->
	<!-- Fortigate: File reported infected by FortiSandbox. -->
	<rule id="111508" level="1">
		<if_sid>111820,111819</if_sid>
		<description>Fortigate: File reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: This alert indicates that a file was processed by FortiSandbox, which determined the file to be infected. FortiSandbox is a cloud-based advanced threat protection solution that analyzes files in a sandbox environment to detect zero-day threats, malware, and other malicious activities.
      </info>
		<group>low,one-on-one,soar-alert,T1204.002,T1204,file,malicious,execution,sidbi,</group>
	</rule>

	<!-- Fortigate: MIME data reported infected by FortiSandbox. -->
	<rule id="111688" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008234$</field>
		<description>Fortigate: MIME data reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,soar-alert,T1204.002,T1204,file,malicious,execution,phishing,</group>
		<info type="text">
      Description: MIME (Multipurpose Internet Mail Extensions) data reported as infected by FortiSandbox indicates that an email or file attachment has been flagged as containing malicious content. FortiSandbox is a sandboxing technology that emulates environments to execute and observe potentially malicious files, detecting threats that traditional security measures might miss.
      </info>
	</rule>

	<!-- notice -->
	<!-- Fortigate: MIME data reported infected by FortiSandbox. -->
	<rule id="111821" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008235$</field>
		<description>Fortigate: MIME data reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>low,one-on-one,T1204.002,T1204,file,malicious,execution,phishing,</group>
		<info type="text">
      Description: MIME (Multipurpose Internet Mail Extensions) data reported as infected by FortiSandbox indicates that an email or file attachment has been flagged as containing malicious content. FortiSandbox is a sandboxing technology that emulates environments to execute and observe potentially malicious files, detecting threats that traditional security measures might miss.
      </info>
	</rule>

	<!-- Fortigate: FortiGate unit blocked a file because it contains a virus. -->
	<rule id="111689" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008448$</field>
		<description>Fortigate: FortiGate unit blocked a file because it contains a virus.</description>
		<info type="text">
    Description: The FortiGate unit has detected and blocked a file that contains a known virus. This typically occurs when a user attempts to download or access a file that has been flagged as malicious based on its content, behavior, or signature. The antivirus engine within the FortiGate device identifies the threat and prevents the file from being transmitted or executed, thereby protecting the network from potential harm.
    </info>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,file,block,virus,malicious,T1204,T1204.001,execution,</group>
	</rule>

	<!-- Fortigate: The FortiGate unit has intercepted and blocked a file, identifying a virus embedded in its MIME type. -->
	<rule id="111511" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008450$</field>
		<description>Fortigate: The FortiGate unit has intercepted and blocked a file, identifying a virus embedded in its MIME type.</description>
		<group>low,one-on-one,block,virus,malicious,T1204.001,T1204,execution</group>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: The FortiGate unit has intercepted and blocked a file transmission, identifying a virus embedded within its MIME type. MIME types are used to specify the type of file being transmitted, and in this case, the FortiGate unit has detected that the file contains malicious content, possibly using techniques like pattern recognition or heuristic analysis.
      </info>
	</rule>

	<!-- notice -->
	<!-- Fortigate: The FortiGate unit has intercepted and blocked a file, identifying a virus embedded in its MIME type. -->
	<rule id="111822" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008451$</field>
		<description>Fortigate: The FortiGate unit has intercepted and blocked a file, identifying a virus embedded in its MIME type.</description>
		<group>low,one-on-one,file,block,virus,malicious,T1204.001,T1204,execution,</group>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
      Description: The FortiGate unit has intercepted and blocked a file transmission, identifying a virus embedded within its MIME type. MIME types are used to specify the type of file being transmitted, and in this case, the FortiGate unit has detected that the file contains malicious content, possibly using techniques like pattern recognition or heuristic analysis.
      </info>
	</rule>

<rule id="111640" level="1">
   <if_sid>111501</if_sid>
   <field name="log_id">030248$</field>
   <description>OAT: Web application firewall blocked application by signature.</description>
   <info type="text">Description: This rule detects instances where malicious content has been identified through MIME type analysis during file transfer or communication. The malicious content was automatically intercepted and blocked, preventing potential infection or compromise.</info>
   <mitre>
       <id>T1027</id>
       <id>T1027.009</id>
       <id>T1204</id>
       <id>T1204.002</id>
   </mitre>
   <group>info,one-on-one,s-a,T1027,T1027.009,T1204,T1204.002,malware,anti-virus,file,defense,detection,success</group>
</rule>

	<!-- Fortigate: FortiGate unit blocked a virus command. -->
	<rule id="111512" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008452$</field>
		<description>Fortigate: FortiGate unit blocked a virus command.</description>
		<group>low,one-on-one,block,virus,command-line,T1562.001,T1562,defense-evasion</group>
		<mitre>
			<id>T1562.001</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has detected and blocked a command associated with a known virus. This type of command is typically part of a malware's attempt to communicate with a command and control (C2) server or execute a malicious payload on the compromised system.
    </info>
	</rule>

	<!-- Fortigate: Defined file size limit was exceded. -->
	<rule id="111513" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008704$</field>
		<description>Fortigate: Defined file size limit was exceeded.</description>
		<group>low,one-on-one,T1030,exfiltration,file,</group>
		<mitre>
			<id>T1030</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert because a file being transferred or processed has exceeded the predefined file size limit set by the security policies. This limit is typically enforced to prevent large files, which might be difficult to scan thoroughly, from bypassing security controls or impacting network performance.
    </info>
	</rule>

	<!-- notice -->
	<!-- Fortigate: Defined file size limit was exceded. -->
	<rule id="111831" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008705$</field>
		<description>Fortigate: Defined file size limit was exceeded.</description>
		<group>low,one-on-one,T1030,exfiltration,file,</group>
		<mitre>
			<id>T1030</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert because a file being transferred or processed has exceeded the predefined file size limit set by the security policies. This limit is typically enforced to prevent large files, which might be difficult to scan thoroughly, from bypassing security controls or impacting network performance.
    </info>
	</rule>

	<!-- Fortigate: Stream-based uncompression reached size limit. -->
	<rule id="111514" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008708$</field>
		<description>Fortigate: Stream-based uncompression reached size limit.</description>
		<group>low,one-on-one,T1030,exfiltration,file,</group>
		<mitre>
			<id>T1030</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has triggered an alert indicating that stream-based uncompression has reached the predefined size limit. This typically occurs when a compressed file or data stream is being decompressed, and the resulting uncompressed size exceeds the configured threshold. This limit is often set to prevent resource exhaustion or to avoid processing excessively large files that could pose a risk.
    </info>
	</rule>

	<!-- notice -->
	<!-- Fortigate: Stream-based uncompression reached size limit. -->
	<rule id="111823" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008709$</field>
		<description>Fortigate: Stream-based uncompression reached size limit.</description>
		<group>low,one-on-one,T1030,exfiltration,file,</group>
		<mitre>
			<id>T1030</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has triggered an alert indicating that stream-based uncompression has reached the predefined size limit. This typically occurs when a compressed file or data stream is being decompressed, and the resulting uncompressed size exceeds the configured threshold. This limit is often set to prevent resource exhaustion or to avoid processing excessively large files that could pose a risk.
    </info>
	</rule>

	<!-- Fortigate: Switching protocols request. -->
	<rule id="111515" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008720$</field>
		<description>Fortigate: Switching protocols request.</description>
		<group>low,one-on-one,T1071.001,T1071,command-and-control,protocol,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert indicating a "Switching Protocols" request. This occurs when a client requests to switch from one communication protocol to another, typically during an HTTP connection (e.g., upgrading from HTTP to WebSocket). This is a legitimate function but can sometimes be exploited by attackers to bypass security controls or initiate more covert communication channels.
    </info>
	</rule>

	<!-- notice -->
	<!-- Fortigate: Switching protocols request. -->
	<rule id="111824" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008721$</field>
		<description>Fortigate: Switching protocols request.</description>
		<group>low,one-on-one,T1071.001,T1071,command-and-control,protocol,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert indicating a "Switching Protocols" request. This occurs when a client requests to switch from one communication protocol to another, typically during an HTTP connection (e.g., upgrading from HTTP to WebSocket). This is a legitimate function but can sometimes be exploited by attackers to bypass security controls or initiate more covert communication channels.
    </info>
	</rule>

	<!--Fortigate: File reported infected by FortiSandbox.(notice)-->
	<rule id="111516" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">009235$</field>
		<description>Fortigate: File reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert because a file was flagged as infected by FortiSandbox, a tool used to analyze and detect advanced threats. This indicates that the file was subjected to sandboxing, where it was executed in a controlled environment, and was found to contain malicious content, such as malware or a virus.
    </info>
		<group>low,one-on-one,soar-alert,T1204.002,T1204,file,malicious,execution,</group>
	</rule>

	
	<!-- notice -->
	<!--Fortigate: File reported infected by FortiSandbox.(notice)-->
	<rule id="111825" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">009237$</field>
		<description>Fortigate: File reported infected by FortiSandbox.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert because a file was flagged as infected by FortiSandbox, a tool used to analyze and detect advanced threats. This indicates that the file was subjected to sandboxing, where it was executed in a controlled environment, and was found to contain malicious content, such as malware or a virus.
    </info>
		<group>low,one-on-one,T1204.002,T1204,file,malicious,execution,</group>
	</rule>

	<!-- 
    Impact: 
    The detection of a data leak is a serious security incident with potentially severe consequences. It can lead to the unauthorized exposure of sensitive information, resulting in financial loss, regulatory penalties, reputational damage, and a breach of trust with customers or stakeholders. The impact depends on the nature and sensitivity of the leaked data, as well as the extent of the breach.
    Recommendation:
    The data leak alert should be escalated immediately for prompt action, followed by a thorough investigation of the breach's scope, including reviewing the data, user, and system activity involved. Containment measures must be implemented to prevent further data exposure, and internal teams should be notified to coordinate a comprehensive response and remediation. Finally, it is essential to strengthen data protection measures to prevent future incidents. -->
	<!-- Fortigate: Data leak detected by specified DLP sensor rule. -->
	<rule id="111517" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">024576$</field>
		<description>Fortigate: Data leak detected by specified DLP sensor rule.</description>
		<mitre>
			<id>TA0010</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has triggered an alert indicating that a potential data leak has been detected by a specified Data Loss Prevention (DLP) sensor rule. This alert means that sensitive information, such as confidential files, personal data, or proprietary information, may have been transmitted outside the organization or accessed in an unauthorized manner, violating predefined security policies.
    </info>
		<group>high,one-on-one,soar-alert,detect,exfiltration,TA0010,</group>
	</rule>

	<!-- Fortigate: Spam Email Notification Detected. -->
	<rule id="111518" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">020480$</field>
		<description>Fortigate: Spam Email Notification Detected.</description>
		<group>low,one-on-one,T1586.002,T1586,resource-development,</group>
		<mitre>
			<id>T1586</id>
			<id>T1586.002</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert indicating that a spam email notification has been detected. This typically means that the system has identified and flagged an email as spam based on predefined filtering rules or heuristics. The email may contain unsolicited content, advertisements, phishing attempts, or other unwanted messages designed to deceive or inconvenience the recipient.
    </info>
	</rule>

	<!--Fortigate: Traffic blocked as ICAP server found infection.  -->
	<rule id="111519" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">060001$</field>
		<description>Fortigate: Traffic blocked as ICAP server found infection.</description>
		<mitre>
			<id>T1204</id>
			<id>T1204.002</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has generated an alert indicating that traffic was blocked because the ICAP (Internet Content Adaptation Protocol) server detected an infection within the data being transmitted. ICAP servers are often used to offload tasks such as virus scanning and content filtering. When an infection is detected by the ICAP server, the FortiGate unit blocks the corresponding traffic to prevent the spread of malware or other harmful content within the network.
    </info>
		<group>medium,one-on-one,soar-alert,block,server,T1204.002,T1204,execution,</group>
	</rule>

	<!-- FortiGate: Attack detected by ICMP signature. -->
	<rule id="111521" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">016385$</field>
		<description>FortiGate: Attack detected by ICMP signature.</description>
		<info type="text">
      Description: This rule triggers when FortiGate identifies an attack pattern based on ICMP traffic signatures. The detection is based on known attack signatures associated with ICMP traffic, indicating a possible network scanning or reconnaissance activity. The rule helps in identifying potential network threats or malicious activity leveraging ICMP packets.
    </info>
		<group>low,one-on-one,ips,icmp,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111522" level="1">
		<if_sid>111521</if_sid>
		<field name="direction" type="pcre2">(?i)^incoming$|^0$</field>
		<description>FortiGate: An incoming attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when FortiGate detects an incoming attack based on an ICMP signature. The detection indicates that the ICMP traffic matches known attack patterns, suggesting potential reconnaissance or network scanning attempts. This rule helps in identifying and mitigating threats that use ICMP packets to probe or exploit network vulnerabilities.
    </info>
		<group>low,one-on-one,inbound,ips,icmp,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!--action: detected   direction: incoming  -->
	<rule id="111523" level="1">
		<if_sid>111522</if_sid>
		<action type="pcre2">^detected$</action>
		<description>FortiGate: An incoming attack detected by ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when FortiGate detects an incoming attack based on an ICMP signature. The detection indicates that the ICMP traffic matches known attack patterns, suggesting potential reconnaissance or network scanning attempts. This rule helps in identifying and mitigating threats that use ICMP packets to probe or exploit network vulnerabilities.
    </info>
		<group>low,one-on-one,ips,icmp,detect,malicious,violation,inbound,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<rule id="111526" level="1">
		<if_sid>111523</if_sid>
		<field name="severity">^medium$</field>
		<description>FortiGate: An incoming attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an incoming attack is identified by an ICMP signature on the FortiGate firewall. The rule detects patterns of malicious ICMP traffic, often used in network reconnaissance or scanning activities, indicating a potential threat to the network.
    </info>
		<group>medium,one-on-one,soar-alert,inbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111527" level="1">
		<if_sid>111523</if_sid>
		<field name="severity">^high$</field>
		<description>FortiGate: An incoming attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an incoming attack is identified by an ICMP signature on the FortiGate firewall. The rule detects patterns of malicious ICMP traffic, often used in network reconnaissance or scanning activities, indicating a potential threat to the network.
    </info>
		<group>high,one-on-one,soar-alert,inbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111528" level="1">
		<if_sid>111523</if_sid>
		<field name="severity">^critical$</field>
		<description>FortiGate: An incoming attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an incoming attack is identified by an ICMP signature on the FortiGate firewall. The rule detects patterns of malicious ICMP traffic, often used in network reconnaissance or scanning activities, indicating a potential threat to the network.
    </info>
		<group>critical,one-on-one,soar-alert,inbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!--action: dettected   direction: outgoing  -->
	<rule id="111529" level="1">
		<if_sid>111521</if_sid>
		<field name="direction" type="pcre2">(?i)^outgoing$|^1$</field>
		<description>FortiGate: An outgoing attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when FortiGate detects an outgoing attack based on ICMP traffic signatures. The detection occurs when a known malicious ICMP signature is identified in the outgoing network traffic, indicating that a device within the network might be attempting to conduct reconnaissance or other malicious activity towards external targets. The rule is essential for identifying and preventing outbound threats that could compromise external systems.
    </info>
		<group>low,one-on-one,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111530" level="1">
		<if_sid>111529</if_sid>
		<action type="pcre2">^detected$</action>
		<description>FortiGate: An outgoing attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an outgoing attack is detected by FortiGate based on an ICMP signature. The detection occurs when the system identifies outgoing ICMP traffic that matches known attack patterns, indicating that the internal network may be compromised and is attempting to perform malicious activities externally. The rule helps in identifying and mitigating potential threats originating from within the network.
    </info>
		<group>low,one-on-one,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<rule id="111533" level="1">
		<if_sid>111530</if_sid>
		<field name="severity">^medium$</field>
		<description>FortiGate: An outgoing attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an outgoing attack is detected by FortiGate based on an ICMP signature. The detection occurs when the system identifies outgoing ICMP traffic that matches known attack patterns, indicating that the internal network may be compromised and is attempting to perform malicious activities externally. The rule helps in identifying and mitigating potential threats originating from within the network.
    </info>
		<group>medium,one-on-one,soar-alert,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111534" level="1">
		<if_sid>111530</if_sid>
		<field name="severity">^high$</field>
		<description>FortiGate: An outgoing attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an outgoing attack is detected by FortiGate based on an ICMP signature. The detection occurs when the system identifies outgoing ICMP traffic that matches known attack patterns, indicating that the internal network may be compromised and is attempting to perform malicious activities externally. The rule helps in identifying and mitigating potential threats originating from within the network.
    </info>
		<group>high,one-on-one,soar-alert,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111535" level="1">
		<if_sid>111530</if_sid>
		<field name="severity">^critical$</field>
		<description>FortiGate: An outgoing attack was detected by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggers when an outgoing attack is detected by FortiGate based on an ICMP signature. The detection occurs when the system identifies outgoing ICMP traffic that matches known attack patterns, indicating that the internal network may be compromised and is attempting to perform malicious activities externally. The rule helps in identifying and mitigating potential threats originating from within the network.
    </info>
		<group>critical,one-on-one,soar-alert,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!--action: blocked   direction: incoming  -->
	<rule id="111536" level="1">
		<if_sid>111522</if_sid>
		<action type="pcre2">^dropped$|^blocked$</action>
		<description>FortiGate: An incoming attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule indicates that an incoming ICMP packet was identified as part of a potential attack and was subsequently blocked by the FortiGate firewall. The rule triggered because the ICMP signature matched known attack patterns, suggesting a potential threat attempting to exploit vulnerabilities through ICMP.
    </info>
		<group>low,one-on-one,ips,icmp,block,malicious,violation,inbound,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<rule id="111539" level="1">
		<if_sid>111536</if_sid>
		<field name="severity">^medium$</field>
		<description>FortiGate: An incoming attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule indicates that an incoming ICMP packet was identified as part of a potential attack and was subsequently blocked by the FortiGate firewall. The rule triggered because the ICMP signature matched known attack patterns, suggesting a potential threat attempting to exploit vulnerabilities through ICMP.
    </info>
		<group>medium,one-on-one,inbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111540" level="1">
		<if_sid>111536</if_sid>
		<field name="severity">^high$</field>
		<description>FortiGate: An incoming attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule indicates that an incoming ICMP packet was identified as part of a potential attack and was subsequently blocked by the FortiGate firewall. The rule triggered because the ICMP signature matched known attack patterns, suggesting a potential threat attempting to exploit vulnerabilities through ICMP.</info>
		<group>high,one-on-one,soar-alert,inbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111541" level="1">
		<if_sid>111536</if_sid>
		<field name="severity">^critical$</field>
		<description>FortiGate: An incoming attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule indicates that an incoming ICMP packet was identified as part of a potential attack and was subsequently blocked by the FortiGate firewall. The rule triggered because the ICMP signature matched known attack patterns, suggesting a potential threat attempting to exploit vulnerabilities through ICMP.
    </info>
		<group>critical,one-on-one,soar-alert,inbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!--action: dropped   direction: outgoing  -->
	<rule id="111542" level="1">
		<if_sid>111529</if_sid>
		<action type="pcre2">^dropped$|^blocked$</action>
		<description>FortiGate: An outgoing attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggered because an outgoing ICMP packet from the source IP to the destination IP was identified as malicious by a FortiGate signature. The signature matched a known attack pattern, and the packet was blocked to prevent potential harm or data exfiltration. The rule is designed to monitor and prevent ICMP-based attacks, ensuring the security of the network by blocking suspicious outgoing traffic.
    </info>
		<group>low,one-on-one,outbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111545" level="1">
		<if_sid>111542</if_sid>
		<field name="severity">^medium$</field>
		<description>FortiGate: An outgoing attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggered because an outgoing ICMP packet from the source IP to the destination IP was identified as malicious by a FortiGate signature. The signature matched a known attack pattern, and the packet was blocked to prevent potential harm or data exfiltration. The rule is designed to monitor and prevent ICMP-based attacks, ensuring the security of the network by blocking suspicious outgoing traffic.
    </info>
		<group>medium,one-on-one,outbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111546" level="1">
		<if_sid>111542</if_sid>
		<field name="severity">^high$</field>
		<description>FortiGate: An outgoing attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggered because an outgoing ICMP packet from the source IP to the destination IP was identified as malicious by a FortiGate signature. The signature matched a known attack pattern, and the packet was blocked to prevent potential harm or data exfiltration. The rule is designed to monitor and prevent ICMP-based attacks, ensuring the security of the network by blocking suspicious outgoing traffic.
    </info>
		<group>high,one-on-one,soar-alert,outbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111547" level="1">
		<if_sid>111542</if_sid>
		<field name="severity">^critical$</field>
		<description>FortiGate: An outgoing attack was blocked by an ICMP signature.</description>
		<info type="text">
    Description: This rule triggered because an outgoing ICMP packet from the source IP to the destination IP was identified as malicious by a FortiGate signature. The signature matched a known attack pattern, and the packet was blocked to prevent potential harm or data exfiltration. The rule is designed to monitor and prevent ICMP-based attacks, ensuring the security of the network by blocking suspicious outgoing traffic.
    </info>
		<group>critical,one-on-one,soar-alert,outbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!-- Fortigate: Attack detected by other signature. -->
	<rule id="111548" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">016386$</field>
		<description>Fortigate: Attack detected by other signature.</description>
		<info type="text">
    Description: The "Attack detected by other signature" alert indicates that a potential security threat has been identified by a signature that does not match any specific attack type but is flagged based on a broader set of criteria. This could include unusual network behavior, pattern anomalies, or general threat indicators that don't fit a predefined signature.
    </info>
		<group>medium,one-on-one,s-a,signature,T1204.002,T1204,attack,detect,execution,malicious,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
	</rule>

	<rule id="111549" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">016399$</field>
		<description>Fortigate: Attack detected by a malicious URL.</description>
		<info type="text">
    Description: The alert indicates that an attack was detected involving a malicious URL. This typically occurs when a user attempts to access a website or link that has been identified as malicious. Such URLs can lead to phishing sites, deliver malware, or exploit vulnerabilities in the user's browser or operating system. The alert suggests that an attempt was made to interact with a dangerous site, which could compromise the security of the user's system or the network.
    </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,one-on-one,malicious,attack,detect,T1204.002,T1204,execution,</group>
	</rule>

	<!-- Impact:
1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
Recommendation:
1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns. -->
	<!--Attack detected by botnet notify (notice) -->
	<rule id="111550" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">016401$</field>
		<description>Fortigate: Attack detected by botnet notify.</description>
		<group>low,one-on-one,T1584.005,T1584,resource-development,attack,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
    Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
    </info>
	</rule>

	<rule id="111551" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">061000$</field>
		<description>Fortigate: SSH shell command is blocked.</description>
		<info type="text">
    Description: This rule indicates that an SSH shell command was attempted but was blocked by the FortiGate firewall. The rule was triggered because the command matched a predefined security policy designed to prevent unauthorized or potentially harmful commands from being executed over SSH.
    </info>
		<group>low,one-on-one,ssh,command-line,block,T1021.004,T1021,lateral-movement,</group>
		<mitre>
			<id>T1021.004</id>
			<id>T1021</id>
		</mitre>
	</rule>

	<!-- notice -->
	<rule id="111826" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">061001$</field>
		<description>Fortigate: SSH shell command is blocked.</description>
		<info type="text">
    Description: This rule indicates that an SSH shell command was attempted but was blocked by the FortiGate firewall. The rule was triggered because the command matched a predefined security policy designed to prevent unauthorized or potentially harmful commands from being executed over SSH.
    </info>
		<group>low,one-on-one,ssh,command-line,block,T1021.004,T1021,lateral-movement,</group>
		<mitre>
			<id>T1021.004</id>
			<id>T1021</id>
		</mitre>
	</rule>

	<rule id="111552" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">061002$</field>
		<description>Fortigate: SSH shell command is detected.</description>
		<info type="text">
    Description: This rule is triggered when an SSH shell command is detected, indicating that a user has executed a command via an SSH session. The rule triggers when there is activity that matches predefined patterns associated with SSH command usage, which may indicate unauthorized or suspicious behavior.
    </info>
		<group>low,one-on-one,ssh,command-line,block,T1021.004,T1021,lateral-movement,</group>
		<mitre>
			<id>T1021.004</id>
			<id>T1021</id>
		</mitre>
	</rule>

	
	<!-- notice -->
	<rule id="111827" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">061003$</field>
		<description>Fortigate: SSH shell command is detected.</description>
		<info type="text">
    Description: This rule is triggered when an SSH shell command is detected, indicating that a user has executed a command via an SSH session. The rule triggers when there is activity that matches predefined patterns associated with SSH command usage, which may indicate unauthorized or suspicious behavior.
    </info>
		<group>low,one-on-one,ssh,command-line,block,T1021.004,T1021,lateral-movement,</group>
		<mitre>
			<id>T1021.004</id>
			<id>T1021</id>
		</mitre>
	</rule>

	<rule id="111553" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">012560$</field>
		<description>Fortigate: URL blocked by Websense service.</description>
		<info type="text">
    Description: This rule is triggered when the Websense service on the FortiGate firewall blocks a URL that matches a policy-defined filter. The rule activates due to the detection of web traffic attempting to access restricted or malicious URLs, as defined by the organization's content filtering policies.
    </info>
		<mitre>
			<id>T1102</id>
		</mitre>
		<group>medium,one-on-one,s-a,T1102,command-and-control,services,</group>
	</rule>

	<rule id="111554" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">012561$</field>
		<description>Fortigate: URL blocked with redirect message by Websense service.</description>
		<info type="text">
    Description: This rule detects instances where the Websense service has blocked access to a URL and redirected the user to a message indicating the block. The rule is triggered when a user attempts to access a URL that is categorized as restricted or malicious by the Websense filtering service, resulting in the redirection and display of a block message.
</info>
		<mitre>
			<id>T1102</id>
		</mitre>
		<group>medium,one-on-one,s-a,T1102,command-and-control,services,</group>
	</rule>

	<rule id="111555" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013603$</field>
		<description>Fortigate: Web Command blocked.</description>
		<info type="text">
    Description: This rule triggers when a command is blocked on the FortiGate firewall. It is designed to prevent unauthorized or potentially harmful commands from being executed, ensuring that only permitted commands are allowed. The alert is triggered based on the firewall’s configuration to block specific command types or patterns that could pose a security risk.
    </info>
		<group>low,one-on-one,block,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
	</rule>

	<rule id="111556" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013616$</field>
		<description>Fortigate: Blocked by HTTP header content type.</description>
		<info type="text">
Description: This rule triggers when HTTP traffic is blocked due to the content type specified in the HTTP header. It is designed to prevent potential security threats or misuse by filtering out requests with unauthorized or suspicious content types.
</info>
		<group>low,one-on-one,s-a,block,T1071.001,T1071,protocol,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
	</rule>

	<rule id="111557" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013648$</field>
		<description>Fortigate: Antiphishing matched a URL filter rule without blocking the request.</description>
		<info type="text">
    Description: This rule triggered because the antiphishing mechanism detected a URL that matched a filter rule but did not block the request. This indicates that while the URL was flagged as potentially risky, the configured action for this rule did not include blocking, allowing the request to pass through despite the detection.
</info>
		<group>medium,one-on-one,soar-alert,T1566,initial-access,</group>
		<mitre>
			<id>T1566</id>
		</mitre>
	</rule>

	<rule id="111558" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013649$</field>
		<description>Fortigate: Antiphishing matched a dortiguard category rule without blocking the request.</description>
		<info type="text">
Description: The Fortigate rule is triggered when an antiphishing event matches a Fortiguard category rule, but the request is not blocked. This typically happens when the request is identified as potentially phishing-related based on Fortiguard's category definitions, but it does not meet the criteria for immediate blocking. The rule is designed to detect phishing threats and categorize them, but it may only block requests if they meet specific thresholds or criteria.
</info>
		<group>medium,one-on-one,soar-alert,T1566,initial-access,</group>
		<mitre>
			<id>T1566</id>
		</mitre>
	</rule>

	<rule id="111559" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013650$</field>
		<description>Fortigate: Antiphishing reached default action without blocking the request.</description>
		<info type="text">
Description: The rule triggered because the antiphishing system reached its default action threshold without taking action to block the request. This typically indicates that the request was not identified as a high enough risk to warrant immediate blocking but still required evaluation according to default settings.
</info>
		<group>medium,one-on-one,soar-alert,T1566,initial-access,</group>
		<mitre>
			<id>T1566</id>
		</mitre>
	</rule>

	<rule id="111560" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">028705$</field>
		<action>reject</action>
		<description>Fortigate: Quarantined the application detected.</description>
		<info type="text">
Description: This rule triggers when the FortiGate firewall's Intrusion Prevention System (IPS) identifies and quarantines an application that exhibits behavior or patterns indicative of malicious activity. The rule is designed to prevent potential threats from affecting the network by isolating the application based on predefined signatures or anomalous behavior detected in real-time.
</info>
		<group>medium,one-on-one,soar-alert,application,reject,execution,T1204.002,T1204,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
	</rule>

	<rule id="111599" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">028705$</field>
		<action>pass</action>
		<description>Fortigate: Failed to block application control (IPS).</description>
		<info type="text">
    Description: Application control failed to block a targeted application or protocol, possibly due to a misconfiguration or IPS signature issue.
</info>
		<group>medium,one-on-one,ips,application,allow,T1190,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
	</rule>

	<rule id="111561" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">028706$</field>
		<description>Fortigate: Application control IPS reset.</description>
		<info type="text">
    Description: This rule triggers when an application control or intrusion prevention system (IPS) resets, indicating that the Fortigate device has detected a significant event or change in the application control or IPS settings. This might be due to a configuration change, a software update, or a detected anomaly that necessitated a reset to ensure continued protection.
</info>
		<group>medium,one-on-one,ips,application,allow,T1190,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
	</rule>

	<rule id="111562" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">028721$</field>
		<description>Fortigate: Application control IM (SSH) (block).</description>
		<info type="text">
    Description: This rule triggers when an application control policy blocks an SSH (Secure Shell) connection, indicating that an attempt was made to use SSH for communication, which was blocked according to the policy settings. This rule helps prevent unauthorized or potentially harmful SSH traffic from entering or leaving the network.
</info>
		<group>medium,one-on-one,ips,application,block,ssh,T1190,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
	</rule>

	<rule id="111563" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">028736$</field>
		<description>Fortigate: Application control port enforcement.</description>
		<info type="text">
Description: The rule "Application Control Port Enforcement" in Fortigate is triggered when network traffic attempts to use unauthorized or non-standard ports for specific applications, ensuring compliance with the defined application control policies and preventing potential security threats by enforcing port restrictions.
</info>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<group>medium,one-on-one,command-and-control,application,T1071.001,T1071,</group>
	</rule>

	<rule id="111566" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030255$</field>
		<description>Fortigate: Web application firewall blocked application by address list.</description>
		<group>low,one-on-one,T1190,block,waf,initial-access,application,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info>
Description: A Web Application Firewall (WAF) has blocked an application based on a predefined address list. This means that the WAF detected a request coming from an IP address that matches an address on a blocklist or a denylist, and subsequently, the request was blocked to prevent potential malicious activities.
</info>
	</rule>


	<!-- Impact: The immediate impact of this alert is positive, as it signifies that the WAF successfully blocked a potentially harmful request, thereby protecting the web applicationfrom a security threat. However, it also suggests that an attacker is actively targeting the application, which could be part of a larger campaign or probing activity.
Recommendation: 
1.Verify the Alert: Confirm the alert details, including the time of the incident, the specific signature that triggered the alert, and the source IP address of the traffic.
2.Source IP Analysis: Investigate the source IP address to determine if it is associated with known malicious activity. Use threat intelligence sources to check if the IP has been reported in other attacks.
3.Pattern Analysis: Check if there have been multiple alerts from the same source IP or similar requests targeting the application. This could indicate a targeted attack.
4.Impact Assessment: Determine if the blocked request had any impact on the application’s functionality or if any legitimate traffic was mistakenly blocked. -->

	<rule id="111567" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030250$</field>
		<description>Fortigate: Web application firewall erased application by signature.</description>
		<info type="text">
Description: The FortiGate's Web Application Firewall (WAF) found something in an application that matched a known security threat. To protect the network, it removed or blocked that part of the application.
</info>
		<mitre>
			<id>T1190</id>
		</mitre>
		<group>medium,one-on-one,T1190,waf,initial-access,application,</group>
	</rule>

	<rule id="111568" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030257$</field>
		<description>Fortigate: Web application firewall blocked application by HTTP constraints.</description>
		<group>low,one-on-one,T1562,defense-evasion,waf,block,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info>
Description: A Web Application Firewall (WAF) has blocked a request or series of requests to an application based on HTTP constraints. These constraints are rules defined to prevent malicious activities like SQL injection, cross-site scripting (XSS), and other HTTP-based attacks by inspecting and filtering HTTP traffic.
</info>
	</rule>


	<!-- Impact:
1.False Positives: Legitimate traffic might match a signature pattern, causing unnecessary alerts.
2.Low-Risk Events: The traffic could be recognized as potentially harmful but considered low-risk, leading to logging without blocking.
3.Missed Attacks: Malicious traffic could bypass the waf, potentially leading to a security breach.
Recommendation:
1.Initial Alert Review: Examine the alert details, including the specific signature and the context of the detected traffic.
2.Traffic Analysis: Analyze the traffic in question to determine whether it is legitimate or potentially harmful.
3.Signature Accuracy: Verify the accuracy of the signature to reduce false positives.
4.Historical Context: Check if similar traffic patterns have been detected previously and their outcomes.
5.Further Investigation: If the traffic is suspicious, conduct a deeper investigation into the source and destination, associated IP addresses, and any related alerts. -->
	<rule id="111569" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030249$</field>
		<description>Fortigate: Web application firewall passed application by signature.</description>
		<group>low,one-on-one,T1071.001,T1071,waf,signature,allow,command-and-control</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
Description: Web Application Firewall Passed Application by Signature" alert is triggered when the firewall detects traffic matching a known safe application signature and allows it to pass through.
</info>
	</rule>

	<rule id="111570" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030251$</field>
		<description>Fortigate: Web application firewall blocked application by custom signature.</description>
		<mitre>
			<id>T1071</id>
			<id>T1071.001</id>
		</mitre>
		<info type="text">
Description: A web application firewall (WAF) has blocked an application due to a custom signature. This means that the WAF detected and intercepted a request or traffic pattern matching a predefined custom rule designed to identify potentially malicious activity. Custom signatures are often tailored to detect specific threats or attack patterns that are unique to the application or environment.
</info>
		<group>low,one-on-one,T1071.001,T1071,initial-access,signature,waf,</group>
	</rule>

	<rule id="111571" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030259$</field>
		<description>Fortigate: Web application firewall allowed application by URL access permit.</description>
		<group>low,one-on-one,T1071.001,T1071,waf,allow,URL,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
Description: A Web Application Firewall (WAF) has detected and allowed traffic to an application based on a URL access permit rule. This means that a specific URL has been accessed, and the WAF has permitted the traffic as it matches an allowed pattern or rule set.
</info>
	</rule>

	<rule id="111572" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030258$</field>
		<description>Fortigate: Web application firewall allowed application by HTTP constraints.</description>
		<group>low,one-on-one,T1562,defense-evasion,waf,allow,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info type="text">
Description: A Web Application Firewall (WAF) has detected and allowed an application based on predefined HTTP constraints. This alert indicates that traffic matching certain HTTP criteria, which are typically used to protect against specific types of web attacks, has been permitted through the WAF.
</info>
	</rule>

<!-- if client asks then make tenant specific for this use case -->
	<rule id="111573" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030252$</field>
		<description>Fortigate: Web application firewall allowed application by custom signature.</description>
		<group>low,one-on-one,allow,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
Description: A Web Application Firewall (WAF) has detected and allowed traffic to an application based on a custom signature. Custom signatures are specific rules created to identify and allow or block certain types of web traffic that are not covered by the default rule sets. This could indicate that the application traffic matches a known, approved pattern defined by the organization's security policy.
</info>
	</rule>

	<rule id="111574" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030253$</field>
		<description>Fortigate: Web application firewall blocked application by HTTP method.</description>
		<group>low,one-on-one,block,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
Description: A Web Application Firewall (WAF) blocked an application request due to the use of an HTTP method that is either not allowed or considered potentially harmful. HTTP methods like PUT, DELETE, TRACE, CONNECT, or OPTIONS may be restricted by WAF policies to protect against potential security threats such as unauthorized data modification, deletion, or exposure of sensitive information.
</info>
	</rule>

	<rule id="111575" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">030261$</field>
		<description>Fortigate: Web application firewall blocked application by URL access detected.</description>
		<info type="text">
    Description: This rule indicates that the Fortigate Web Application Firewall (WAF) has blocked access to a specific application due to a URL request that matched a known threat pattern. The rule was triggered because the URL accessed by a user or system was identified as malicious or unauthorized, leading the WAF to block the request to protect the application.
</info>
		<group>medium,one-on-one,soar-alert,block,waf,application,T1190,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
	</rule>

	<!-- AGGREGATION -->
	<!-- Impact:
1.Potential Compromise: The reported file could lead to a security breach if executed or accessed, possibly allowing unauthorized access, data exfiltration, or system damage.
2.Spread of Malware: If the file is indeed part of a larger malware outbreak, it could spread across the network, infecting multiple systems and causing widespread disruption.
3.Business Disruption: Operations may be halted or degraded, affecting productivity and possibly leading to financial losses.
Recommendation:
1.Confirm the Alert: Check the alert details provided by Outbreak Prevention, such as the file name, hash, location, and the detection method (e.g., signature-based, heuristic).
2.Check for False Positives: Cross-reference the file hash with known databases (like VirusTotal) to verify if it’s genuinely malicious or a false positive.
3.Check for Lateral Movement: Investigate other systems in the network to ensure that the malware has not spread. Look for similar alerts or suspicious activity.
4.Use endpoint detection and response (EDR) tools to check for signs of compromise on other devices. -->

	

<rule id="111564" level="1">
	<if_sid>111501</if_sid>
	<field name="log_id">028737$</field>
	<description>Fortigate: Application control protocol enforcement.</description>
	<info type="text">
		Description: This rule is triggered when an application attempts to use a protocol that is either not allowed or violates the specified protocol rules. The detection indicates that the application attempted to communicate using a protocol that is restricted according to the application control settings in Fortigate.
	</info>
	<mitre>
		<id>T1071.001</id>
		<id>T1071</id>
	</mitre>
	<group>medium,one-on-one,command-and-control,application,T1071.001,T1071,protocol,</group>
</rule>


	
	<rule id="111594" level="1">
		<if_sid>111501</if_sid>
		<action type="pcre2">(?i)ssl-login-fail</action>
		<description>Fortigate: SSL VPN login failure.</description>
		<info type="text">
    Description: This rule is triggered when a login attempt to the SSL VPN fails, indicating possible issues with authentication credentials or potential unauthorized access attempts.
</info>
		<mitre>
			<id>T1133</id>
		</mitre>
		<group>medium,one-on-one,T1133,initial-access,ssl,authentication,login,failure,</group>
	</rule>

	<rule id="111596" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013651$</field>
		<description>Fortigate: Antiphishing matched a URL filter rule and blocked the request.</description>
		<info type="text">
    Description: The "Antiphishing matched a URL filter rule and blocked the request" alert means that FortiGate's antiphishing feature detected a potentially harmful website based on predefined URL filtering rules. As a result, it blocked access to the site to protect users from phishing attacks.
    </info>
		<mitre>
			<id>T1566</id>
		</mitre>
		<group>medium,one-on-one,soar-alert,T1566,initial-access,block,</group>
	</rule>

	<rule id="111597" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013652$</field>
		<description>Fortigate: Antiphishing matched a Fortiguard category rule and blocked the request.</description>
		<info type="text">
    Description: The FortiGate's Antiphishing feature detected a request that matched a known phishing category as defined by FortiGuard. To protect users, it blocked the request to prevent access to a potentially harmful website.
    </info>
		<group>medium,one-on-one,soar-alert,T1566,initial-access,block,</group>
		<mitre>
			<id>T1566</id>
		</mitre>
	</rule>

	<rule id="111598" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">013653$</field>
		<description>Fortigate: Antiphishing reached default action and blocked the request.</description>
		<info type="text">
    Description: The "Antiphishing reached default action and blocked the request" alert means that the FortiGate's antiphishing feature detected a potential phishing attempt. Since the request matched phishing criteria and no specific rule was set for this scenario, the firewall automatically blocked the request to prevent any malicious activity.
    </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
			<id>T1566</id>
		</mitre>
		<group>medium,one-on-one,s-a,T1566,execution,block,T1204,T1204.002,execution,</group>
	</rule>

	<!-- Attack detected by UDP/TCP signature. -->
	<rule id="111600" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">016384$</field>
		<description>Fortigate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
    Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
    </info>
		<group>medium,one-on-one,signature,ips,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	
<!-- Attack detected by UDP/TCP signature. -->
<rule id="111837" level="1">
   <if_sid>111600</if_sid>
   <field name="attack" type="pcre2">(?i).*\.Scanner</field>
   <description>Fortigate: External reconnaissance scanning tool activity identified.</description>
   <info type="text">Description: This rule detects scanning activities across network protocols that match known malicious signatures. Such scanning behavior often indicates reconnaissance attempts to identify vulnerable services or open ports.</info>
   <mitre>
       <id>T1046</id>
       <id>T1595</id>
       <id>T1595.001</id>
   </mitre>
   <group>medium,one-on-one,s-a,T1046,T1595,T1595.001,network-scan,port-scan,discovery,reconnaissance,network,detection</group>
</rule>

<!-- Attack detected by UDP/TCP signature. -->
<rule id="111838" level="1">
   <if_sid>111837</if_sid>
   <field name="attack" type="pcre2">ZGrab\.Scanner</field>
   <description>Fortigate: ZGrab scanning tool activity identified.</description>
   <info type="text">Description: This rule detects scanning activity from known internet-wide scanning infrastructure. Such scanning patterns often indicate large-scale reconnaissance attempts to identify and enumerate network services and potential vulnerabilities.</info>
   <mitre>
       <id>T1046</id>
       <id>T1595</id>
       <id>T1595.001</id>
       <id>T1595.002</id>
   </mitre>
   <group>medium,one-on-one,s-a,T1046,T1595,T1595.001,T1595.002,network-scan,port-scan,discovery,reconnaissance,network,detection</group>
</rule>

<!-- Fortigate: File reported infected by EMS threat feed. -->
<rule id="111809" level="1">
   <if_sid>111600</if_sid>
   <field name="attack">(?i)shell.*.command\.execution</field>
   <description>Fortigate: Command interpreter execution pattern observed.</description>
   <info type="text">Description: This rule detects patterns associated with command shell usage and execution. Shell command execution may indicate attempts to execute system commands or scripts, which could be part of normal operations or potentially suspicious activities.</info>
   <mitre>
       <id>T1059</id>
       <id>T1059.003</id>
       <id>T1059.004</id>
       <id>T1106</id>
   </mitre>
   <group>info,one-on-one,s-a,T1059,T1059.003,T1059.004,T1106,execution,shell,command-line,process,detection</group>
</rule>

	<!-- Fortigate: File reported infected by EMS threat feed. -->
<rule id="111808" level="1">
   <if_sid>111600</if_sid>
   <field name="attack">(?i).*Path\.Traversal.*</field>
   <description>Fortigate: Directory traversal exploitation attempt identified.</description>
   <info type="text">Description: This rule detects attempts to exploit path traversal vulnerabilities that could allow attackers to access files or directories outside the intended path. Such attempts often indicate reconnaissance or attempts to access sensitive system files.</info>
   <mitre>
       <id>T1083</id>
       <id>T1083.001</id>
       <id>T1505</id>
       <id>T1505.003</id>
   </mitre>
   <group>low,one-on-one,s-a,T1083,T1083.001,discovery,T1505,T1505.003,web,attack,exploitation,file-system,directory-traversal,detection</group>
</rule>

	<!-- outgoing -->
	<rule id="111601" level="1">
		<if_sid>111600</if_sid>
		<field name="direction" type="pcre2">(?i)^Outgoing$|^1$</field>
		<action type="pcre2">(?)detected</action>
		<description>Fortigate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>low,one-on-one,signature,outbound,allow,ips,malicious,detect,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<!-- severity -->

	<rule id="111602" level="1">
		<if_sid>111601</if_sid>
		<field name="severity" type="pcre2">(?i)^medium$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>medium,one-on-one,outbound,signature,allow,ips,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111603" level="1">
		<if_sid>111601</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>high,one-on-one,soar-alert,outbound,signature,allow,ips,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111604" level="1">
		<if_sid>111601</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>critical,one-on-one,soar-alert,outbound,signature,allow,ips,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!-- incoming -->
	<rule id="111605" level="1">
		<if_sid>111600</if_sid>
		<field name="direction" type="pcre2">(?i)^Incoming$|^0$</field>
		<action>detected</action>
		<description>Fortigate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>low,one-on-one,signature,inbound,ips,malicious,allow,detect,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!-- severity -->

	<rule id="111606" level="1">
		<if_sid>111605</if_sid>
		<field name="severity" type="pcre2">(?i)^medium$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>medium,one-on-one,inbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111607" level="1">
		<if_sid>111605</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>high,one-on-one,soar-alert,inbound,signature,ips,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111608" level="1">
		<if_sid>111605</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<group>critical,one-on-one,soar-alert,inbound,signature,ips,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

<!-- warning -->
	<!-- Attack detected by UDP/TCP/ICMP anomaly. -->
	<rule id="111609" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">018432$</field>
		<description>FortiGate: Attack detected by UDP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>low,one-on-one,network,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

<!-- notice -->
	<!-- Attack detected by UDP/TCP/ICMP anomaly. -->
	<rule id="111828" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">018433$</field>
		<description>FortiGate: Attack detected by UDP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>low,one-on-one,network,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!-- outgoing -->
	<rule id="111610" level="1">
		<if_sid>111609,111828</if_sid>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<action>detected</action>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>low,one-on-one,outbound,signature,malicious,allow,detect,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!-- severity -->
	

	<rule id="111611" level="1">
		<if_sid>111610</if_sid>
		<field name="severity" type="pcre2">(?i)^medium$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>medium,one-on-one,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111612" level="1">
		<if_sid>111610</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>high,one-on-one,soar-alert,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111613" level="1">
		<if_sid>111610</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>critical,one-on-one,soar-alert,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<!-- incoming -->
	<rule id="111614" level="1">
		<if_sid>111609</if_sid>
		<field name="src_ip" type="pcre2">(?i)\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<action>detected</action>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>low,one-on-one,signature,detect,allow,malicious,inbound,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111615" level="1">
		<if_sid>111614</if_sid>
		<field name="severity" type="pcre2">(?i)^medium$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>medium,one-on-one,inbound,signature,allow,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111616" level="1">
		<if_sid>111614</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>high,one-on-one,soar-alert,inbound,signature,allow,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111617" level="1">
		<if_sid>111614</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<group>critical,one-on-one,soar-alert,inbound,signature,allow,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111619" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">018434$</field>
		<description>Fortigate: Attack detected by other anomaly.</description>
		<info type="text">
Description: This alert means that FortiGate has detected unusual activity that doesn't fit normal patterns. It flagged this as an anomaly because it might be a sign of an attack or something suspicious happening on the network.
</info>
		<group>medium,one-on-one,soar-alert,inbound,signature,allow,malicious,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111621" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">054400$</field>
		<description>Fortigate: Domain blocked because it is in the domain-filter list.</description>
		<info type="text">
Description: This alert indicates that access to a specific domain was blocked by FortiGate because the domain is listed in the domain-filter list. This list contains domains that are restricted due to security policies, preventing users from accessing potentially harmful or unwanted websites.
</info>
		<group>medium,one-on-one,block,T1584.001,T1584,resource-development,</group>
		<mitre>
			<id>T1584.001</id>
			<id>T1584</id>
		</mitre>
	</rule>

	<rule id="111622" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">054401$</field>
		<description>Fortigate: Domain allowed because it is in the domain-filter list.</description>
		<info type="text">
Description: This alert indicates that a domain was allowed access because it is included in a predefined domain-filter list. The FortiGate firewall checked the domain against this list and permitted the connection based on the list's rules, even if the domain might normally be blocked or restricted.
</info>
		<group>medium,one-on-one,allow,T1584.001,T1584,resource-development,</group>
		<mitre>
			<id>T1584.001</id>
			<id>T1584</id>
		</mitre>
	</rule>

	
	<!-- notice -->
	<rule id="111799" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">024577$</field>
		<description>Fortigate: Data leak detected by specified DLP sensor rule.</description>
		<info type="text">
Description: Triggers when a DLP sensor(Data Leak/Loss Prevention) identifies unauthorized transmission of sensitive data, such as PII or confidential documents, outside the organization. Immediate investigation is needed to prevent data breaches.
</info>
		<mitre>
			<id>T1005</id>
		</mitre>
		<group>medium,one-on-one,s-a,T1005,collection,detect,</group>
	</rule>

	<rule id="111624" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">054600$</field>
		<description>Fortigate: Domain blocked by DNS botnet.</description>
		<info type="text">
description: A domain has been blocked because it’s associated with a DNS botnet, which may indicate malicious activity or a potential threat to the network.
</info>
		<mitre>
			<id>T1071.004</id>
			<id>T1071</id>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<group>medium,one-on-one,T1071.004,T1071,command-and-control,T1584.005,T1584,resource-development,block,</group>
	</rule>

	
	<!-- notice -->
	<rule id="111829" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">054601$</field>
		<description>Fortigate: Domain blocked by DNS botnet.</description>
		<info type="text">
description: A domain has been blocked because it’s associated with a DNS botnet, which may indicate malicious activity or a potential threat to the network.
</info>
		<mitre>
			<id>T1071.004</id>
			<id>T1071</id>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<group>low,one-on-one,T1071.004,T1071,command-and-control,T1584.005,T1584,resource-development,block,</group>
	</rule>

	<!-- <rule id="" level="8"><if_sid>111501</if_sid><field name="log_id">054801$</field><description>Fortigate: FortiGuard rating error occurred.</description><info type="text"></info><mitre><id>T1190</id></mitre><group>T1190,initial-access,one-on-one,</group></rule>
   -->
	<!-- 
<rule id="" level="8"><if_sid>111501</if_sid><field name="log_id">020509$</field><action>blocked|tagged|allow</action><description>FortiGuard error message</description><info type="text"></info><mitre><id></id></mitre><group></group></rule>
   -->
	<rule id="111627" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">054803$</field>
		<description>Fortigate: Domain Blocked by Category Policy.</description>
		<info type="text">
Description: The requested domain falls under a category that is denied according to the current policy settings. Access to this domain has been blocked to prevent unauthorized or inappropriate content from being accessed.
</info>
		<mitre>
			<id>T1498</id>
		</mitre>
		<group>medium,one-on-one,T1498,impact,block,policy,</group>
	</rule>

	<rule id="111628" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">020214$</field>
		<description>Fortigate: Locally Generated Traffic to IoC Location.</description>
		<info type="text">
Description: This rule identifies and alerts on any outbound traffic generated from internal systems that attempts to connect to known Indicators of Compromise (IoC) locations. This may indicate potential compromise or unauthorized activities within the network. Immediate investigation is recommended.
</info>
		<mitre>
			<id>T1016</id>
		</mitre>
		<group>medium,one-on-one,T1016,discovery,</group>
	</rule>

	<rule id="111629" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">022009$</field>
		<description>Fortigate: Antivirus profile not found.</description>
		<info type="text">
Description: This rule triggers when an Antivirus profile is missing or not configured on a security policy. This could lead to unscanned traffic, exposing the network to potential threats. It's essential to ensure that all relevant policies have an Antivirus profile applied to maintain security posture.
</info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>low,one-on-one,T1204.002,T1204,execution,</group>
	</rule>

	<rule id="111630" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">022046$</field>
		<description>Fortigate: Device's authorization privilege changed.</description>
		<info type="text">
    Description: The authorization privileges for a device have been modified. This change could impact the device's access to certain network resources or services, potentially altering its security posture.
    </info>
		<mitre>
			<id>T1556</id>
		</mitre>
		<group>low,one-on-one,T1556,credential-access,authentication,</group>
	</rule>

	<rule id="111631" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">020113$</field>
		<description>Fortigate: IPSA database download failed.</description>
		<info type="text">
    Description: The IPSA database download attempt was unsuccessful. This could be due to connectivity issues, insufficient storage, or permission restrictions. Troubleshoot the cause by checking network status, available storage, and user permissions.
    </info>
		<mitre>
			<id>T1485</id>
		</mitre>
		<group>medium,one-on-one,T1485,impact,download,</group>
	</rule>

	<rule id="111632" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">022806$</field>
		<description>Fortigate: Duplicate license detected.</description>
		<info type="text">
    Description: This alert indicates that a duplicate license key has been identified in the system, suggesting possible non-compliance with licensing terms. Immediate investigation is required to ensure proper license management and avoid potential legal or operational issues.
    </info>
		<mitre>
			<id>T1134</id>
		</mitre>
		<group>medium,one-on-one,s-a,T1134,privilege-escalation,</group>
	</rule>

	<rule id="111634" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032021$</field>
		<description>Fortigate: Admin login disabled.</description>
		<info type="text">
    Description:  This alert is triggered when an administrative account login attempt is disabled, either due to security policies or multiple failed login attempts. This action may indicate a security measure in response to suspicious activity or unauthorized access attempts.
    </info>
		<mitre>
			<id>T1531</id>
		</mitre>
		<group>high,one-on-one,soar-alert,T1531,impact,login,authentication,</group>
	</rule>

	<rule id="111635" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<field name="log_id">062302$</field>
		<description>Fortigate: Re-signed server certificate as untrusted due to security problem.</description>
		<info type="text">
    Description: The server certificate was re-signed but is flagged as untrusted due to potential security vulnerabilities, indicating that the re-signing process may have introduced issues or failed to address existing security concerns.
    </info>
		<mitre>
			<id>T1587.003</id>
			<id>T1587</id>
			<id>T1588.004</id>
			<id>T1588</id>
		</mitre>
		<group>low,one-on-one,T1587.003,T1587,T1588.004,T1588,resource-development,server,</group>
	</rule>

	<rule id="111636" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008193$</field>
		<description>Fortigate: Infected file detected by the FortiGate unit and it passed.</description>
		<info type="text">
    Description: The FortiGate unit detected a file as infected but allowed it to pass through the network. This incident indicates a potential security lapse where a malicious file was not blocked, posing a risk to the network.
    </info>
		<mitre>
			<id>T1190</id>
		</mitre>
		<group>medium,one-on-one,soar-alert,T1190,initial-access,</group>
	</rule>

	<rule id="111637" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008195$</field>
		<action type="pcre2">(?i)passthrough|monitored|analytics</action>
		<description>Fortigate: MIME header infected and passed.</description>
		<info type="text">
    Description:  This alert indicates that an email containing an infected MIME header has bypassed security checks and was delivered to the recipient. This could be indicative of a potential threat that managed to evade detection, requiring further investigation to assess any risk or damage.
    </info>
		<mitre>
			<id>T1071.003</id>
			<id>T1071</id>
		</mitre>
		<group>medium,one-on-one,T1071.003,T1071,command-and-control,</group>
	</rule>

	<rule id="111638" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008200$</field>
		<action type="pcre2">(?i)passthrough|monitored|analytics</action>
		<description>Fortigate: Executable File Detected in email attachment.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert "MESGID_MIME_FILETYPE_EXE_WARNING" indicates that an email containing an executable file (.exe) as an attachment has been flagged by the security system. The MIME type detection mechanism has identified the attachment as an executable file, which may pose a potential security risk. The warning suggests that while the file has not been confirmed as malicious, it warrants further investigation due to the inherent risks associated with executable files.
    </info>
		<group>low,one-on-one,file,T1204.002,T1204,execution,</group>
	</rule>

	<rule id="111639" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008212$</field>
		<action type="pcre2">(?i)passthrough|monitored|analytics</action>
		<description>Fortigate: File reported infected by external malware list.</description>
		<mitre>
			<id>T1204</id>
			<id>T1204.002</id>
		</mitre>
		<info type="text">
Description:  A file has been identified as infected based on an external malware list, indicating a potential threat within the network. Immediate investigation is required to determine the scope of the infection and take appropriate remediation actions.
</info>
		<group>medium,one-on-one,soar-alert,T1204.002,T1204,execution,</group>
	</rule>

	<!--<rule id="" level="8">-->
	<!--   <if_sid>111501</if_sid>-->
	<!--   <field name="log_id">022921$</field>-->
	<!--   <description>Firewall Routing information changed</description>-->
	<!--       <info type="text">-->
	<!--       </info>-->
	<!--</rule>
-->
	<!-- Fortigate: virus found and blocked by Antivirus engine. -->
	<rule id="111682" level="1">
		<if_sid>81638</if_sid>
		<field name="log_id">009240$</field>
		<description>Fortigate: virus found and blocked by Antivirus engine.</description>
		<info type="text">
Description: The antivirus engine detected and successfully blocked a virus, preventing potential harm to the system. No further action is required as the threat has been neutralized.
</info>
		<group>medium,one-on-one,soar-alert,T1204.002,T1204,file,malicious,execution</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
	</rule>

	<!-- master rule -->
	<!-- FortiGate: Local user $(dstuser) added. -->
	<rule id="111649" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032132$</field>
		<description>FortiGate: Local user ($(dstuser)) added.</description>
		<info type="text">
    Description: A new local user account has been added to the system, which could indicate either routine account management or unauthorized access.
    </info>
		<group>medium,one-on-one,success,T1136.001,T1136,persistence,</group>
		<mitre>
			<id>T1136.001</id>
			<id>T1136</id>
		</mitre>
	</rule>

	<!-- FortiGate: Multiple local user has been added from same source address. -->
	

	<!-- FortiGate: The user $(dstuser) has been changed. -->
	<rule id="111651" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032130$</field>
		<description>FortiGate: The user ($(dstuser)) has been changed.</description>
		<info type="text">
    Description: The user account has been modified. This change could indicate an administrative action, or it might be a sign of unauthorized access. Further investigation is recommended to determine the context and legitimacy of the change.
    </info>
		<group>low,one-on-one,master,success,change,T1098,persistence,</group>
		<mitre>
			<id>T1098</id>
		</mitre>
	</rule>

	<!-- FortiGate: Multiple user has been changed. -->
	

	<!-- FortiGate: A guest user $(dstuser) has been deleted. -->
	<rule id="111653" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032131$</field>
		<description>FortiGate: A guest user - ($(dstuser)) has been deleted.</description>
		<info type="text">
    Description: A guest user account, identified as has been deleted. This event indicates the removal of a user account from the system, potentially as part of routine maintenance, security protocols, or user management processes. Further investigation may be necessary to determine the context and ensure it aligns with expected activities.
    </info>
		<group>low,one-on-one,master,success,T1531,impact,</group>
		<mitre>
			<id>T1531</id>
		</mitre>
	</rule>

	<!-- FortiGate: Multiple guest users has been deleted.-->
	

	<!-- FortiGate: A guest user $(dstuser) added. -->
	<rule id="111655" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032129$</field>
		<description>FortiGate: A guest user ($(dstuser)) added.</description>
		<info type="text">
    Description: A new guest user, identified as $(dstuser), has been successfully added to the system. This event should be monitored to ensure that the guest account is used in compliance with security policies.
    </info>
		<group>low,one-on-one,master,success,T1136,persistence,</group>
		<mitre>
			<id>T1136</id>
		</mitre>
	</rule>

	<!-- FortiGate: Multiple guest users were added.-->
	

	<!-- sidbi -->
	<!-- FortiGate: Firewall configuration changed.  -->
	<rule id="111662" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032102$</field>
		<!-- <field name="tenant" type="pcre2">(?i)sidbi</field> -->
		<field name="logdesc" type="pcre2">(?i)Configuration changed</field>
		<description>FortiGate: Firewall configuration changed.</description>
		<info type="text">
    Description: "FortiGate firewall configuration changed" indicates modifications in firewall settings, affecting traffic management and security policies.
    Impact: Such changes can alter network connectivity, security posture, and compliance, potentially causing disruptions or vulnerabilities.
    Recommendation: Review, document, and test changes; monitor network traffic; and ensure backups and compliance are maintained.
    </info>
		<group>medium,one-on-one,soar-alert,configuration,change,master,policy,T1562.004,T1562,defense-evasion,kalupur,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
	</rule>

	<!-- sidbi -->
	<rule id="111623" level="1">
		<if_sid>111662</if_sid>
		<field name="tenant" type="pcre2">(?i)sidbi</field>
		<description>FortiGate: Firewall configuration changed.</description>
		<info type="text">
    Description: "FortiGate firewall configuration changed" indicates modifications in firewall settings, affecting traffic management and security policies.
    Impact: Such changes can alter network connectivity, security posture, and compliance, potentially causing disruptions or vulnerabilities.
    Recommendation: Review, document, and test changes; monitor network traffic; and ensure backups and compliance are maintained.
    </info>
		<group>low,one-on-one,soar-alert,configuration,change,master,policy,T1562.004,T1562,defense-evasion,kalupur,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
	</rule>
	

	<!-- not sidbi specific -->
	<!-- Fortigate: Outbound Connection to Critical Ports Detected. -->
	<rule id="111686" level="1">
		<if_sid>111501</if_sid>
		<dstport type="pcre2">^21$|^161$|^389$|^22$|^3389$|^445$</dstport>
		<action type="pcre2">(?i)^accept$</action>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<description>FortiGate: Outbound connection to critical ports detected.</description>
		<info type="text">
    Description: An outbound connection attempt was detected targeting critical ports, which may indicate unauthorized access or a potential data exfiltration attempt. This alert requires immediate investigation to ensure network security and compliance.
    </info>
		<group>medium,one-on-one,T1046,discovery,outbound,allow,connection,</group>
		<mitre>
			<id>T1046</id>
		</mitre>
	</rule>

	<!--sidbi-->
	<!-- Outbound Connection to Critical Ports Detected. -->
	<rule id="111661" level="1">
		<if_sid>111686</if_sid>
		<field name="tenant" type="pcre2">(?i)sidbi</field>
		<field name="src_ip" type="pcre2" negate="yes">172.30.20.131</field>
		<description>FortiGate: Outbound connection to critical ports detected.</description>
		<info type="text">
    Description: An outbound connection attempt was detected targeting critical ports, which may indicate unauthorized access or a potential data exfiltration attempt. This alert requires immediate investigation to ensure network security and compliance.
    </info>
		<group>medium,one-on-one,soar-alert,T1046,discovery,outbound,allow,connection,</group>
		<mitre>
			<id>T1046</id>
		</mitre>
	</rule>

	<!-- SIDBI RULE -->
	<!--sidbi-->
	<!-- Firewall Device rebooted. -->
	<rule id="111659" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id" type="pcre2">032138$</field>
		<description>FortiGate: Firewall device rebooted.</description>
		<info type="text">
    Description: The firewall device has experienced an unexpected reboot, which may impact network security and traffic management. Immediate investigation is recommended to determine the cause and ensure the device is functioning correctly.
    </info>
		<group>low,one-on-one,soar-alert,T1529,impact,kalupur,</group>
		<mitre>
			<id>T1529</id>
		</mitre>
	</rule>

	<!--sidbi-->
	<!-- Firewall Device shutdown. -->
	<rule id="111660" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id" type="pcre2">032200$</field>
		<description>FortiGate: Firewall device shutdown.</description>
		<info type="text">
    Description: The firewall device has unexpectedly shut down, potentially impacting network security and connectivity. Immediate investigation is required to determine the cause and restore normal operations.
    </info>
		<group>low,one-on-one,soar-alert,T1529,impact,</group>
		<mitre>
			<id>T1529</id>
		</mitre>
	</rule>

	<!--sidbi-->
	<!--Firewall configuration deleted. -->
	<rule id="111663" level="1">
		<if_sid>111501</if_sid>
		<field name="logdesc" type="pcre2">(?i)Configuration delete</field>
		<match type="pcre2">(?i)delete</match>
		<description>FortiGate: Firewall configuration deleted.</description>
		<info type="text">
    Description: The firewall configuration has been deleted, which may lead to security vulnerabilities and disruption of network traffic control. Immediate action is required to restore the configuration and prevent unauthorized access or service interruptions.
    </info>
		<group>medium,one-on-one,soar-alert,T1562.004,T1562,defense-evasion,change,policy,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
	</rule>

	<!--sidbi-->
	<!-- Interface status change detected. -->
	<rule id="111664" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">020099$</field>
		<action type="pcre2">(?i)^interface-stat-change$</action>
		<field name="tenant" type="pcre2">(?i)sidbi</field>
		<description>Fortigate: Interface status change detected.</description>
		<info type="text">
    Description: This alert indicates a change in the status of a network interface. The interface may have gone up or down, signaling a possible network issue or a planned configuration change. Immediate investigation is recommended to ensure network stability and connectivity.
    </info>
		<group>low,one-on-one,soar-alert,T1562.004,T1016,defense-evasion,discovery,change,policy,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1016</id>
		</mitre>
	</rule>

	<!--  Admin login successful -->
	<rule id="111507" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032001$</field>
		<description>FortiGate: Admin login successful.</description>
		<info type="text">
    Description: This alert is triggered when an administrator successfully logs into the system, indicating authorized access to administrative functions.
    </info>
		<group>low,one-on-one,login,authentication,successful,defense-evasion,T1078,</group>
		<mitre>
			<id>T1078</id>
		</mitre>
	</rule>

	<!--  Admin login successful -->
	<rule id="111509" level="1">
		<if_sid>111507</if_sid>
		<description>FortiGate: IFFCOADMIN login successful.</description>
		<field name="tenant" type="pcre2">(?i)^IFFCO.*</field>
		<match type="pcre2">(?i)IFFCOADMIN</match>
		<info type="text">
    Description: This alert is triggered when an administrator successfully logs into the system, indicating authorized access to administrative functions.
    </info>
		<group>high,one-on-one,soar-alert,login,authentication,successful,defense-evasion,T1078,IFFCO,</group>
		<mitre>
			<id>T1078</id>
		</mitre>
	</rule>

	<!-- Admin login failed. -->
	<rule id="111665" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032002$</field>
		<description>FortiGate: Admin login failed.</description>
		<info type="text">
    Description: An administrative login attempt has failed, indicating a potential unauthorized access attempt or a user error. This could signify either a malicious activity or an incorrect credential usage by a legitimate user.
    </info>
		<group>low,one-on-one,login,authentication,failure,defense-evasion,T1078,kalupur,</group>
		<mitre>
			<id>T1078</id>
		</mitre>
	</rule>

	<!-- Admin login failed. -->
	<rule id="111510" level="1">
		<if_sid>111665</if_sid>
		<description>FortiGate: Admin login failed.</description>
		<field name="tenant" type="pcre2">(?i)^IFFCO.*</field>
		<match type="pcre2">(?i)IFFCOADMIN</match>
		<info type="text">
    Description: An administrative login attempt has failed, indicating a potential unauthorized access attempt or a user error. This could signify either a malicious activity or an incorrect credential usage by a legitimate user.
    </info>
		<group>high,one-on-one,soar-alert,login,authentication,failure,defense-evasion,T1078,IFFCO,</group>
		<mitre>
			<id>T1078</id>
		</mitre>
	</rule>



	<!-- Windows Worm Activity Detected Logs. -->
	<rule id="111668" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<field name="protocol_number">^17$|^6$</field>
		<dstport type="pcre2">^445$|^139$|^137$|^138$</dstport>
		<!-- <field name="description" type="pcre2">.*(?i)worm.*</field> -->
		<field name="src_ip" type="pcre2">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<field name="tenant" type="pcre2">(?i)sidbi</field>
		<description>FortiGate: Posible worm activity detected.</description>
		<info type="text">
    Description: This alert indicates that potential worm-like behavior has been observed within the network. Worms are self-replicating malware that spread across systems and networks, often causing widespread damage. The detection suggests that the system has identified suspicious activities typical of worm propagation, such as rapid file transfers or unusual network traffic patterns. Immediate investigation is required to confirm the presence of a worm and to mitigate any potential spread.
    </info>
		<mitre>
			<id>T1070.001</id>
			<id>T1070</id>
		</mitre>
		<group>low,one-on-one,s-a,malicious,violation,T1070.001,T1070,defense-evasion,detect,sidbi,malware,</group>
	</rule>

	<!--: Windows Worm Activity Detected Logs. -->
	<!-- <rule id="111684" level="8" timeframe="60" frequency="10"><if_matched_sid>111668</if_matched_sid><description>Fortigate: Possible Windows Worm Activity Detected.</description><same_field>tenant</same_field><same_field>src_ip</same_field><different_field>dst_ip</different_field><mitre><id>T1070.001</id><id>T1070</id></mitre><info type="text">
    Description: This alert indicates that potential worm-like behavior has been observed within the network. Worms are self-replicating malware that spread across systems and networks, often causing widespread damage. The detection suggests that the system has identified suspicious activities typical of worm propagation, such as rapid file transfers or unusual network traffic patterns. Immediate investigation is required to confirm the presence of a worm and to mitigate any potential spread.
    </info><group>aggregation,medium,soar-alert,malicious,violation,T1070.001,T1070,defense-evasion,detect,sidbi,malware,</group></rule>
 -->
	<!-- Fortigate: Botnet traffic detected. -->
	<rule id="111669" level="1">
		<if_sid>111501</if_sid>
		<match type="pcre2">(?i)\bbotnet\b</match>
		<description>Fortigate: Botnet traffic detected.</description>
		<info type="text">
    Description: This alert indicates that network traffic consistent with known botnet activity has been detected. The traffic patterns or signatures match those commonly associated with botnet communications, which could signify compromised devices within the network engaging in malicious activities. Further investigation is required to identify and mitigate affected devices.
    </info>
		<field name="tenant" type="pcre2">(?i)sidbi</field>
		<group>low,one-on-one,soar-alert,resource-development,detect,T1584.005,T1584,match,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
	</rule>

	<!-- Fortigate: Outbound RDP connection successfull. -->
	<rule id="111670" level="1">
		<if_sid>111501</if_sid>
		<dstport type="pcre2">^3389$</dstport>
		<field name="app_group">RDP</field>
		<field name="log_id">000020$</field>
		<description>Fortigate: Outbound RDP connection successfull.</description>
		<info type="text">
    Description: This alert indicates that an outbound Remote Desktop Protocol (RDP) connection was successfully established from the internal network to an external destination. This may signify legitimate remote access or a potential unauthorized access attempt, depending on the context and configuration.
    </info>
		<group>medium,one-on-one,T1133,persistence,remote-access,</group>
		<mitre>
			<id>T1133</id>
		</mitre>
	</rule>

	<!--Fortigate: Traffic events detected. -->
	<rule id="111671" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<field name="log_type" type="pcre2">(?i)traffic</field>
		<description>Fortigate: Traffic events detected.</description>
		<info type="text">
    Description:Traffic events detected include unusual traffic patterns, significant increases in volume, traffic from unexpected sources, attempts to access restricted ports, and anomalous outbound traffic. These events could indicate anomalies, potential DDoS attacks, unauthorized access, or data exfiltration, and warrant further investigation.
    </info>
		<group>low,one-on-one,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
	</rule>

	<!--Fortigate: Blocked Traffic -->
	<rule id="111672" level="1" noalert="1">
		<if_sid>111671</if_sid>
		<action type="pcre2">(?i)block|drop</action>
		<description>Fortigate: Blocked traffic detected.</description>
		<info type="text">
    Description: This alert indicates that traffic has been blocked by a security rule or policy. This could be due to various reasons, such as policy restrictions, threat detection, or protocol anomalies. Further investigation is needed to determine the cause and impact of the blocked traffic.
    </info>
		<group>low,one-on-one,T1498,block,impact,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
	</rule>


	<!-- Fortigate: Allowed Traffic -->
	<rule id="111674" level="1" noalert="1">
		<if_sid>111671</if_sid>
		<action type="pcre2">(?i)accept|allow</action>
		<description>Fortigate: Allowed traffic detected.</description>
		<info type="text">
    Description: This alert indicates that network traffic, which is permitted by the security policy, has been detected. It is essential to ensure that the traffic aligns with the organization's security guidelines and does not indicate any unauthorized or suspicious activity.
    </info>
		<group>low,one-on-one,T1205,allow,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
	</rule>

	<!--Fortigate: Fortigate: External traffic detected. -->
	<rule id="111676" level="1" noalert="1">
		<if_sid>111672,111674</if_sid>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<!-- check for public IP address -->
		<action>accept</action>
		<description>Fortigate: External traffic detected.</description>
		<info type="text">
    Description: This alert indicates that traffic originating from an external source has been identified. It is essential to investigate this traffic to determine if it is legitimate or if it represents a potential security threat, such as unauthorized access attempts or data exfiltration.
    </info>
		<group>low,one-on-one,s-a,T1205,allow,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
	</rule>

	<!--Fortigate: Outbound HTTP/HTTPS connection. -->
	<rule id="111677" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<dstport type="pcre2">^80$|^443$</dstport>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<!-- check for public IP address -->
		<field name="protocol_number">^17$|^6$</field>
		<description>Fortigate: Outbound HTTP/HTTPS connection.</description>
		<info type="text">
    Description: Monitors and manages outgoing network traffic over HTTP or HTTPS protocols. This rule ensures that outbound connections are compliant with security policies, blocking or alerting on unauthorized or potentially harmful requests.
    </info>
		<group>low,one-on-one,T1046,defense-evasion,outbound,connection,</group>
		<mitre>
			<id>T1046</id>
		</mitre>
	</rule>

	<!-- AD : Windows service installation. -->
	<!-- <rule id="104553" level="4"><if_sid>104500</if_sid><field name="win_eventid" type="pcre2">^4697$|^601$</field><description>Windows service installation.</description><info type="text"></info><group>windows,server,active-directory,low,one-on-one,persistence,T1543,T1543.003,service,</group><mitre><id>T1543</id><id>T1543.003</id></mitre></rule>
 -->
	

	<!--Fortigate: Suspected outbound command and control (C2) traffic via UDP port. -->
	<rule id="111679" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<dstport type="pcre2">^6892$|^6893$</dstport>
		<field name="protocol_number">^17$</field>
		<match tye="pcre2">\bDNS\b</match>
		<match type="pcre2">(?i)\bmyexternalip.com\b|\bipecho.net\b|\bip-addr.es\b|\bipinfo.io\b|\bwtfismyip.com\b|\bfreegeoip.net\b|\bcurlmyip.com\b|\bip-api.com\b|\bicanhazip.com\b|\bgeo.query.yahoo.com\b|\bbtc.blockr.io\b</match>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<!-- check for public IP address -->
		<description>Fortigate: Suspected outbound command and control (C2) traffic via UDP port.</description>
		<info type="text">
    Description: Anomalous outbound traffic detected over UDP port, potentially indicative of command and control (C2) communication. This may signify that a compromised system is attempting to communicate with an external C2 server. Further investigation is needed to confirm and address potential security threats.
    </info>
		<group>info,one-on-one,detect,T1095,protocol,outbound,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<!-- Fortigate : DNS Amplification -->
	<rule id="111681" level="1">
		<if_sid>111501</if_sid>
		<dstport type="pcre2">^53$</dstport>
		<field name="app_group">DNS</field>
		<!--<field name="log_id">000013$</field>-->
		<field name="protocol_number">^17$</field>
		<field name="sent_byte" type="pcre2">^(4[0-9]\d{2}|[5-9]\d{3,}|\d{5,})$</field>
		<description>Fortigate : DNS Amplification detected.</description>
		<info type="text">
    Description: An unusually high volume of DNS response traffic has been observed, indicative of a DNS amplification attack. This type of attack exploits the DNS infrastructure to amplify traffic and overwhelm the target system.
    </info>
		<group>low,one-on-one,T1071,T1071.004,match,dns,command-and-control,</group>
		<mitre>
			<id>T1071.004</id>
			<id>T1071</id>
		</mitre>
	</rule>

	<!-- External SCAN TRAFFIC FOUND -->
	<rule id="111683" level="1">
		<if_sid>111501</if_sid>
		<match type="pcre2">(?i)(?=.*\bscan)(?=.*\btraffic).*</match>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<!-- check for public IP address -->
		<description>Fortigate: External scan traffic found.</description>
		<group>medium,one-on-one,s-a,discovery,detect,T1046,match,</group>
		<info>
    Description: This alert indicates that FortiGate has identified traffic originating from an external source that is performing a scan of your network. This type of traffic can be indicative of reconnaissance activities, such as port scanning or vulnerability probing, which might precede an attack.
    </info>
		<mitre>
			<id>T1046</id>
		</mitre>
	</rule>

	<!-- 
2024-09-22T13:33:37+05:30 172.30.10.127 devhost=CUMAPDTSANDBOX01 devid=FSA2KET618000012 logver=25 tzone=19800 tz=IST date=2024-09-22 time=13:33:37 logid=1015000205 type=malware subtype=1 level=alert jobid=7335668986994620568 scanstart=1726992135 scanend=1726992217 srcip=172.30.1.34 srcport=34538 dstip=172.16.150.15 dstport=8081 subtime=1726992132 ftype="xlsx" rsrc="Dynamic Scan" md5=dac8fd8922bf9a11c3894dfed8379a8f sha1=5749ded592c8ed3a87477fcef4adb1576e97331c sha256=3d2bf29f492b62c9028fc62b020b03d5be808450d9a76418ed5622e81b8fc36d jstatus="Done" risk="Low Risk" mname="N/A" mcate="Riskware" fname="reference_id_data/8a096e80-c847-45d0-9652-42c9cb25527c/8a096e80-c_MCA_Report.xlsx" proto=HTTP suser="FG800DTB19800082" stype="Device" clientdev="FG800DTB19800082" clientname="FG800DTB19800082:root" clientvd="root" url="http://172.16.150.15/mca/external/s3filedownload?file=8a096e80-c847-45d0-9652-42c9cb25527c/8a096e80-c_MCA_Report.xlsx"
 
2024-09-22T13:33:37+05:30 172.30.10.127 devhost=CUMAPDTSANDBOX01 devid=FSA2KET618000012 logver=25 tzone=19800 tz=IST date=2024-09-22 time=13:33:37 logid=0106000001 type=event subtype=system level=debug user=system ui=system action=Job details status=success  reason=none letype=7 fname="reference_id_data/8a096e80-c847-45d0-9652-42c9cb25527c/8a096e80-c_MCA_Report.xlsx" jobid=7335668986994620568 sid=7335668986994620568 susr="FG800DTB19800082" stype=Device clientdev=FG800DTB19800082 clientvd=root cip=172.30.1.34 cport=34538 sip=172.16.150.15 sport=8081 service=HTTP url="http://172.16.150.15/mca/external/s3filedownload?file=8a096e80-c847-45d0-9652-42c9cb25527c/8a096e80-c_MCA_Report.xlsx" sizebin=110918 stime=1726992135 etime=1726992217 ftype=xlsx sha256=3d2bf29f492b62c9028fc62b020b03d5be808450d9a76418ed5622e81b8fc36d sha1=5749ded592c8ed3a87477fcef4adb1576e97331c risk="Low Risk" rsrc="Dynamic Scan" mname="N/A" mcate="Riskware" os="WIN10O16V4" vmos="WIN10O16V4" msg="File job(7335668986994620568) results(Low Risk) for checksum(3d2bf29f492b62c9028fc62b020b03d5be808450d9a76418ed5622e81b8fc36d). Scan time is 82(s)." -->

	<!-- Malware events detected. -->
	<rule id="111795" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<field name="log_type" type="pcre2">(?i)^malware$</field>
		<description>Fortigate: Malware events detected.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info></info>
		<group>info,one-on-one,T1204.002,T1204,execution,</group>
	</rule>

	<!-- Event type events detected -->
	<rule id="111796" level="1" noalert="1">
		<if_sid>111501</if_sid>
		<field name="log_type" type="pcre2">(?i)^event$</field>
		<description>Fortigate: Event type events detected.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info></info>
		<group>info,one-on-one,T1204.002,T1204,execution,</group>
	</rule>

	<!-- Forti-Sandbox: Suspcious File Detected in Sandbox -->
	<rule id="111685" level="1">
		<if_sid>111795,111796</if_sid>
		<field name="risk_level" type="pcre2" negate="yes">(?i)\bclean\b</field>
		<field name="risk_level" type="pcre2" negate="yes">(?i)\bcommon document formats\b</field>
		<field name="file_sha256" type="pcre2">.*</field>
		<match type="pcre2" negate="yes">(?i)\bZscaler Switzerland GmbH\b</match>
		<description>Forti-Sandbox: Suspicious file detected.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>high,one-on-one,malicious,sandbox,violation,T1204,T1204.002,execution,detect,sidbi,</group>
	</rule>

	<!-- IFFCO -->
	<!-- LOG_ID_TRAFFIC_START_LOCAL. -->
	<!-- Fortigate: Local traffic session start  -->
	<rule id="111696" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000016$</field>
		<description>Fortigate: Local traffic session start.</description>
		<group>low,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
        Description: The "Local Traffic Session Start" alert in Fortigate is triggered when a device within the network starts a new network session. 
        </info>
	</rule>

	<!-- Impact: The detected activity could be part of a defense evasion technique, posing a risk to network security by allowing malicious traffic to move undetected.
    Recommendation:
    1.Reviewing session details, including source and destination IP addresses and timestamps.
    2.Determining the legitimacy of the activity by checking against known baselines and threat intelligence. -->
	<!-- Fortinet high Attack detected by LOG_ID_TRAFFIC_START_LOCAL
     -->
	<rule id="111697" level="1">
		<if_sid>111696</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Local traffic session start.</description>
		<group>high,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: The "Local Traffic Session Start" alert in Fortigate is triggered when a device within the network starts a new network session.
    </info>
	</rule>

	<!-- Impact: The detected activity could be part of a defense evasion technique, posing a risk to network security by allowing malicious traffic to move undetected.
    Recommendation:
    1.Reviewing session details, including source and destination IP addresses and timestamps.
    2.Determining the legitimacy of the activity by checking against known baselines and threat intelligence. -->

	<!-- Fortinet Critical Attack detected by LOG_ID_TRAFFIC_START_LOCAL -->
	<rule id="111698" level="1">
		<if_sid>111696</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Local traffic session start.</description>
		<group>critical,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: The "Local Traffic Session Start" alert in Fortigate is triggered when a device within the network starts a new network session. 
    </info>
	</rule>

	<!-- 
    Impact:
    1.False Positives: Legitimate traffic might match a signature pattern, causing unnecessary alerts.
    2.Low-Risk Events: The traffic could be recognized as potentially harmful but considered low-risk, leading to logging without blocking.
    3.Missed Attacks: Malicious traffic could bypass the waf, potentially leading to a security breach.
    Recommendation:
    1.Initial Alert Review: Examine the alert details, including the specific signature and the context of the detected traffic.
    2.Traffic Analysis: Analyze the traffic in question to determine whether it is legitimate or potentially harmful.
    3.Signature Accuracy: Verify the accuracy of the signature to reduce false positives.
    4.Historical Context: Check if similar traffic patterns have been detected previously and their outcomes.
    5.Further Investigation: If the traffic is suspicious, conduct a deeper investigation into the source and destination, associated IP addresses, and any related alerts. -->
	<!-- done  111569 -->
	<!-- Fortinet High Attack detected by LOGID_WAF_SIGNATURE_PASS -->
	<rule id="111699" level="1">
		<if_sid>111569</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall passed application by signature.</description>
		<group>high,one-on-one,soar-alert,T1071.001,T1071,waf,signature,allow,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: Web Application Firewall Passed Application by Signature" alert is triggered when the firewall detects traffic matching a known safe application signature and allows it to pass through.
    </info>
	</rule>

	<!-- 
    Impact:
    1.False Positives: Legitimate traffic might match a signature pattern, causing unnecessary alerts.
    2.Low-Risk Events: The traffic could be recognized as potentially harmful but considered low-risk, leading to logging without blocking.
    3.Missed Attacks: Malicious traffic could bypass the waf, potentially leading to a security breach.
    Recommendation:
    1.Initial Alert Review: Examine the alert details, including the specific signature and the context of the detected traffic.
    2.Traffic Analysis: Analyze the traffic in question to determine whether it is legitimate or potentially harmful.
    3.Signature Accuracy: Verify the accuracy of the signature to reduce false positives.
    4.Historical Context: Check if similar traffic patterns have been detected previously and their outcomes.
    5.Further Investigation: If the traffic is suspicious, conduct a deeper investigation into the source and destination, associated IP addresses, and any related alerts.
     -->

	<!-- Fortinet Critical Attack detected by LOGID_WAF_SIGNATURE_PASS -->
	<rule id="111700" level="1">
		<if_sid>111569</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall passed application by signature.</description>
		<group>high,one-on-one,soar-alert,T1071.001,T1071,waf,signature,allow,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: Web Application Firewall Passed Application by Signature" alert is triggered when the firewall detects traffic matching a known safe application signature and allows it to pass through.
    </info>
	</rule>

	<!-- Fortigate: Forward traffic session start. -->
	<rule id="111701" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000015$</field>
		<description>Fortigate: Forward traffic session start.</description>
		<group>low,one-on-one,T1185,collection,</group>
		<mitre>
			<id>T1185</id>
		</mitre>
		<info type="text">
    Description: The "Forward traffic session start" alert in Fortigate is triggered when a new session starts for traffic being forwarded through the firewall. This alert indicates that a packet from a source IP to a destination IP has matched a firewall rule allowing the traffic to pass.
    </info>
	</rule>

	<!-- Impact:
1.Network Monitoring: This alert helps in tracking and analyzing new traffic flows through the firewall.
2.Performance: A high volume of session starts could impact firewall performance and potentially indicate an overload or misconfiguration.
3.Security: Unusual or unexpected session starts could signal potential security issues such as unauthorized access attempts or scanning activities.
Recommendation:
1.Review Alert Details: Examine the source and destination IPs, ports, and protocols involved.
2.Analyze Traffic Patterns: Assess whether the traffic volume and patterns are normal or unusual.
3.Verify IP Addresses: Check if the IP addresses are associated with known threats or are unusual. -->

	<!-- Fortinet high Attack detected by LOG_ID_TRAFFIC_START_FORWARD -->
	<rule id="111702" level="1">
		<if_sid>111701</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Forward traffic session start.</description>
		<group>high,one-on-one,T1185,collection,</group>
		<mitre>
			<id>T1185</id>
		</mitre>
		<info type="text">
      Description: The "Forward traffic session start" alert in Fortigate is triggered when a new session starts for traffic being forwarded through the firewall. This alert indicates that a packet from a source IP to a destination IP has matched a firewall rule allowing the traffic to pass.
   </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOG_ID_TRAFFIC_START_FORWARD -->
	<rule id="111703" level="1">
		<if_sid>111701</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Forward traffic session start.</description>
		<group>critical,one-on-one,local,T1185,collection,</group>
		<mitre>
			<id>T1185</id>
		</mitre>
		<info type="text">
      Description: The "Forward traffic session start" alert in Fortigate is triggered when a new session starts for traffic being forwarded through the firewall. This alert indicates that a packet from a source IP to a destination IP has matched a firewall rule allowing the traffic to pass.
   
			<!-- Impact: 
   1.Network Monitoring: This alert helps in tracking and analyzing new traffic flows through the firewall.
   2.Performance: A high volume of session starts could impact firewall performance and potentially indicate an overload or misconfiguration.
   3.Security: Unusual or unexpected session starts could signal potential security issues such as unauthorized access attempts or scanning activities.
   Recommendation:
   1.Review Alert Details: Examine the source and destination IPs, ports, and protocols involved.
   2.Analyze Traffic Patterns: Assess whether the traffic volume and patterns are normal or unusual.
   3.Verify IP Addresses: Check if the IP addresses are associated with known threats or are unusual. -->
		</info>
	</rule>

	<!-- done 111503 -->
	<!-- Fortinet high Attack detected by MESGID_MIME_MALWARE_LIST_WARNING -->
	<rule id="111704" level="1">
		<if_sid>111503</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: MIME data reported infected by external malware list.</description>
		<group>high,one-on-one,soar-alert,malware,T1204.002,T1204,execution,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
        Description: The alert "MESGID_MIME_MALWARE_LIST_WARNING" was triggered because an email message was identified containing a MIME type (Multipurpose Internet Mail Extensions) that matches a known list of malicious indicators. This typically means that the email includes attachments or content flagged as potentially harmful, such as malware, based on predefined patterns and signatures. This rule is designed to detect and prevent the distribution of malicious files through email, ensuring that potentially dangerous content does not reach the intended recipient.
        Impact:
        1.Security Risk: The infected MIME data poses a direct security threat, potentially leading to malware infections on the network or compromised systems.
        2.Operational Disruption: If not addressed, it could result in data breaches or loss of integrity in network operations.
        3.Compliance Issues: Failure to manage and respond to such threats could result in non-compliance with security standards or regulations.
        Recommendation:
        1.Review Alert Details: Identify the infected MIME data’s specifics, such as file type, source, and destination.
        2.Analyze the Threat: Check the external malware list for details on the reported malware and its known impacts.
        3.Verify the Affected Data: Inspect the file or data to confirm the presence of malware and assess its potential impact.
        4.Check for Spread: Determine if the malware has spread or if other similar threats have been detected.
        5.Contain and Mitigate: Quarantine the infected file, block related traffic, and update security measures to prevent further infections.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by MESGID_MIME_MALWARE_LIST_WARNING -->
	<rule id="111705" level="1">
		<if_sid>111503</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: MIME data reported infected by external malware list.</description>
		<group>critical,one-on-one,soar-alert,malware,T1204.002,T1204,execution,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
        Description: The alert "MESGID_MIME_MALWARE_LIST_WARNING" was triggered because an email message was identified containing a MIME type (Multipurpose Internet Mail Extensions) that matches a known list of malicious indicators. This typically means that the email includes attachments or content flagged as potentially harmful, such as malware, based on predefined patterns and signatures. This rule is designed to detect and prevent the distribution of malicious files through email, ensuring that potentially dangerous content does not reach the intended recipient.
        Impact:
        1.Security Risk: The infected MIME data poses a direct security threat, potentially leading to malware infections on the network or compromised systems.
        2.Operational Disruption: If not addressed, it could result in data breaches or loss of integrity in network operations.
        3.Compliance Issues: Failure to manage and respond to such threats could result in non-compliance with security standards or regulations.
        Recommendation:
        1.Review Alert Details: Identify the infected MIME data’s specifics, such as file type, source, and destination.
        2.Analyze the Threat: Check the external malware list for details on the reported malware and its known impacts.
        3.Verify the Affected Data: Inspect the file or data to confirm the presence of malware and assess its potential impact.
        4.Check for Spread: Determine if the malware has spread or if other similar threats have been detected.
        5.Contain and Mitigate: Quarantine the infected file, block related traffic, and update security measures to prevent further infections.
    </info>
	</rule>

	<!-- done 111550 -->
	<!--Fortinet high Attack detected by Botnet Notify  -->
	<rule id="111706" level="1">
		<if_sid>111550</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Attack detected by botnet notify.</description>
		<group>high,one-on-one,soar-alert,T1584.005,T1584,resource-development,attack,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
        Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
        Impact:
        1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
        2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
        3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
        Recommendation:
        1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
        2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
        3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns.
    </info>
	</rule>

	<!--Fortinet Critical Attack detected by Botnet Notify  -->
	<rule id="111707" level="1">
		<if_sid>111550</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Attack detected by botnet notify.</description>
		<group>critical,one-on-one,soar-alert,T1584.005,T1584,resource-development,attack,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
        Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
        Impact:
        1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
        2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
        3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
        Recommendation:
        1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
        2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
        3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns.
    </info>
	</rule>

	<!--Fortigate: Attack detected by botnet warning.(warning) -->
	<rule id="111708" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">016400$</field>
		<description>Fortigate: Attack detected by botnet warning.</description>
		<group>medium,one-on-one,T1584.005,T1584,resource-development,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
        Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
        Impact:
        1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
        2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
        3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
        Recommendation:
        1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
        2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
        3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns.
    </info>
	</rule>

	<!--Fortinet high Attack detected by Botnet Warning  -->
	<rule id="111709" level="1">
		<if_sid>111708</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Attack detected by botnet warning.</description>
		<group>high,one-on-one,soar-alert,T1584.005,T1584,resource-development,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
        Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
        Impact:
        1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
        2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
        3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
        Recommendation:
        1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
        2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
        3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns.
    </info>
	</rule>

	<!--Fortinet Critical Attack detected by Botnet Warning  -->
	<rule id="111710" level="1">
		<if_sid>111708</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Attack detected by botnet warning.</description>
		<group>critical,one-on-one,soar-alert,T1584.005,T1584,resource-development,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
        Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
        Impact:
        1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
        2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
        3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
        Recommendation:
        1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
        2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
        3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns.
    </info>
	</rule>


	<!-- done 111566-->
	<!-- Fortinet high Attack detected by LOGID_WAF_ADDRESS_LIST_BLOCK -->
	<rule id="111711" level="1">
		<if_sid>111566</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall blocked application by address list.</description>
		<group>high,one-on-one,T1190,block,waf,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info>
      Description: A Web Application Firewall (WAF) has blocked an application based on a predefined address list. This means that the WAF detected a request coming from an IP address that matches an address on a blocklist or a denylist, and subsequently, the request was blocked to prevent potential malicious activities.
    </info>
	</rule>

	<!-- Fortinet critical Attack detected by LOGID_WAF_ADDRESS_LIST_BLOCK -->
	<rule id="111712" level="1">
		<if_sid>111566</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall blocked application by address list.</description>
		<group>critical,one-on-one,T1190,block,waf,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info>
      Description: A Web Application Firewall (WAF) has blocked an application based on a predefined address list. This means that the WAF detected a request coming from an IP address that matches an address on a blocklist or a denylist, and subsequently, the request was blocked to prevent potential malicious activities.
    </info>
	</rule>

	<!-- done 111568-->
	<!-- Fortinet high Attack detected by LOGID_WAF_CONSTRAINTS_BLOCK -->
	<rule id="111713" level="1">
		<if_sid>111568</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall blocked application by HTTP constraints.</description>
		<group>high,one-on-one,T1562,defense-evasion,waf,block,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info>
    Description: A Web Application Firewall (WAF) has blocked a request or series of requests to an application based on HTTP constraints. These constraints are rules defined to prevent malicious activities like SQL injection, cross-site scripting (XSS), and other HTTP-based attacks by inspecting and filtering HTTP traffic.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOGID_WAF_CONSTRAINTS_BLOCK -->
	<rule id="111714" level="1">
		<if_sid>111568</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall blocked application by HTTP constraints.</description>
		<group>critical,one-on-one,T1562,defense-evasion,waf,block,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info>
    Description: A Web Application Firewall (WAF) has blocked a request or series of requests to an application based on HTTP constraints. These constraints are rules defined to prevent malicious activities like SQL injection, cross-site scripting (XSS), and other HTTP-based attacks by inspecting and filtering HTTP traffic.
    </info>
	</rule>

	<!-- done Perent rule id : 111572-->
	<!-- Fortinet high Attack detected by LOGID_WAF_CONSTRAINTS_pass -->
	<rule id="111715" level="1">
		<if_sid>111572</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall allowed application by HTTP constraints.</description>
		<group>high,one-on-one,soar-alert,T1562,defense-evasion,waf,allow,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) has detected and allowed an application based on predefined HTTP constraints. This alert indicates that traffic matching certain HTTP criteria, which are typically used to protect against specific types of web attacks, has been permitted through the WAF.
    </info>
	</rule>

	<!-- Fortinet critical Attack detected by LOGID_WAF_CONSTRAINTS_pass -->
	<rule id="111716" level="1">
		<if_sid>111572</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall allowed application by HTTP constraints.</description>
		<group>critical,one-on-one,soar-alert,T1562,defense-evasion,waf,allow,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) has detected and allowed an application based on predefined HTTP constraints. This alert indicates that traffic matching certain HTTP criteria, which are typically used to protect against specific types of web attacks, has been permitted through the WAF.
    </info>
	</rule>

	<!-- done 111570-->
	<!-- Fortinet high Attack detected by LOGID_WAF_CUSTOM_SIGNATURE_BLOCK -->
	<rule id="111717" level="1">
		<if_sid>111570</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall blocked application by custom signature.</description>
		<mitre>
			<id>T1071</id>
			<id>T1071.001</id>
		</mitre>
		<info type="text">
    Description: A web application firewall (WAF) has blocked an application due to a custom signature. This means that the WAF detected and intercepted a request or traffic pattern matching a predefined custom rule designed to identify potentially malicious activity. Custom signatures are often tailored to detect specific threats or attack patterns that are unique to the application or environment.
    </info>
		<group>high,one-on-one,T1071.001,T1071,initial-access,block,signature,waf,command-and-control,</group>
	</rule>

	<!-- Fortinet critical Attack detected by LOGID_WAF_CUSTOM_SIGNATURE_BLOCK -->
	<rule id="111718" level="1">
		<if_sid>111570</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall blocked application by custom signature.</description>
		<mitre>
			<id>T1071</id>
			<id>T1071.001</id>
		</mitre>
		<info type="text">
      Description: A web application firewall (WAF) has blocked an application due to a custom signature. This means that the WAF detected and intercepted a request or traffic pattern matching a predefined custom rule designed to identify potentially malicious activity. Custom signatures are often tailored to detect specific threats or attack patterns that are unique to the application or environment.
    </info>
		<group>critical,one-on-one,T1071.001,T1071,initial-access,block,signature,waf,command-and-control</group>
	</rule>


<!-- if client asks then make tenant specific for this use case -->
	<!-- done 111573-->
	<!-- Fortinet high Attack detected by LOGID_WAF_CUSTOM_SIGNATURE_PASS -->
	<rule id="111719" level="1">
		<if_sid>111573</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall allowed application by custom signature.</description>
		<group>high,one-on-one,allow,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
      Description: A Web Application Firewall (WAF) has detected and allowed traffic to an application based on a custom signature. Custom signatures are specific rules created to identify and allow or block certain types of web traffic that are not covered by the default rule sets. This could indicate that the application traffic matches a known, approved pattern defined by the organization's security policy.
      Impact: Allowing application traffic based on custom signatures can have both positive and negative impacts.
      1.Positive Impact: If the custom signature is well-defined and accurately identifies legitimate traffic, this can enhance the security by allowing only trusted traffic and blocking potentially malicious requests.
      2.Negative Impact: If the custom signature is not accurately defined or is too permissive, there is a risk that malicious traffic could be allowed through the waf, potentially leading to security breaches, data loss, or other cyber incidents.
      Recommendation :
      1.Verify Custom Signature: Check the accuracy and alignment of the custom signature with security policies.
      2.Analyze Allowed Traffic: Identify and examine the details of the traffic permitted by the signature.
      3.Check for Anomalies: Look for unusual patterns or sources in the allowed traffic.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOGID_WAF_CUSTOM_SIGNATURE_PASS -->
	<rule id="111720" level="1">
		<if_sid>111573</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall allowed application by custom signature.</description>
		<group>critical,one-on-one,allow,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
       Description: A Web Application Firewall (WAF) has detected and allowed traffic to an application based on a custom signature. Custom signatures are specific rules created to identify and allow or block certain types of web traffic that are not covered by the default rule sets. This could indicate that the
      application traffic matches a known, approved pattern defined by the organization's security policy.
      Impact: Allowing application traffic based on custom signatures can have both positive and negative impacts.
      1.Positive Impact: If the custom signature is well-defined and accurately identifies legitimate traffic, this can enhance the security by allowing only trusted traffic and blocking potentially malicious requests.
      2.Negative Impact: If the custom signature is not accurately defined or is too permissive, there is a risk that malicious traffic could be allowed through the waf, potentially leading to security breaches, data loss, or other cyber incidents.
      Recommendation :
      1.Verify Custom Signature: Check the accuracy and alignment of the custom signature with security policies.
      2.Analyze Allowed Traffic: Identify and examine the details of the traffic permitted by the signature.
      3.Check for Anomalies: Look for unusual patterns or sources in the allowed traffic.
    </info>
	</rule>

	<!-- done  111574-->
	<!-- Fortinet high Attack detected by LOGID_WAF_METHOD_BLOCK -->
	<rule id="111721" level="1">
		<if_sid>111574</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall blocked application by HTTP method.</description>
		<group>high,one-on-one,block,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) blocked an application request due to the use of an HTTP method that is either not allowed or considered potentially harmful. HTTP methods like PUT, DELETE, TRACE, CONNECT, or OPTIONS may be restricted by WAF policies to protect against potential security threats such as unauthorized data modification, deletion, or exposure of sensitive information.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOGID_WAF_METHOD_BLOCK -->
	<rule id="111722" level="1">
		<if_sid>111574</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall blocked application by HTTP method.</description>
		<group>critical,one-on-one,block,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) blocked an application request due to the use of an HTTP method that is either not allowed or considered potentially harmful. HTTP methods like PUT, DELETE, TRACE, CONNECT, or OPTIONS may be restricted by WAF policies to protect against potential security threats such as unauthorized data modification, deletion, or exposure of sensitive information.
    </info>
	</rule>

	<!-- Done 111640 -->
	<!-- Fortinet high Attack detected by LOGID_WAF_SIGNATURE_BLOCK -->
	<rule id="111723" level="1">
		<if_sid>111640</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall blocked application by signature.</description>
		<group>high,one-on-one,s-a,T1190,signature,initial-access,block,waf,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
    Description: A web application firewall (WAF) blocked an application request based on a predefined signature. This signature matches known patterns of malicious traffic or vulnerabilities, such as SQL injection, cross-site scripting (XSS), or other attacks targeting web applications.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOGID_WAF_SIGNATURE_BLOCK -->
	<rule id="111724" level="1">
		<if_sid>111640</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall blocked application by signature.</description>
		<group>critical,one-on-one,s-a,T1190,signature,initial-access,block,waf,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text"></info>
    Description: A web application firewall (WAF) blocked an application request based on a predefined signature. This signature matches known patterns of malicious traffic or vulnerabilities, such as SQL injection, cross-site scripting (XSS), or other attacks targeting web applications.
    
	</rule>

	<!-- Impact: The immediate impact of this alert is positive, as it signifies that the WAF successfully blocked a potentially harmful request, thereby protecting the web applicationfrom a security threat. However, it also suggests that an attacker is actively targeting the application, which could be part of a larger campaign or probing activity.
    Recommendation: 
    1.Verify the Alert: Confirm the alert details, including the time of the incident, the specific signature that triggered the alert, and the source IP address of the traffic.
    2.Source IP Analysis: Investigate the source IP address to determine if it is associated with known malicious activity. Use threat intelligence sources to check if the IP has been reported in other attacks.
    3.Pattern Analysis: Check if there have been multiple alerts from the same source IP or similar requests targeting the application. This could indicate a targeted attack.
    4.Impact Assessment: Determine if the blocked request had any impact on the application’s functionality or if any legitimate traffic was mistakenly blocked.
 -->
	<!-- done 111567 -->
	<!-- Fortinet high Attack detected by LOGID_WAF_SIGNATURE_ERASE -->
	<rule id="111725" level="1">
		<if_sid>111567</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall erased application by signature.</description>
		<group>high,one-on-one,s-a,T1190,signature,initial-access,waf,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) detec/ e. WAFs are designed to protect web applications by filtering and monitoring HTTP traffic between a web application and the Internet. The alert indicates that the WAF identified a pattern or signature within the traffic that matches a known attack vector, such as SQL injection, cross-site scripting (XSS), or other web-based threats.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOGID_WAF_SIGNATURE_ERASE -->
	<rule id="111726" level="1">
		<if_sid>111567</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall erased application by signature.</description>
		<group>critical,one-on-one,s-a,T1190,signature,initial-access,waf,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) detected and blocked an application request based on a known malicious signature. WAFs are designed to protect web applications by filtering and monitoring HTTP traffic between a web application and the Internet. The alert indicates that the WAF identified a pattern or signature within the traffic that matches a known attack vector, such as SQL injection, cross-site scripting (XSS), or other web-based threats.
    Impact: The immediate impact of this alert is positive, as it signifies that the WAF successfully blocked a potentially harmful request, thereby protecting the web applicationfrom a security threat. However, it also suggests that an attacker is actively targeting the application, which could be part of a larger campaign or probing activity.
    Recommendation: 
    1.Verify the Alert: Confirm the alert details, including the time of the incident, the specific signature that triggered the alert, and the source IP address of the traffic.
    2.Source IP Analysis: Investigate the source IP address to determine if it is associated with known malicious activity. Use threat intelligence sources to check if the IP has been reported in other attacks.
    3.Pattern Analysis: Check if there have been multiple alerts from the same source IP or similar requests targeting the application. This could indicate a targeted attack.
    4.Impact Assessment: Determine if the blocked request had any impact on the application’s functionality or if any legitimate traffic was mistakenly blocked.
    </info>
	</rule>



<!-- if client asks then make tenant specific for this use case -->
	<!-- done 111571 -->
	<!-- Fortinet high Attack detected by LOGID_WAF_URL_ACCESS_PERMIT -->
	<rule id="111727" level="1">
		<if_sid>111571</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Web application firewall allowed application by URL access permit.</description>
		<group>high,one-on-one,T1071.001,T1071,waf,allow,URL,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) has detected and allowed traffic to an application based on a URL access permit rule. This means that a specific URL has been accessed, and the WAF has permitted the traffic as it matches an allowed pattern or rule set.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by LOGID_WAF_URL_ACCESS_PERMIT -->
	<rule id="111728" level="1">
		<if_sid>111571</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Web application firewall allowed application by URL access permit.</description>
		<group>critical,one-on-one,T1071.001,T1071,waf,allow,URL,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
    Description: A Web Application Firewall (WAF) has detected and allowed traffic to an application based on a URL access permit rule. This means that a specific URL has been accessed, and the WAF has permitted the traffic as it matches an allowed pattern or rule set.
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_BROADCAST -->
	<rule id="111729" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000019$</field>
		<description>Fortigate: Broadcast traffic detected.</description>
		<group>low,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Broadcast traffic is network traffic sent from one device to all devices in a subnet. It is used for functions like ARP requests, DHCP requests, and other network protocols that require communication with multiple devices.
    </info>
	</rule>

	<!-- high -->
	<rule id="111730" level="1">
		<if_sid>111729</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Broadcast traffic detected.</description>
		<group>high,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Broadcast traffic is network traffic sent from one device to all devices in a subnet. It is used for functions like ARP requests, DHCP requests, and other network protocols that require communication with multiple devices.
   Impact:
   1.Network Congestion: Excessive broadcast traffic can consume a significant portion of network bandwidth, leading to network congestion and reduced performance.
   2.Potential Indicator of Malicious Activity: A sudden increase in broadcast traffic might indicate network scanning or an attempt to discover active devices on the network, which can be a precursor to an attack.
   3.Disruption of Network Services: Broadcast storms can overwhelm network devices and cause disruptions in network services.
   Recommendation:
   1.Check Alert Details: Review the details of the alert to understand the source, destination, and nature of the broadcast traffic.
   2.Identify Patterns: Look for patterns such as the frequency of broadcast traffic and specific times when it occurs.
   3.User Activity: Correlate the broadcast traffic with user activity to determine if it is legitimate or malicious.
   4.Malware or Network Scans: Investigate if the broadcast traffic is caused by malware or network scanning tools.
   5.Configuration Issues: Check for any network configuration issues that might be causing excessive broadcast traffic, such as misconfigured DHCP servers or network loops.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111731" level="1">
		<if_sid>111729</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Broadcast traffic detected.</description>
		<group>critical,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
   Description: Broadcast traffic is network traffic sent from one device to all devices in a subnet. It is used for functions like ARP requests, DHCP requests, and other network protocols that require communication with multiple devices.
   Impact:
   1.Network Congestion: Excessive broadcast traffic can consume a significant portion of network bandwidth, leading to network congestion and reduced performance.
   2.Potential Indicator of Malicious Activity: A sudden increase in broadcast traffic might indicate network scanning or an attempt to discover active devices on the network, which can be a precursor to an attack.
   3.Disruption of Network Services: Broadcast storms can overwhelm network devices and cause disruptions in network services.
   Recommendation:
   1.Check Alert Details: Review the details of the alert to understand the source, destination, and nature of the broadcast traffic.
   2.Identify Patterns: Look for patterns such as the frequency of broadcast traffic and specific times when it occurs.
   3.User Activity: Correlate the broadcast traffic with user activity to determine if it is legitimate or malicious.
   4.Malware or Network Scans: Investigate if the broadcast traffic is caused by malware or network scanning tools.
   5.Configuration Issues: Check for any network configuration issues that might be causing excessive broadcast traffic, such as misconfigured DHCP servers or network loops.
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_DENY -->
	<rule id="111732" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000003$</field>
		<description>Fortigate: Traffic violation detected.</description>
		<group>low,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
      Description : A traffic violation is detected when network traffic deviates from established security policies or expected behavior. This could involve unauthorized access attempts, unexpected data transfers, communication with known malicious IPs, or unusual protocol usage.
    </info>
	</rule>

	<!-- high -->
	<rule id="111733" level="1">
		<if_sid>111732</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Traffic violation detected.</description>
		<group>high,one-on-one,soar-alert,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
      Description : A traffic violation is detected when network traffic deviates from established security policies or expected behavior. This could involve unauthorized access attempts, unexpected data transfers, communication with known malicious IPs, or unusual protocol usage.
      Impact :
      1.Data Breach Risk: Potential unauthorized access to sensitive data.
      2.Network Compromise: Increased risk of malware or other cyber threats entering the network.
      3.Operational Disruption: Possible interruptions in normal business operations due to unauthorized network activity.
      4.Reputation Damage: Compromise of customer trust if the violation leads to a publicized data breach.
      Recommendation :
      Initial Alert Review: Examine the alert details including source and destination IP addresses, ports, protocols, and timestamps.
      2.Contextual Analysis: Check if the source IP is within your network or an external entity.
      3.User and Entity Behavior Analytics (UEBA): Review user and device activity to identify any anomalies or patterns that deviate from normal behavior. Check for unusual login times, locations, or access to sensitive data.
      4.Threat Intelligence: Cross-reference with internal threat intelligence to determine if there are any past incidents related to this traffic.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111734" level="1">
		<if_sid>111732</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Traffic violation detected.</description>
		<group>critical,one-on-one,soar-alert,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
      Description : A traffic violation is detected when network traffic deviates from established security policies or expected behavior. This could involve unauthorized access attempts, unexpected data transfers, communication with known malicious IPs, or unusual protocol usage.
      Impact :
      1.Data Breach Risk: Potential unauthorized access to sensitive data.
      2.Network Compromise: Increased risk of malware or other cyber threats entering the network.
      3.Operational Disruption: Possible interruptions in normal business operations due to unauthorized network activity.
      4.Reputation Damage: Compromise of customer trust if the violation leads to a publicized data breach.
      Recommendation :
      Initial Alert Review: Examine the alert details including source and destination IP addresses, ports, protocols, and timestamps.
      2.Contextual Analysis: Check if the source IP is within your network or an external entity.
      3.User and Entity Behavior Analytics (UEBA): Review user and device activity to identify any anomalies or patterns that deviate from normal behavior. Check for unusual login times, locations, or access to sensitive data.
      4.Threat Intelligence: Cross-reference with internal threat intelligence to determine if there are any past incidents related to this traffic.
    </info>
	</rule>

	<!-- review pending -->
	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_EXPLICIT_PROXY -->
	<rule id="111735" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000010$</field>
		<description>Fortigate: Explicit proxy traffic detected.</description>
		<group>low,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Explicit Proxy Traffic Detected indicates that the Fortigate firewall has identified traffic routed through an explicit proxy server. An explicit proxy is a server that intercepts internet traffic, with the client configuration set to use this proxy for web access. This type of traffic is usually deliberate, configured by network administrators for purposes like content filtering, monitoring, or logging.
    </info>
	</rule>

	<!-- high -->
	<rule id="111736" level="1">
		<if_sid>111735</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Explicit proxy traffic detected.</description>
		<group>high,one-on-one,s-a,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Explicit Proxy Traffic Detected indicates that the Fortigate firewall has identified traffic routed through an explicit proxy server. An explicit proxy is a server that intercepts internet traffic, with the client configuration set to use this proxy for web access. This type of traffic is usually deliberate, configured by network administrators for purposes like content filtering, monitoring, or logging.
    Impact:
    1.Potential Bypass of Security Controls: If this traffic is not intended, it may indicate an attempt to bypass security controls, which can be risky.
    2.Data Leakage: Misuse of explicit proxy settings could lead to unauthorized data exfiltration.
    3.Policy Violation: If explicit proxy usage is not sanctioned by company policy, it could indicate a violation that needs addressing.
    Recommendation:
    1.Identify the Source: Check the source IP address and user associated with the explicit proxy traffic. Determine if this user or device is authorized to use an explicit proxy.
    2.Review Proxy Settings: Inspect the network configuration to confirm if the explicit proxy settings are legitimate and approved by the organization.Verify if there are any recent changes in proxy settings that might have triggered this alert.
    Assess the Traffic: Check if the destination URLs or IPs are blacklisted or considered suspicious.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111737" level="1">
		<if_sid>111735</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Explicit proxy traffic detected.</description>
		<group>critical,one-on-one,s-a,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Explicit Proxy Traffic Detected indicates that the Fortigate firewall has identified traffic routed through an explicit proxy server. An explicit proxy is a server that intercepts internet traffic, with the client configuration set to use this proxy for web access. This type of traffic is usually deliberate, configured by network administrators for purposes like content filtering, monitoring, or logging.
    Impact:
    1.Potential Bypass of Security Controls: If this traffic is not intended, it may indicate an attempt to bypass security controls, which can be risky.
    2.Data Leakage: Misuse of explicit proxy settings could lead to unauthorized data exfiltration.
    3.Policy Violation: If explicit proxy usage is not sanctioned by company policy, it could indicate a violation that needs addressing.
    Recommendation:
    1.Identify the Source: Check the source IP address and user associated with the explicit proxy traffic. Determine if this user or device is authorized to use an explicit proxy.
    2.Review Proxy Settings: Inspect the network configuration to confirm if the explicit proxy settings are legitimate and approved by the organization.Verify if there are any recent changes in proxy settings that might have triggered this alert.
    Assess the Traffic: Check if the destination URLs or IPs are blacklisted or considered suspicious.
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_FAIL_CONN -->
	<rule id="111738" level="1" noalert="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000011$</field>
		<description>Fortigate: Failed connection attempts.</description>
		<group>low,one-on-one,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Failed connection attempts occur when a device or user tries to establish a network connection but is unsuccessful. This can happen for various reasons, such as incorrect login credentials, blocked ports, or policy violations. These attempts can be benign, such as users mistyping passwords, or they could indicate malicious activities like brute-force attacks or attempts to access unauthorized resources.
    </info>
	</rule>

	<!-- high -->
	<rule id="111739" level="1">
		<if_sid>111738</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Failed connection attempts.</description>
		<group>high,one-on-one,s-a,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
        Description: Failed connection attempts occur when a device or user tries to establish a network connection but is unsuccessful. This can happen for various reasons, such as incorrect login credentials, blocked ports, or policy violations. These attempts can be benign, such as users mistyping passwords, or they could indicate malicious activities like brute-force attacks or attempts to access unauthorized resources.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111740" level="1">
		<if_sid>111738</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Failed connection attempts.</description>
		<group>critical,one-on-one,s-a,local,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
        Description: Failed connection attempts occur when a device or user tries to establish a network connection but is unsuccessful. This can happen for various reasons, such as incorrect login credentials, blocked ports, or policy violations. These attempts can be benign, such as users mistyping passwords, or they could indicate malicious activities like brute-force attacks or attempts to access unauthorized resources.
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_OTHER_ICMP_DENY -->
	<rule id="111741" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000006$</field>
		<description>Fortigate: Traffic denied ICMP.</description>
		<group>low,one-on-one,local,T1205,defense-evasion,protocol,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description:This alert indicates that ICMP (Internet Control Message Protocol) traffic has been denied by a firewall or security appliance. ICMP is commonly used for diagnostic purposes, such as the "ping" command, which checks the connectivity between devices. Blocking ICMP traffic could be part of a security policy to prevent network scanning or other reconnaissance activities by malicious actors.
    </info>
	</rule>

	<!-- high -->
	<rule id="111742" level="1">
		<if_sid>111741</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Traffic denied ICMP.</description>
		<group>high,one-on-one,s-a,local,T1205,defense-evasion,protocol,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: This alert indicates that ICMP (Internet Control Message Protocol) traffic has been denied by a firewall or security appliance. ICMP is commonly used for diagnostic purposes, such as the "ping" command, which checks the connectivity between devices. Blocking ICMP traffic could be part of a security policy to prevent network scanning or other reconnaissance activities by malicious actors.
   Impact: 
   1.Network Connectivity Issues: If legitimate ICMP traffic is blocked, it may hinder troubleshooting and network diagnostics, leading to difficulties in identifying and resolving connectivity issues.
   2.Security Measure: Blocking ICMP can prevent potential reconnaissance by attackers, such as discovering active hosts or network infrastructure details.
   Recommendation:    
   1.Check Firewall Rules: Review the firewall rules to confirm whether ICMP traffic is intentionally blocked as part of the security policy. Determine if the block is applied to specific IP ranges, subnets, or universally across the network.
   2.Review the Alert Details: Identify the source and destination IP addresses involved in the denied ICMP traffic.Note the specific type of ICMP request (e.g., Echo Request, Echo Reply).
    </info>
	</rule>

	<!-- critical -->
	<rule id="111743" level="1">
		<if_sid>111741</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Traffic denied ICMP.</description>
		<group>critical,one-on-one,s-a,T1205,defense-evasion,protocol,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
      Description: This alert indicates that ICMP (Internet Control Message Protocol) traffic has been denied by a firewall or security appliance. ICMP is commonly used for diagnostic purposes, such as the "ping" command, which checks the connectivity between devices. Blocking ICMP traffic could be part of a security policy to prevent network scanning or other reconnaissance activities by malicious actors.
      Impact: 
      1.Network Connectivity Issues: If legitimate ICMP traffic is blocked, it may hinder troubleshooting and network diagnostics, leading to difficulties in identifying and resolving connectivity issues.
      2.Security Measure: Blocking ICMP can prevent potential reconnaissance by attackers, such as discovering active hosts or network infrastructure details.
      Recommendation:    
      1.Check Firewall Rules: Review the firewall rules to confirm whether ICMP traffic is intentionally blocked as part of the security policy. Determine if the block is applied to specific IP ranges, subnets, or universally across the network.
      2.Review the Alert Details: Identify the source and destination IP addresses involved in the denied ICMP traffic.Note the specific type of ICMP request (e.g., Echo Request, Echo Reply).
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_OTHER_INVALID -->
	<rule id="111744" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000007$</field>
		<description>Fortigate: Traffic other invalid.</description>
		<group>low,one-on-one,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text"></info>
	</rule>

	<!-- high -->
	<rule id="111745" level="1">
		<if_sid>111744</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Traffic other invalid.</description>
		<group>high,one-on-one,s-a,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: The "Traffic Other Invalid" alert typically indicates that traffic was detected on the network that doesn't match any defined rules, protocols, or expected behavior. This could include malformed packets, non-standard protocol usage, or unexpected data patterns. The alert might be triggered by anomalous activities, misconfigured devices, or even potential threats attempting to evade detection.
      Impact:
      1.Potential Security Threat: The traffic could represent a security risk, such as an attempted intrusion, reconnaissance, or exploitation of a vulnerability.
      2.Operational Disruption: If the traffic is due to misconfigurations or network issues, it could disrupt normal operations or degrade network performance.
      3.False Positives: There is a chance that this alert is a false positive due to unusual but benign activity, leading to unnecessary investigations if not properly filtered.
      Recommendation: 
      1.Review the Alert Details: Examine the source and destination IP addresses, ports, and protocols involved.Check the timestamp to correlate the alert with any other suspicious activities.
      2.Cross-Reference with Threat Intelligence: Use threat intelligence feeds or platforms to check if the IP addresses, domains, or behaviors associated with the alert have been flagged as malicious elsewhere.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111746" level="1">
		<if_sid>111744</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Traffic other invalid.</description>
		<group>critical,one-on-one,s-a,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: The "Traffic Other Invalid" alert typically indicates that traffic was detected on the network that doesn't match any defined rules, protocols, or expected behavior. This could include malformed packets, non-standard protocol usage, or unexpected data patterns. The alert might be triggered by anomalous activities, misconfigured devices, or even potential threats attempting to evade detection.
      Impact:
      1.Potential Security Threat: The traffic could represent a security risk, such as an attempted intrusion, reconnaissance, or exploitation of a vulnerability.
      2.Operational Disruption: If the traffic is due to misconfigurations or network issues, it could disrupt normal operations or degrade network performance.
      3.False Positives: There is a chance that this alert is a false positive due to unusual but benign activity, leading to unnecessary investigations if not properly filtered.
      Recommendation: 
      1.Review the Alert Details: Examine the source and destination IP addresses, ports, and protocols involved.Check the timestamp to correlate the alert with any other suspicious activities.
      2.Cross-Reference with Threat Intelligence: Use threat intelligence feeds or platforms to check if the IP addresses, domains, or behaviors associated with the alert have been flagged as malicious elsewhere.
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_STAT -->
	<rule id="111747" level="1" noalert="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000020$</field>
		<description>Fortigate: Forward traffic statistics.</description>
		<group>low,one-on-one,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text"></info>
      Description: This alert triggers when there is an unusually high amount of forward traffic passing through the network firewall. Forward traffic refers to the traffic that is allowed to pass from one network segment to another, typically from an internal network to an external network or vice versa. This alert could indicate either a legitimate increase in traffic due to business activities or a potential security threat such as a Distributed Denial of Service (DDoS) attack, data exfiltration, or other malicious activities.
    
	</rule>

	<!-- high -->
	<rule id="111748" level="1">
		<if_sid>111747</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Forward traffic statistics.</description>
		<group>high,one-on-one,s-a,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
      Description: This alert triggers when there is an unusually high amount of forward traffic passing through the network firewall. Forward traffic refers to the traffic that is allowed to pass from one network segment to another, typically from an internal network to an external network or vice versa. This alert could indicate either a legitimate increase in traffic due to business activities or a potential security threat such as a Distributed Denial of Service (DDoS) attack, data exfiltration, or other malicious activities.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111749" level="1">
		<if_sid>111747</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Forward traffic statistics.</description>
		<group>critical,one-on-one,s-a,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
      Description: This alert triggers when there is an unusually high amount of forward traffic passing through the network firewall. Forward traffic refers to the traffic that is allowed to pass from one network segment to another, typically from an internal network to an external network or vice versa. This alert could indicate either a legitimate increase in traffic due to business activities or a potential security threat such as a Distributed Denial of Service (DDoS) attack, data exfiltration, or other malicious activities.
    </info>
	</rule>

	<!-- Fortinet Attack detected by LOG_ID_TRAFFIC_UTM_CORRELATION -->
	<rule id="111750" level="1">
		<if_sid>111671</if_sid>
		<field name="log_id">000022$</field>
		<description>Fortigate: Forward traffic for UTM correlation.</description>
		<group>low,one-on-one,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Forward Traffic for UTM Correlation involves monitoring and analyzing network traffic that passes through the firewall. UTM (Unified Threat Management) modules inspect this traffic for potential threats, such as malware, intrusions, or other security risks. The correlation process aggregates and evaluates traffic data across multiple UTM features (like Antivirus, IPS, Web Filtering, etc.) to detect patterns that could indicate malicious activity.
    </info>
	</rule>

	<!-- high -->
	<rule id="111751" level="1">
		<if_sid>111750</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Forward traffic for UTM correlation.</description>
		<group>high,one-on-one,s-a,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Forward Traffic for UTM Correlation involves monitoring and analyzing network traffic that passes through the firewall. UTM (Unified Threat Management) modules inspect this traffic for potential threats, such as malware, intrusions, or other security risks. The correlation process aggregates and evaluates traffic data across multiple UTM features (like Antivirus, IPS, Web Filtering, etc.) to detect patterns that could indicate malicious activity.
    </info>
	</rule>

	<!-- critical -->
	<rule id="111752" level="1">
		<if_sid>111750</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Forward traffic for UTM correlation.</description>
		<group>critical,one-on-one,s-a,T1205,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Forward Traffic for UTM Correlation involves monitoring and analyzing network traffic that passes through the firewall. UTM (Unified Threat Management) modules inspect this traffic for potential threats, such as malware, intrusions, or other security risks. The correlation process aggregates and evaluates traffic data across multiple UTM features (like Antivirus, IPS, Web Filtering, etc.) to detect patterns that could indicate malicious activity.
    </info>
	</rule>

	<!-- done 111502-->
	<!-- Fortinet high Attack detected by MESGID_AVQUERY_WARNING -->
	<rule id="111753" level="1">
		<if_sid>111502</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: File reported infected by Outbreak Prevention.</description>
		<group>high,one-on-one,s-a,T1205,defense-evasion,file,malicious,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Outbreak Prevention is a security feature designed to detect and block potential malware outbreaks within a network. When a file is reported as infected by Outbreak Prevention, it indicates that the system has identified a file as malicious or potentially harmful. The detection could be based on heuristic analysis, pattern matching, or behavior-based techniques aimed at preventing the spread of malware.
    Impact:
    1.Potential Compromise: The reported file could lead to a security breach if executed or accessed, possibly allowing unauthorized access, data exfiltration, or system damage.
    2.Spread of Malware: If the file is indeed part of a larger malware outbreak, it could spread across the network, infecting multiple systems and causing widespread disruption.
    3.Business Disruption: Operations may be halted or degraded, affecting productivity and possibly leading to financial losses.
    Recommendation:
    1.Confirm the Alert: Check the alert details provided by Outbreak Prevention, such as the file name, hash, location, and the detection method (e.g., signature-based, heuristic).
    2.Check for False Positives: Cross-reference the file hash with known databases (like VirusTotal) to verify if it’s genuinely malicious or a false positive.
    3.Check for Lateral Movement: Investigate other systems in the network to ensure that the malware has not spread. Look for similar alerts or suspicious activity.
    4.Use endpoint detection and response (EDR) tools to check for signs of compromise on other devices.
    </info>
	</rule>

	<!-- Fortinet critical Attack detected by MESGID_AVQUERY_WARNING -->
	<rule id="111754" level="1">
		<if_sid>111502</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: File reported infected by Outbreak Prevention.</description>
		<group>critical,one-on-one,s-a,T1205,defense-evasion,defense-evasion,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: Outbreak Prevention is a security feature designed to detect and block potential malware outbreaks within a network. When a file is reported as infected by Outbreak Prevention, it indicates that the system has identified a file as malicious or potentially harmful. The detection could be based on heuristic analysis, pattern matching, or behavior-based techniques aimed at preventing the spread of malware.
    Impact:
    1.Potential Compromise: The reported file could lead to a security breach if executed or accessed, possibly allowing unauthorized access, data exfiltration, or system damage.
    2.Spread of Malware: If the file is indeed part of a larger malware outbreak, it could spread across the network, infecting multiple systems and causing widespread disruption.
    3.Business Disruption: Operations may be halted or degraded, affecting productivity and possibly leading to financial losses.
    Recommendation:
    1.Confirm the Alert: Check the alert details provided by Outbreak Prevention, such as the file name, hash, location, and the detection method (e.g., signature-based, heuristic).
    2.Check for False Positives: Cross-reference the file hash with known databases (like VirusTotal) to verify if it’s genuinely malicious or a false positive.
    3.Check for Lateral Movement: Investigate other systems in the network to ensure that the malware has not spread. Look for similar alerts or suspicious activity.
    4.Use endpoint detection and response (EDR) tools to check for signs of compromise on other devices.
    </info>
	</rule>

	<!-- done 111512-->
	<!-- Fortinet high Attack detected by MESGID_BLOCK_COMMAND -->
	<rule id="111755" level="1">
		<if_sid>111512</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: FortiGate unit blocked a virus command.</description>
		<group>high,one-on-one,s-a,block,virus,command-line,T1562.001,T1562,defense-evasion,</group>
		<mitre>
			<id>T1562.001</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has detected and blocked a command associated with a known virus. This type of command is typically part of a malware's attempt to communicate with a command and control (C2) server or execute a malicious payload on the compromised system.
    Impact:
    Blocking this command prevents the virus from executing further malicious activities, such as data exfiltration, spreading to other systems, or receiving instructions from a C2 server. However, the presence of this alert indicates that there may be an infected device on the network, which poses a security risk.
    Recommendation :
    1.Identify the Infected Host: Determine the source IP address and device from which the virus command originated.
    2.Cross-reference this IP with internal asset inventories to identify the specific device and its owner.
    3.Use tools like a sandbox or threat intelligence platforms to further understand the behavior of the malware.
    4.Root Cause Analysis: Investigate how the device was infected. Check for any recent downloads, email attachments, or unauthorized access.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by MESGID_BLOCK_COMMAND -->
	<rule id="111756" level="1">
		<if_sid>111512</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: FortiGate unit blocked a virus command.</description>
		<mitre>
			<id>T1562.001</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
     Description: The FortiGate unit has detected and blocked a command associated with a known virus. This type of command is typically part of a malware's attempt to communicate with a command and control (C2) server or execute a malicious payload on the compromised system.
    Impact:
    Blocking this command prevents the virus from executing further malicious activities, such as data exfiltration, spreading to other systems, or receiving instructions from a C2 server. However, the presence of this alert indicates that there may be an infected device on the network, which poses a security risk.
    Recommendation :
    1.Identify the Infected Host: Determine the source IP address and device from which the virus command originated.
    2.Cross-reference this IP with internal asset inventories to identify the specific device and its owner.
    3.Use tools like a sandbox or threat intelligence platforms to further understand the behavior of the malware.
    4.Root Cause Analysis: Investigate how the device was infected. Check for any recent downloads, email attachments, or unauthorized access.
    </info>
		<group>critical,one-on-one,s-a,block,virus,command-line,T1562.001,T1562,defense-evasion,</group>
	</rule>

	<!-- done 111511-->
	<!-- Fortinet high Attack detected by MESGID_BLOCK_MIME_WARNING -->
	<rule id="111757" level="1">
		<if_sid>111511</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: The FortiGate unit has intercepted and blocked a file, identifying a virus embedded in its MIME type.</description>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The FortiGate unit has detected and blocked a file that contains a known virus. This typically occurs when a user attempts to download or access a file that has been flagged as malicious based on its content, behavior, or signature. The antivirus engine within the FortiGate device identifies the threat and prevents the file from being transmitted or executed, thereby protecting the network from potential harm.
    </info>
		<group>high,one-on-one,s-a,file,block,virus,malicious,T1204.001,T1204,execution,</group>
	</rule>

	<!-- Fortinet Critical Attack detected by MESGID_BLOCK_MIME_WARNING -->
	<rule id="111758" level="1">
		<if_sid>111511</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: The FortiGate unit has intercepted and blocked a file, identifying a virus embedded in its MIME type.</description>
		<group>critical,one-on-one,s-a,file,block,virus,malicious,T1204.001,T1204,execution,</group>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
   Description: The FortiGate unit has intercepted and blocked a file transmission, identifying a virus embedded within its MIME type. MIME types are used to specify the type of file being transmitted, and in this case, the FortiGate unit has detected that the file contains malicious content, possibly using techniques like pattern recognition or heuristic analysis.
    </info>
	</rule>

	<!-- done 111689-->
	<!-- Fortinet high Attack detected by MESGID_BLOCK_WARNING -->
	<rule id="111759" level="1">
		<if_sid>111689</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate:FortiGate unit blocked a file because it contains a virus.</description>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<group>high,one-on-one,s-a,file,block,virus,malicious,T1204.001,T1204,execution,</group>
		<info type="text">
     Description: The FortiGate unit has detected and blocked a file that contains a known virus. This typically occurs when a user attempts to download or access a file that has been flagged as malicious based on its content, behavior, or signature. The antivirus engine within the FortiGate device identifies the threat and prevents the file from being transmitted or executed, thereby protecting the network from potential harm.
    </info>
	</rule>

	<!-- Fortinet Critical Attack detected by MESGID_BLOCK_WARNING -->
	<rule id="111760" level="1">
		<if_sid>111689</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate:FortiGate unit blocked a file because it contains a virus.</description>
		<mitre>
			<id>T1204.001</id>
			<id>T1204</id>
		</mitre>
		<group>critical,one-on-one,s-a,file,block,virus,malicious,T1204.001,T1204,execution,</group>
		<info type="text">
     Description: The FortiGate unit has detected and blocked a file that contains a known virus. This typically occurs when a user attempts to download or access a file that has been flagged as malicious based on its content, behavior, or signature. The antivirus engine within the FortiGate device identifies the threat and prevents the file from being transmitted or executed, thereby protecting the network from potential harm.
    </info>
	</rule>

	<!-- Fortinet Attack detected by MESGID_INFECT_MIME_WARNING -->
	<rule id="111761" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008194$</field>
		<description>Fortigate: MIME header detected to have a virus and blocked.</description>
		<mitre>
			<id>T1562.006</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: The MIME (Multipurpose Internet Mail Extensions) header of an email was detected to contain a virus, resulting in the email being blocked. MIME headers define the format of the email content, and detection of a virus within this part of the email indicates that malicious content was embedded in the email.
    </info>
		<group>low,one-on-one,detect,block,T1562.006,T1562,defense-evasion,</group>
	</rule>

	<!-- Fortinet high Attack detected by MESGID_INFECT_MIME_WARNING -->
	<rule id="111762" level="1">
		<if_sid>111761</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: MIME header detected to have a virus and blocked.</description>
		<mitre>
			<id>T1562.006</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: The MIME (Multipurpose Internet Mail Extensions) header of an email was detected to contain a virus, resulting in the email being blocked. MIME headers define the format of the email content, and detection of a virus within this part of the email indicates that malicious content was embedded in the email.
    </info>
		<group>high,one-on-one,s-a,detect,block,T1562.006,T1562,defense-evasion,</group>
	</rule>

	<!-- Fortinet Critical Attack detected by MESGID_INFECT_MIME_WARNING -->
	<rule id="111763" level="1">
		<if_sid>111761</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: MIME header detected to have a virus and blocked.</description>
		<mitre>
			<id>T1562.006</id>
			<id>T1562</id>
		</mitre>
		<info type="text">
    Description: The MIME (Multipurpose Internet Mail Extensions) header of an email was detected to contain a virus, resulting in the email being blocked. MIME headers define the format of the email content, and detection of a virus within this part of the email indicates that malicious content was embedded in the email.
    </info>
		<group>critical,one-on-one,s-a,detect,block,T1562.006,T1562,defense-evasion,</group>
	</rule>

	<!-- Fortinet  Attack detected by MESGID_INFECT_WARNING -->
	<rule id="111764" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008192$</field>
		<description>Fortigate: Infected file detected by the FortiGate unit and blocked.</description>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
    Description: An infected file was detected by the FortiGate unit and subsequently blocked. FortiGate's antivirus feature identified a file attempting to pass through the network that contained malicious content, such as a virus, worm, or trojan. The file was blocked to prevent it from reaching the intended recipient or system.
    </info>
		<group>low,one-on-one,detect,block,T1190,defense-evasion,</group>
	</rule>

	<!-- Fortinet  Attack detected by MESGID_INFECT_WARNING -->
	<rule id="111765" level="1">
		<if_sid>111764</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Infected file detected by the FortiGate unit and blocked.</description>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
    Description: An infected file was detected by the FortiGate unit and subsequently blocked. FortiGate's antivirus feature identified a file attempting to pass through the network that contained malicious content, such as a virus, worm, or trojan. The file was blocked to prevent it from reaching the intended recipient or system.
    </info>
		<group>critical,one-on-one,s-a,detect,block,T1190,initial-access,</group>
	</rule>

	<!-- Fortinet  Attack detected by MESGID_INFECT_WARNING -->
	<rule id="111766" level="1">
		<if_sid>111764</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Infected file detected by the FortiGate unit and blocked.</description>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info type="text">
    Description: An infected file was detected by the FortiGate unit and subsequently blocked. FortiGate's antivirus feature identified a file attempting to pass through the network that contained malicious content, such as a virus, worm, or trojan. The file was blocked to prevent it from reaching the intended recipient or system.
    </info>
		<group>high,one-on-one,s-a,detect,block,T1190,initial-access,</group>
	</rule>

	<!--done 111639 -->
	<!-- Fortinet high Attack detected by MESGID_MALWARE_LIST_WARNING -->
	<rule id="111767" level="1">
		<if_sid>111639</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: File reported infected by external malware list.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description : The alert indicates that a file has been identified as infected based on an external malware list. This list is a database of known malicious files, often maintained by threat intelligence providers or cybersecurity firms. The file in question has been flagged as potentially harmful due to its presence on this list.
    Impact:
    1.Potential Data Compromise: If the file is indeed malicious, it could lead to unauthorized access or exfiltration of sensitive data.
    2.System Integrity: The infected file could compromise the integrity of the system or application it resides in, potentially causing system instability or crashes.
    3.Network Spread: Depending on the malware's behavior, it might attempt to spread to other systems or network segments, increasing the risk of a broader infection.
    Recommendation:
    1.Analyze the File: Use sandboxing or a malware analysis tool to safely inspect the file's behavior.
    2.Determine the file's hash (MD5, SHA-1, SHA-256) and check against other threat intelligence sources.
    3.Review the file’s execution history and any associated processes.
    4.Look for indicators of compromise (IOCs) related to the malware.
    </info>
		<group>high,one-on-one,s-a,T1204.002,T1204,file,malware,malicious,execution,</group>
	</rule>

	<!-- Fortinet critical Attack detected by MESGID_MALWARE_LIST_WARNING -->
	<rule id="111768" level="1">
		<if_sid>111639</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: File reported infected by external malware list.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description : The alert indicates that a file has been identified as infected based on an external malware list. This list is a database of known malicious files, often maintained by threat intelligence providers or cybersecurity firms. The file in question has been flagged as potentially harmful due to its presence on this list.
    Impact:
    1.Potential Data Compromise: If the file is indeed malicious, it could lead to unauthorized access or exfiltration of sensitive data.
    2.System Integrity: The infected file could compromise the integrity of the system or application it resides in, potentially causing system instability or crashes.
    3.Network Spread: Depending on the malware's behavior, it might attempt to spread to other systems or network segments, increasing the risk of a broader infection.
    Recommendation:
    1.Analyze the File: Use sandboxing or a malware analysis tool to safely inspect the file's behavior.
    2.Determine the file's hash (MD5, SHA-1, SHA-256) and check against other threat intelligence sources.
    3.Review the file’s execution history and any associated processes.
    4.Look for indicators of compromise (IOCs) related to the malware.
    </info>
		<group>critical,one-on-one,s-a,T1204.002,T1204,file,malware,malicious,execution,</group>
	</rule>

	<!-- Fortinet Attack detected by MESGID_MIME_AVQUERY_WARNING -->
	<rule id="111769" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">008204$</field>
		<description>Fortigate: MIME data reported infected by Outbreak Prevention (warning).</description>
		<mitre>
			<id>T1204</id>
			<id>T1204.002</id>
		</mitre>
		<info type="text">
      Description: The alert indicates that MIME (Multipurpose Internet Mail Extensions) data has been flagged as infected by the Outbreak Prevention system. This system is designed to detect and block potential threats based on emerging patterns or outbreaks of malware. The MIME data likely originates from an email attachment, which may contain malicious code or files that could compromise the network.
    </info>
		<group>low,one-on-one,execution,T1204,T1204.002,file,malicious,</group>
	</rule>

	<!-- Fortinet high Attack detected by MESGID_MIME_AVQUERY_WARNING -->
	<rule id="111770" level="1">
		<if_sid>111769</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: MIME data reported infected by Outbreak Prevention (warning).</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert indicates that MIME (Multipurpose Internet Mail Extensions) data has been flagged as infected by the Outbreak Prevention system. This system is designed to detect and block potential threats based on emerging patterns or outbreaks of malware. The MIME data likely originates from an email attachment, which may contain malicious code or files that could compromise the network.
    Impact:
    1.Potential Compromise: If the MIME data is indeed malicious, it could lead to the compromise of the affected systems. This might result in unauthorized access, data exfiltration, or further propagation of malware within the network.
    2.Operational Disruption: Infected data could disrupt normal business operations, leading to downtime or performance degradation.
    3.Reputation Damage: If the infection spreads or leads to a data breach, it could harm the organization's reputation.
    Recommendation:
    1.Alert Verification: Review the associated logs to understand the context, such as the source and destination IPs, email subject, and file name.
    2.Correlation with Other Events: Look for other alerts or logs related to the same source, recipient, or similar patterns. This can help in identifying whether this is an isolated incident or part of a broader attack.
    </info>
		<group>high,one-on-one,s-a,execution,T1204.002,T1204,file,malicious,</group>
	</rule>

	<!-- Fortinet Critical Attack detected by MESGID_MIME_AVQUERY_WARNING -->
	<rule id="111771" level="1">
		<if_sid>111769</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: MIME data reported infected by Outbreak Prevention (warning).</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert indicates that MIME (Multipurpose Internet Mail Extensions) data has been flagged as infected by the Outbreak Prevention system. This system is designed to detect and block potential threats based on emerging patterns or outbreaks of malware. The MIME data likely originates from an email attachment, which may contain malicious code or files that could compromise the network.
    Impact:
    1.Potential Compromise: If the MIME data is indeed malicious, it could lead to the compromise of the affected systems. This might result in unauthorized access, data exfiltration, or further propagation of malware within the network.
    2.Operational Disruption: Infected data could disrupt normal business operations, leading to downtime or performance degradation.
    3.Reputation Damage: If the infection spreads or leads to a data breach, it could harm the organization's reputation.
    Recommendation:
    1.Alert Verification: Review the associated logs to understand the context, such as the source and destination IPs, email subject, and file name.
    2.Correlation with Other Events: Look for other alerts or logs related to the same source, recipient, or similar patterns. This can help in identifying whether this is an isolated incident or part of a broader attack.
    </info>
		<group>critical,one-on-one,s-a,execution,T1204.002,T1204,file,malicious,</group>
	</rule>

	<!-- done -->
	<!-- Fortinet high Attack detected by MESGID_MIME_FILETYPE_EXE_WARNING -->
	<rule id="111772" level="1">
		<if_sid>111638</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Executable File Detected in Email Attachment.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert "MESGID_MIME_FILETYPE_EXE_WARNING" indicates that an email containing an executable file (.exe) as an attachment has been flagged by the security system. The MIME type detection mechanism has identified the attachment as an executable file, which may pose a potential security risk. The warning suggests that while the file has not been confirmed as malicious, it warrants further investigation due to the inherent risks associated with executable files.
    </info>
		<group>high,one-on-one,s-a,T1204.002,T1204,execution,</group>
	</rule>

	<!-- done -->
	<!-- Fortinet Critical Attack detected by MESGID_MIME_FILETYPE_EXE_WARNING -->
	<rule id="111773" level="1">
		<if_sid>111638</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Executable File Detected in Email Attachment.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert "MESGID_MIME_FILETYPE_EXE_WARNING" indicates that an email containing an executable file (.exe) as an attachment has been flagged by the security system. The MIME type detection mechanism has identified the attachment as an executable file, which may pose a potential security risk. The warning suggests that while the file has not been confirmed as malicious, it warrants further investigation due to the inherent risks associated with executable files.
    </info>
		<group>critical,one-on-one,s-a,file,T1204.002,T1204,execution,</group>
	</rule>

	<!-- done -->
	<!-- Fortinet high Attack detected by Malicious Url -->
	<rule id="111774" level="1">
		<if_sid>111549</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Attack detected by a malicious URL.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert indicates that an attack was detected involving a malicious URL. This typically occurs when a user attempts to access a website or link that has been identified as malicious. Such URLs can lead to phishing sites, deliver malware, or exploit vulnerabilities in the user's browser or operating system. The alert suggests that an attempt was made to interact with a dangerous site, which could compromise the security of the user's system or the network.
    Impact:
    1.Phishing Attack: The malicious URL could direct the user to a phishing site designed to steal credentials, personal information, or sensitive business data.
    2.Malware Infection: Accessing the malicious URL might result in the download and execution of malware, such as ransomware, spyware, or trojans, potentially leading to a system or network compromise.
    3.Data Breach: If the URL is part of a targeted attack, it could result in unauthorized access to the organization's data or systems, leading to a potential data breach.
    4.Network Compromise: The malicious site might exploit vulnerabilities to gain a foothold in the network, allowing attackers to move laterally and further compromise other systems.
    Recommendation:
    1.Alert Verification: Confirm the details of the alert in the SIEM or web filtering platform. Identify the user or system that attempted to access the malicious URL.
    2.URL Analysis: Reputation Check: Perform a reputation check on the URL using threat intelligence platforms to see if it is associated with known phishing sites, malware distribution, or other malicious activity.
    3.Check the user's browsing history and email activity around the time of the alert to identify any other potentially malicious interactions.
    </info>
		<group>high,one-on-one,s-a,malicious,attack,detect,T1204.002,T1204,execution,</group>
	</rule>

	<!-- Fortinet Critical Attack detected by Malicious Url -->
	<rule id="111775" level="1">
		<if_sid>111549</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Attack detected by a malicious URL.</description>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<info type="text">
    Description: The alert indicates that an attack was detected involving a malicious URL. This typically occurs when a user attempts to access a website or link that has been identified as malicious. Such URLs can lead to phishing sites, deliver malware, or exploit vulnerabilities in the user's browser or operating system. The alert suggests that an attempt was made to interact with a dangerous site, which could compromise the security of the user's system or the network.
    Impact:
    1.Phishing Attack: The malicious URL could direct the user to a phishing site designed to steal credentials, personal information, or sensitive business data.
    2.Malware Infection: Accessing the malicious URL might result in the download and execution of malware, such as ransomware, spyware, or trojans, potentially leading to a system or network compromise.
    3.Data Breach: If the URL is part of a targeted attack, it could result in unauthorized access to the organization's data or systems, leading to a potential data breach.
    4.Network Compromise: The malicious site might exploit vulnerabilities to gain a foothold in the network, allowing attackers to move laterally and further compromise other systems.
    Recommendation:
    1.Alert Verification: Confirm the details of the alert in the SIEM or web filtering platform. Identify the user or system that attempted to access the malicious URL.
    2.URL Analysis: Reputation Check: Perform a reputation check on the URL using threat intelligence platforms to see if it is associated with known phishing sites, malware distribution, or other malicious activity.
    3.Check the user's browsing history and email activity around the time of the alert to identify any other potentially malicious interactions.
    </info>
		<group>critical,one-on-one,s-a,malicious,attack,detect,T1204.002,T1204,execution,</group>
	</rule>

	<!-- done -->
	<!-- Fortinet  Attack detected by Others signature -->
	<rule id="111776" level="1">
		<if_sid>111548</if_sid>
		<field name="severity" type="pcre2">(?i)^high$</field>
		<description>Fortigate: Attack detected by other signature.</description>
		<info type="text">
    Description: The "Attack detected by other signature" alert indicates that a potential security threat has been identified by a signature that does not match any specific attack type but is flagged based on a broader set of criteria. This could include unusual network behavior, pattern anomalies, or general threat indicators that don't fit a predefined signature.
    Impact: 
    This alert can indicate various potential threats, including emerging or unknown attacks that have not been fully categorized. The impact varies depending on the nature of the detected activity but could lead to unauthorized access, data breaches, or network disruptions if not properly mitigated.
    Recommendation:
    1.Initial Triage: Verify the Alert: Review the alert details, such as the source and destination IP addresses, timestamps, and associated logs.
    2.If applicable, check the affected endpoints for signs of compromise or unusual behavior.
    3.Examine Logs: Dive deeper into the logs associated with the alert to identify any suspicious activity or patterns.
    </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>high,one-on-one,s-a,signature,T1204.002,T1204,attack,detect,execution,malicious,</group>
	</rule>

	<!-- Fortinet Critical Attack detected by Others signature -->
	<rule id="111777" level="1">
		<if_sid>111548</if_sid>
		<field name="severity" type="pcre2">(?i)^critical$</field>
		<description>Fortigate: Attack detected by other signature.</description>
		<info type="text">
    Description: The "Attack detected by other signature" alert indicates that a potential security threat has been identified by a signature that does not match any specific attack type but is flagged based on a broader set of criteria. This could include unusual network behavior, pattern anomalies, or general threat indicators that don't fit a predefined signature.
    Impact: 
    This alert can indicate various potential threats, including emerging or unknown attacks that have not been fully categorized. The impact varies depending on the nature of the detected activity but could lead to unauthorized access, data breaches, or network disruptions if not properly mitigated.
    Recommendation:
    1.Initial Triage: Verify the Alert: Review the alert details, such as the source and destination IP addresses, timestamps, and associated logs.
    2.If applicable, check the affected endpoints for signs of compromise or unusual behavior.
    3.Examine Logs: Dive deeper into the logs associated with the alert to identify any suspicious activity or patterns.
    </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>critical,one-on-one,s-a,signature,T1204.002,T1204,attack,detect,execution,malicious,</group>
	</rule>

	<!-- User Delete: IFFCOADMIN (Any User will delete the IFFCOADMIN after performing the activity)  -->
	<!-- Fortigate: Guest user deleted. -->
	<rule id="111778" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032131$</field>
		<description>Fortigate: User deleted.</description>
		<info type="text">
    Description: This rule is triggered when a guest user account is deleted in the FortiGate system. The rule monitors for any user deletion events specifically tied to guest accounts, which may be indicative of routine administrative actions or potential security incidents.
    </info>
		<mitre>
			<id>T1531</id>
		</mitre>
		<group>low,one-on-one,T1531,impact,delete,kalupur,</group>
	</rule>

	<!-- Fortigate: Local user deleted IFFCOADMIN. -->
	<rule id="111779" level="1">
		<if_sid>111778</if_sid>
		<field name="tenant" type="pcre2">(?i)^IFFCO.*</field>
		<match type="pcre2">(?i)IFFCOADMIN</match>
		<description>Fortigate: User deleted IFFCOADMIN.</description>
		<info type="text">
    Description: This rule is triggered when a guest user account is deleted in the FortiGate system. The rule monitors for any user deletion events specifically tied to guest accounts, which may be indicative of routine administrative actions or potential security incidents.
    </info>
		<mitre>
			<id>T1531</id>
		</mitre>
		<group>medium,one-on-one,T1531,impact,delete,</group>
	</rule>

	<!-- User added: IFFCOADMIN (Any User will create the IFFCOADMIN after performing the activity)  -->
	<!-- Fortigate: local user added. -->
	<rule id="111780" level="1">
		<if_sid>111501</if_sid>
		<field name="log_id">032132$</field>
		<description>Fortigate: User added.</description>
		<info type="text">
    Description: This rule is triggered when a local user account named "IFFCOADMIN" is created on the FortiGate system. The rule monitors for the specific addition of this account, as it could be associated with administrative or privileged activities within the IFFCO environment.
    </info>
		<mitre>
			<id>T1136.001</id>
			<id>T1136</id>
		</mitre>
		<group>low,one-on-one,T1136.001,T1136,impact,add,kalupur,</group>
	</rule>

	<!-- Fortigate: local user added IFFCOADMIN. -->
	<rule id="111781" level="1">
		<if_sid>111780</if_sid>
		<field name="tenant" type="pcre2">(?i)^IFFCO.*</field>
		<match type="pcre2">(?i)IFFCOADMIN</match>
		<description>Fortigate: User added IFFCOADMIN.</description>
		<info type="text">
    Description: This rule is triggered when a local user account named "IFFCOADMIN" is created on the FortiGate system. The rule monitors for the specific addition of this account, as it could be associated with administrative or privileged activities within the IFFCO environment.
    </info>
		<mitre>
			<id>T1136.001</id>
			<id>T1136</id>
		</mitre>
		<group>medium,one-on-one,T1136.001,T1136,impact,add,</group>
	</rule>

	<!-- 
Sep  6 13:20:49 10-1-19-106.prometheus-kube-prometheus-kubelet.kube-system.svc.cluster.local  time=13:20:46 devname="HS-FGT-600E" devid="FG6H0E5819904272" eventtime=1725609045546955724 tz="+0530" logid="0100032003" type="event" subtype="system" level="information" vd="root" logdesc="Admin logout successful" sn="1725607212" user="jaykumar.r" ui="https(192.168.104.51)" method="https" srcip=192.168.104.51 dstip=192.168.120.22 action="logout" status="success" duration=1833 reason="timeout" msg="Administrator jaykumar.r timed out on https(192.168.104.51)" tenant=ABPLHS productName=Fortigate productType=firewall logType=network
 -->
	<rule id="111782" level="1" >
		<if_sid>111501</if_sid>
		<action type="pcre2">(?i)^logout$</action>
		<status type="pcre2">(?i)^success$</status>
		<description>Fortigate: User logout successful.</description>
		<mitre>
			<id>T1098</id>
		</mitre>
		<info>
        Description: The "User logout successful" alert is triggered when a user successfully terminates their session, indicating the end of an active session. This can be used for session tracking, auditing user activity, or detecting abnormal logout patterns.
    </info>
		<group>low,one-on-one,T1098,persistence,</group>
	</rule>


	<!-- Sep 10 11:26:39 10-1-19-106.prometheus-kube-prometheus-kubelet.kube-system.svc.cluster.local  time=11:26:39 devname="fwlan02_mum" devid="FG4H1ETB22900625" eventtime=1725947799240169729 tz="+0530" logid="0101039947" type="event" subtype="vpn" level="information" vd="FG-traffic" logdesc="SSL VPN tunnel up" action="tunnel-up" tunneltype="ssl-tunnel" tunnelid=288058775 remip=182.72.67.50 tunnelip=10.0.250.1 srccountry="India" user="vpal" group="SSL_VPN_USERS" dst_host="N/A" fctuid="C35C215ADA704D199017C22798C7018B" reason="tunnel established" msg="SSL tunnel established" tenant=LyraNet productName=Fortigate productType=firewall logType=network -->

	<rule id="111784" level="1">
	<if_sid>111501</if_sid>
	<field name="log_id" type="pcre2">039947$</field>
	<action type="pcre2">(?i)^tunnel-up$</action>
	<description>Fortigate: SSL VPN tunnel up.</description>
	<mitre>
	<id>T1078</id>
	</mitre>
	<info>
        Description: This alert indicates that a secure SSL VPN connection has been successfully established between a remote user or device and the corporate network, allowing secure data transmission over the encrypted tunnel.
    </info>
	<group>low,one-on-one,authentication,vpn,T1078,defense-evasion,ssl,</group>
	</rule>

	<!-- <rule id="111785" level="10" frequency="18" timeframe="45"><if_matched_sid>111784</if_matched_sid><same_field>src_ip</same_field><same_field>tenant</same_field><description>Fortigate: Multiple vpn user connected from same source.</description><mitre><id>T1078</id></mitre><info>
        Description: This alert is triggered when multiple VPN users connect from the same source within a short period of time. In this case, 18 connections occurred within 45 minutes. After the alert is triggered, no new alerts will be generated for the next 240 minutes to prevent duplicate notifications.
    </info><group>authentication,vpn,medium,T1078,defense-evasion,aggregation,</group></rule>
 -->
	<!-- Sep  6 14:56:56 10-1-19-106.prometheus-kube-prometheus-kubelet.kube-system.svc.cluster.local  time=14:56:56 devname="fwlan02_mum" devid="FG4H1ETB22900625" eventtime=1725614816005580435 tz="+0530" logid="0101039425" type="event" subtype="vpn" level="information" vd="FG-traffic" logdesc="SSL VPN tunnel down" action="tunnel-down" tunneltype="ssl-web" tunnelid=288058771 remip=14.143.131.62 srccountry="India" user="vpal" group="SSL_VPN_USERS" dst_host="N/A" reason="User requested termination of service" duration=3529 sentbyte=0 rcvdbyte=0 msg="SSL tunnel shutdown" tenant=LyraNet productName=Fortigate productType=firewall logType=network
 -->
	<rule id="111786" level="1" >
		<if_sid>111501</if_sid>
		<field name="log_id" type="pcre2">039425$</field>
		<!-- <field name="level" type="pcre2">(?i)^information$</field> -->
		<action type="pcre2">(?i)^tunnel-down$</action>
		<description>Fortigate: VPN user disconnected.</description>
		<mitre>
			<id>T1133</id>
		</mitre>
		<info>
        Description: This alert is triggered when a VPN user disconnects from the network. It means the user has logged out or lost connection. This could happen due to the user manually logging off or an unexpected interruption in the connection. 
    </info>
		<group>low,one-on-one,T1133,persistence,</group>
	</rule>


	<!-- Sep 10 11:36:23 10-1-19-106.prometheus-kube-prometheus-kubelet.kube-system.svc.cluster.local  time=11:36:18 devname="BS-FGT-600E" devid="FG6H0E5819904323" eventtime=1725948378008687094 tz="+0530" logid="0101037136" type="event" subtype="vpn" level="error" vd="root" logdesc="IPsec DPD failed" msg="IPsec DPD failure" action="dpd" remip=14.99.54.194 locip=10.21.30.2 remport=500 locport=500 outintf="port7" cookies="2db05c7df311a533/04b834aca09a87a0" user="10.20.32.2" group="N/A" useralt="N/A" xauthuser="N/A" xauthgroup="N/A" assignip=N/A vpntunnel="BS1" status="dpd_failure" tenant=ABPLBS productName=Fortigate productType=firewall logType=network -->

	<!-- check if the other side of an IPsec VPN tunnel is still active -->
	<rule id="111788" level="1">
		<if_sid>111501</if_sid>
		<status type="pcre2">(?i)^dpd_failure$</status>
		<description>Fortigate: IPsec DPD failed.</description>
		<info>
    Description: This alert indicates that the Dead Peer Detection (DPD) mechanism in the IPsec VPN failed to receive a response from the remote peer, suggesting that the connection might be down or unresponsive. This could lead to a loss of VPN connectivity.
    </info>
		<mitre>
			<id>T1133</id>
		</mitre>
		<group>medium,one-on-one,s-a,T1133,persistence,failure,</group>
	</rule>

	<!-- tenant : abc -->
	<!-- <rule id="111790" level="12" frequency="2" timeframe="120">
	<if_matched_sid>111594</if_matched_sid>
	<same_field>src_ip</same_field>
	<field name="tenant" type="pcre2">(?i)abc</field>
	<description>Fortigate: Multiple SSL VPN login failures.</description>
	<info type="text">
    Description: This rule is triggered when a login attempt to the SSL VPN fails, indicating possible issues with authentication credentials or potential unauthorized access attempts.
    </info>
	<mitre>
	<id>T1133</id>
	</mitre>
	<group>soar-alert,aggregation,T1133,initial-access,ssl,authentication,login,high,failure,abc,</group>
	</rule>
 -->


	<!-- kalupur -->
	<!--configuration chan: 111662
111643 - same user 
 -->
	<!-- <rule id="111792" level="15" timeframe="120">
		<if_matched_sid>111643</if_matched_sid>
		<if_sid>111662</if_sid>
		<same_field>tenant</same_field>
		<same_field>dstuser</same_field>
		<description>Fortigate: Brute force with successful configuration changes from same user.</description>
		<info type="text">
    Description: Detects multiple failed SSL VPN login attempts followed by a successful login, indicating potential brute force or unauthorized access attempts.
    </info>
		<mitre>
			<id>T1110</id>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
		<group>correlation,T1110,credential-access,authentication,login,configuration,change,policy,T1562.004,T1562,defense-evasion,critical,kalupur,</group>
	</rule> -->
	<!--
configuration chan: 111662
111644 - same ip 
-->
	<!-- <rule id="111793" level="15" timeframe="120"><if_matched_sid>111644</if_matched_sid><if_sid>111662</if_sid><same_field>tenant</same_field><same_field>src_ip</same_field><description>Fortigate: Brute force with successful configuration changes from same ip.</description><info type="text">
    Description: Detects multiple failed SSL VPN login attempts followed by a successful login, indicating potential brute force or unauthorized access attempts.
    </info><mitre><id>T1133</id></mitre><group>correlation,T1110,credential-access,authentication,login,configuration,change,policy,T1562.004,T1562,defense-evasion,critical,kalupur,</group></rule>

 -->

<!-- 111833 -->
<rule id="111833" level="1" noalert="1">
   <if_sid>111671</if_sid>
    <dstport type="pcre2">^1521$|^1433$|^69$|^3389$|^23$|^22$|^21$|^445$|^3306$|^5432$|^137$|^138$|^139$</dstport>
   <description>Fortigate: Port enumeration activity detected.</description>
   <info type="text">Description: This rule detects attempts to scan or connect to multiple critical service ports including database services (Oracle, MSSQL, MySQL, PostgreSQL), file sharing (SMB, NetBIOS), remote access (RDP, SSH, Telnet, FTP), indicating potential network service enumeration activity.</info>
   <mitre>
       <id>T1133</id>
       <id>T1046</id>
       <id>T1595</id>
       <id>T1595.001</id>
   </mitre>
   <group>medium,one-on-one,network-scan,port-scan,discovery,reconnaissance,network,detection,T1133,T1046,T1595,T1595.001,</group>
</rule>

<rule id="111834" level="1">
		<if_sid>111501</if_sid>
		<dstport type="pcre2">^(?!8080$|443$|80$)</dstport>
		<field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
		<!-- <field name="dstip" type="pcre2">^(?!10\.\d{1,3}\.\d{1,3}\.\d{1,3}$|192\.168\.\d{1,3}\.\d{1,3}$|172\.(1[6-9]|2[0-9]|3[0-1])\.\d{1,3}\.\d{1,3}$).{1,15}$</field> -->
		<description>Fortigate: Detects suspicious network connections.</description>
		<group>low,one-on-one,persistence,windows,T1078,T1485,detection,</group>
		<info type="text">
      	 Description: This rule detects suspicious outbound network connections that deviate from standard ports or IP ranges. Such connections may indicate unauthorized access, data exfiltration, or malicious activity.
        </info>
		<mitre>
			<id>T1078</id>
			<id>T1485</id>
		</mitre>
</rule>


<!-- Rule set 4: Suspicious Network Connection -->
<rule id="111836" level="1">
    <if_sid>111501</if_sid>
    <dstport>^443$</dstport>
    <list field="dst_ip">etc/lists/certiniocs</list>    
    <description>Fortigate: Connection to known C2 server.</description>
    <info type="text">Description: This rule detects HTTPS connections to IP addresses that match known command and control infrastructure. These connections using port 443 may indicate compromised systems attempting to communicate with malicious external servers for data exfiltration or command execution.</info>
    <mitre>
        <id>T1071</id>
        <id>T1071.001</id>
        <id>T1573</id>
        <id>T1573.002</id>
        <id>T1102</id>
        <id>T1102.002</id>
    </mitre>
    <group>medium,one-on-one,T1071,T1071.001,defense-evasion,T1573,T1573.002,T1102,T1102.002,command-control,network,outbound,https,suspicious-activity,multiple-attempts,detection,</group>
</rule>

<!--Detects attempts to authenticate via SMB to external IPs-->
<rule id="111839" level="1">
   <if_sid>111671</if_sid>
   <dstport type="pcre2">^138$|^137$|^445$|^139$</dstport>
	<field name="protocol_number" type="pcre2">^17$|^6$</field>
   <field name="dst_ip" type="pcre2" negate="yes">\b(10|172\.(1[6-9]|2\d|3[01])|192\.168)\.\d{1,3}\.\d{1,3}\b</field>
   <description>Fortigate: SMB protocol connection attempt to external network detected.</description>
   <info type="text">Description: This rule detects outbound connection attempts using SMB/NetBIOS protocols (ports 137-139, 445) to destinations outside the internal network range. Such external SMB traffic is unusual and potentially indicates lateral movement attempts or data exfiltration activity.</info>
   <mitre>
       <id>T1021</id>
       <id>T1021.002</id>
       <id>T1048</id>
       <id>T1048.003</id>
   </mitre>
   <group>medium,one-on-one,s-a,T1021,T1021.002,T1048,T1048.003,network,smb,lateral-movement,exfiltration,outbound,detection,</group>
</rule>

<!-- =============================================================================================================================================================================================================== -->

<!-- Level 2 rules -->
<rule id="111835" level="2" timeframe="120" frequency="5">
   <if_matched_sid>111833</if_matched_sid>
   <description>Fortigate: Port enumeration activity detected.</description>
   <same_field>tenant</same_field>
   <same_field>src_ip</same_field>
   <different_field>dstport</different_field>
   <info type="text">Description: Detection of scanning or connection attempts to commonly targeted service ports. This could indicate reconnaissance activity or attempted unauthorized access to critical services.
</info>
   <mitre>
       <id>T1133</id>
       <id>T1046</id>
       <id>T1595</id>
       <id>T1595.001</id>
   </mitre>
   <group>low,aggregation,network-scan,port-scan,discovery,reconnaissance,network,detection,T1133,T1046,T1595,T1595.001,</group>
</rule>

	<rule id="111576" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111708</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple time attack detected by botnet warning.</description>
		<group>high,aggregation,soar-alert,T1584.005,T1584,resource-development,attack,</group>
		<mitre>
			<id>T1584.005</id>
			<id>T1584</id>
		</mitre>
		<info type="text">
        Description: The "Attack detected by botnet notify" alert indicates that FortiGate has identified suspicious activity or an attack originating from or involving a known botnet. This type of alert suggests that malicious behavior associated with botnet activity has been detected, potentially involving automated or distributed attacks.
        Impact:
        1.Security Risk: The presence of a botnet attack poses a serious threat, potentially compromising network integrity, stealing data, or disrupting services.
        2.Operational Disruption: Botnet attacks can lead to significant operational issues, including service outages and degraded performance.
        3.Increased Threat Exposure: The detection of botnet activity might indicate ongoing or future attacks, requiring immediate attention to prevent further exploitation.
        Recommendation:
        1.Review Alert Details: Examine specifics of the botnet activity, including source IPs, destination IPs, and types of detected attacks.
        2.Identify the Botnet: Determine the botnet’s characteristics, such as its known behaviors, infrastructure, and any associated malware.
        3.Analyze Traffic Patterns: Assess traffic patterns for anomalies or signatures typical of botnet activity, such as large volumes of traffic or unusual communication patterns.
      </info>
	</rule>

	<rule id="111524" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111523</if_matched_sid>
		<field name="severity">^info$</field>
		<description>Fortigate: Multiple incoming attacks detected by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This rule triggers when 30 or more incoming attacks are detected by an ICMP signature from the same source address within a 15 minutes. The rule is designed to identify potential network threats, such as distributed denial-of-service (DDoS) attacks or reconnaissance activities, by monitoring for repeated malicious ICMP traffic originating from a single source.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>info,aggregation,inbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111525" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111523</if_matched_sid>
		<field name="severity">^low$</field>
		<description>FortiGate: multiple incoming attacks detected by an ICMP signature from the same source address.</description>
		<info type="text">
   Description: This rule triggers when 30 or more incoming attacks are detected by an ICMP signature from the same source address within a 15 minutes. The rule is designed to identify potential network threats, such as distributed denial-of-service (DDoS) attacks or reconnaissance activities, by monitoring for repeated malicious ICMP traffic originating from a single source.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,inbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<rule id="111531" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111530</if_matched_sid>
		<field name="severity">^info$</field>
		<description>FortiGate: Multiple outgoing attacks detected by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This rule triggers when FortiGate detects 30 or more outgoing ICMP-based attacks within a 15 minutes. The rule is designed to identify potential threats where an internal device might be attempting to communicate with external networks using malicious ICMP traffic, indicating possible malware activity or a compromised system.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>info,aggregation,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111532" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111530</if_matched_sid>
		<field name="severity">^low$</field>
		<description>Fortigate: Multiple outgoing attacks detected by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This rule triggers when FortiGate detects 30 or more outgoing ICMP-based attacks within a 15 minutes. The rule is designed to identify potential threats where an internal device might be attempting to communicate with external networks using malicious ICMP traffic, indicating possible malware activity or a compromised system.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,outbound,ips,icmp,detect,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<rule id="111537" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111536</if_matched_sid>
		<field name="severity">^info$</field>
		<description>FortiGate: Multiple incoming attack was blocked by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This alert indicates that within a 15-minute period, 30 incoming ICMP-based attacks from the same source address were blocked by the FortiGate firewall's signature-based detection. This could suggest a potential ICMP flood attack or probing activity from a single source.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>info,aggregation,inbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111538" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111536</if_matched_sid>
		<field name="severity">^low$</field>
		<description>Fortigate: Multiple incoming attack was blocked by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This alert indicates that within a 15-minute period, 30 incoming ICMP-based attacks from the same source address were blocked by the FortiGate firewall's signature-based detection. This could suggest a potential ICMP flood attack or probing activity from a single source.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,inbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>


	<rule id="111543" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111542</if_matched_sid>
		<field name="severity">^info$</field>
		<description>FortiGate: Multiple outgoing attack was blocked by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This rule indicates that an outgoing attack was detected and blocked by a FortiGate ICMP signature. The rule was triggered because the system identified multiple ICMP packets that matched a known attack pattern, occurring 30 times within a 15-minute , indicating a potential threat.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>info,aggregation,outbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111544" level="2" frequency="30" timeframe="900">
		<if_matched_sid>111542</if_matched_sid>
		<field name="severity">^low$</field>
		<description>FortiGate: Multiple outgoing attack was blocked by an ICMP signature from the same source address.</description>
		<info type="text">
    Description: This rule indicates that an outgoing attack was detected and blocked by a FortiGate ICMP signature. The rule was triggered because the system identified multiple ICMP packets that matched a known attack pattern, occurring 30 times within a 15-minute , indicating a potential threat.
    </info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,outbound,ips,icmp,block,malicious,violation,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111588" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111566</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Web application firewall blocked application by address list.</description>
		<group>medium,aggregation,soar-alert,T1190,block,waf,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
		<info>
		Description:  The alert is activated if the same source triggers the block 7 times within a 15-minute period (900 seconds). This may indicate repeated attempts to access restricted resources or IP addresses that are blacklisted or considered suspicious.
		</info>
	</rule>


	<rule id="111590" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111568</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<field name="tenant" type="pcre2" negate="yes">(?i)^DICT.*</field>
		<description>Fortigate: Multiple Web application firewall blocked application by HTTP constraints from same source.</description>
		<group>medium,aggregation,soar-alert,T1562,defense-evasion,waf,block,protocol,</group>
		<mitre>
			<id>T1562</id>
		</mitre>
		<info>
	Description: The FortiGate has detected and blocked multiple attempts (7 times) from the same source to access an application using HTTP within 15 minutes (900 seconds). The Web Application Firewall (WAF) blocked these attempts because they violated security rules related to HTTP constraints, which are in place to protect the network from potential threats.
	</info>
	</rule>

	<rule id="111591" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111570</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple Web application firewall blocked application by custom signature from same source.</description>
		<mitre>
			<id>T1071</id>
			<id>T1071.001</id>
		</mitre>
		<info type="text">
	Description: The FortiGate's Web Application Firewall (WAF) has blocked an application 7 times within 900 seconds (15 minutes) from the same source using a custom security signature. This indicates repeated attempts to access or execute an application that the custom signature has identified as potentially harmful.
	</info>
	<group>medium,aggregation,soar-alert,T1071.001,T1071,initial-access,block,signature,waf,</group>
	</rule>

	<rule id="111592" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111574</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple Web application firewall blocked application by HTTP method from same source.</description>
		<group>critical,aggregation,soar-alert,block,protocol,waf,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<info type="text">
Description:This alert means that the FortiGate's Web Application Firewall (WAF) blocked an application multiple times (7 times) due to an HTTP method used from the same source within 15 minutes (900 seconds). A Web Application Firewall (WAF) blocked an application request due to the use of an HTTP method that is either not allowed or considered potentially harmful. HTTP methods like PUT, DELETE, TRACE, CONNECT, or OPTIONS may be restricted by WAF policies to protect against potential security threats such as unauthorized data modification, deletion, or exposure of sensitive information.
</info>
	</rule>

<rule id="111577" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111575</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: web application firewall blocked application by URL access from same source.</description>
		<group>high,aggregation,soar-alert,T1205,defense-evasion,file,malicious,</group>
		<mitre>
			<id>T1205</id>
		</mitre>
		<info type="text">
    Description: This rule indicates that the Fortigate web application firewall (WAF) blocked access to a specific application due to a URL pattern that matches its configured security policies. The rule was triggered because the URL access attempt occurred 7 times within a 15 minutes (900-second), suggesting a potential security risk or violation of access control policies.
    </info>
	</rule>

	<rule id="111578" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111504</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Seven times file reported infected by EMS threat feed from same source within 15 minutes of interval.</description>
		<info type="text">
        Description: This rule triggers when seven or more infections are reported by the EMS threat feed from the same source within a 15-minute . The rule is designed to detect potential malware outbreaks or persistent threats originating from a single source.
    </info>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
		<group>medium,aggregation,soar-alert,T1204.002,T1204,file,malicious,execution,</group>
	</rule>

	<rule id="111579" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111515</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple switching protocols request from same source.</description>
		<info type="text">
        Description: This rule detects multiple switching protocol requests originating from the same source within a 15 minutes(900-second) It triggers when the frequency of these requests exceeds 7, indicating potential malicious activity or misconfiguration.
    </info>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<group>medium,aggregation,soar-alert,T1071.001,T1071,command-and-control,protocol,</group>
	</rule>

	<rule id="111580" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111518</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple SPAM notification from same source.</description>
		<info type="text">
        Description: This rule triggers when there are 7 or more SPAM notifications originating from the same source within a 15 minutes(900-second). It indicates a potential SPAM attack or a compromised source repeatedly sending unsolicited messages, triggering this alert.
    </info>
		<group>medium,aggregation,soar-alert,malicious,T1566,initial-access,</group>
		<mitre>
			<id>T1566</id>
		</mitre>
	</rule>

	<rule id="111581" level="2" frequency="6" timeframe="500">
		<if_matched_sid>111551</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple SSH shell commands blocked from the same source.</description>
		<info type="text">
        Description: This rule triggers when more than six SSH shell commands are blocked from the same source IP within a 500-second. It indicates that a single source is attempting multiple SSH commands in a short period, which may be a sign of automated scanning or a brute force attack attempt. The rule helps in identifying and mitigating potential threats by flagging unusual or potentially malicious activity patterns.
    </info>
		<group>medium,aggregation,soar-alert,ssh,command-line,block,T1021.004,T1021,lateral-movement,</group>
		<mitre>
			<id>T1021.004</id>
			<id>T1021</id>
		</mitre>
	</rule>

	<rule id="111582" level="2" frequency="6" timeframe="900">
		<if_matched_sid>111552</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple SSH shell commands detected from same source.</description>
		<info type="text">
    Description: This rule triggers when more than six SSH shell commands are detected from the same source within a 15-minute timeframe (900 seconds). It indicates a potential automated or malicious activity pattern where multiple commands are issued in quick succession, which may be indicative of a compromise or unauthorized access attempt.
    </info>
		<group>medium,aggregation,soar-alert,ssh,command-line,block,T1021.004,T1021,lateral-movement,</group>
		<mitre>
			<id>T1021.004</id>
			<id>T1021</id>
		</mitre>
	</rule>

	<rule id="111583" level="2" frequency="6" timeframe="900">
		<if_matched_sid>111555</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple commands blocked from same source .</description>
		<info type="text">
    Description: This rule triggers when multiple SSH shell commands are blocked from the same source within a 15-minute timeframe (900 seconds) with a frequency of 6 occurrences. The alert indicates potential suspicious or malicious activity from a single source, such as automated attack attempts or unauthorized access attempts.
    </info>
		<group>medium,aggregation,soar-alert,block,T1071.001,T1071,command-and-control,</group>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
	</rule>

	<rule id="111584" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111560</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple Application Control (IPS) Blocks from Same Source.</description>
		<info type="text">
Description: This rule triggers when the same source IP address is detected with multiple application control (IPS) blocks within a 15-minute timeframe. The high frequency of such events indicates a potential attempt to exploit vulnerabilities or a misconfigured application.
</info>
		<group>medium,aggregation,soar-alert,application,reject,execution,T1204.002,T1204,</group>
		<mitre>
			<id>T1204.002</id>
			<id>T1204</id>
		</mitre>
	</rule>

	<rule id="111585" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111562</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple application control IM (SSH) (block) from same source.</description>
		<info type="text">
Description: This rule is triggered when multiple blocked SSH application control events are detected from the same source within a 15 minutes (900-second). It helps identify potential abuse or attacks originating from a single source by monitoring repeated blocked SSH connections.
</info>
		<group>medium,aggregation,s-a,ips,application,block,ssh,T1190,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
	</rule>

	<rule id="111586" level="2" frequency="80" timeframe="150" ignore="1800">
		<if_matched_sid>111563</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple application control port enforcement from same source.</description>
		<info type="text">
Description: This rule triggers when 80 or more application control port enforcement events are detected from the same source within a 150-second timeframe. The alert is generated to identify potential misuse or abnormal activity where a single source attempts to access multiple restricted or monitored ports within a short period, indicating a possible attack or unauthorized behavior.
</info>
		<mitre>
			<id>T1071.001</id>
			<id>T1071</id>
		</mitre>
		<group>medium,aggregation,command-and-control,application,T1071.001,T1071,</group>
	</rule>


<rule id="111587" level="2" frequency="7" timeframe="900">
	<if_matched_sid>111564</if_matched_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Multiple application control protocol enforcement from same source.</description>
	<info type="text">
		Description: This rule triggers when the Fortigate detects multiple application control protocol enforcement actions from the same source IP address. It means that within a 900-second timeframe, the same source has attempted to use or access multiple applications that violate predefined protocol rules, triggering enforcement actions at least 7 times.
	</info>
	<mitre>
	<id>T1071.001</id>
	<id>T1071</id>
	</mitre>
<group>medium,aggregation,s-a,command-and-control,application,T1071.001,T1071,protocol,</group>
</rule>  
      

<rule id="111589" level="2" frequency="7" timeframe="900">
		<if_matched_sid>111567</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple Web application firewall erased application by signature from same source.</description>
		<info type="text">
Description: This rule triggers when the FortiGate Web Application Firewall (WAF) detects and blocks the same application from a single source multiple times using a predefined signature within a specified timeframe. It is triggered because the source attempted to access or exploit a web application in a way that matches known malicious patterns, leading to the application being blocked 7 times within 900 seconds. This behavior suggests a potential attack or misuse that needs investigation.
</info>
		<mitre>
			<id>T1190</id>
		</mitre>
		<group>medium,aggregation,s-a,T1190,waf,initial-access,application,</group>
	</rule>

	<rule id="111593" level="2" frequency="8" timeframe="900">
		<if_matched_sid>111575</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple web application firewall blocked application by URL access from same source with frequency 8 within timeframe 900.</description>
		<info type="text">
    Description: This rule detects when multiple web application firewall blocks occur due to URL access attempts from the same source within a specified time. The rule is triggered when eight or more blocks happen within 900 seconds, indicating potential unauthorized or suspicious activity.
</info>
		<group>medium,aggregation,soar-alert,block,waf,application,T1190,initial-access,</group>
		<mitre>
			<id>T1190</id>
		</mitre>
	</rule>

	<rule id="111595" level="2" frequency="5" timeframe="900">
		<if_matched_sid>111594</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple SSL VPN login failures.</description>
		<info type="text">
    Description: This rule is triggered when a login attempt to the SSL VPN fails, indicating possible issues with authentication credentials or potential unauthorized access attempts.
    </info>
		<mitre>
			<id>T1133</id>
		</mitre>
		<group>high,aggregation,s-a,T1133,initial-access,ssl,authentication,login,failure,</group>
	</rule>

<rule id="111633" level="2" frequency="60" timeframe="45">
		<if_matched_sid>111601</if_matched_sid>
		<field name="severity" type="pcre2">(?i)^info$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111642" level="2" frequency="60" timeframe="45">
		<if_matched_sid>111601</if_matched_sid>
		<field name="severity" type="pcre2">(?i)^low$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

<rule id="111641" level="2" frequency="60" timeframe="45">
		<if_matched_sid>111605</if_matched_sid>
		<field name="severity" type="pcre2">(?i)^info$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,inbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111645" level="2" frequency="60" timeframe="45">
		<if_matched_sid>111605</if_matched_sid>
		<field name="severity" type="pcre2">(?i)^low$</field>
		<description>FortiGate: Attack detected by UDP/TCP signature.</description>
		<info type="text">
Description: This rule triggers when a network attack is detected by a Fortigate device through a specific UDP or TCP signature. The rule is activated when the pattern of traffic matches known attack signatures, indicating potential malicious activity targeting or originating from the monitored network.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,inbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

<rule id="111648" level="2" frequency="60" timeframe="45">
		<if_matched_sid>111610</if_matched_sid>
		<field name="severity" type="pcre2">(?i)^info$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111646" level="2" frequency="60" timeframe="45">
		<if_matched_sid>111610</if_matched_sid>
		<field name="severity" type="pcre2">(?i)^low$</field>
		<description>FortiGate: Attack detected by UCP/TCP/ICMP anomaly.</description>
		<info type="text">
Description: This rule detects anomalies in UDP, TCP, or ICMP traffic patterns. It triggers when the number of anomalies within the specified timeframe exceeds the set frequency, indicating a potential attack that deviates from normal traffic behavior.
</info>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<group>low,aggregation,outbound,signature,malicious,allow,T1095,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

<rule id="111650" level="2" frequency="3" timeframe="300">
		<if_matched_sid>111649</if_matched_sid>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<description>FortiGate: Multiple local user has been added from same source address.</description>
		<info type="text">
    Description: Multiple user accounts have been created from the same source address, which could indicate an attempt to establish unauthorized access or escalate privileges within the network. This activity should be reviewed to determine if it aligns with expected behavior or if further investigation is warranted.
    </info>
		<group>high,aggregation,soar-alert,master,success,T1136.001,T1136,persistence,</group>
		<mitre>
			<id>T1136.001</id>
			<id>T1136</id>
		</mitre>
	</rule>

<rule id="111652" level="2" frequency="3" timeframe="300">
		<if_matched_sid>111651</if_matched_sid>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<description>FortiGate: Multiple user has been changed.</description>
		<info type="text">
    Description: This alert is triggered when changes are detected in multiple user accounts within a specific time frame. The modifications could include changes to account details, permissions, or roles, which may indicate unauthorized access or an internal process. The alert helps in monitoring and mitigating potential security risks associated with unauthorized changes to user accounts.
    </info>
		<group>medium,aggregation,soar-alert,master,success,change,T1098,persistence,</group>
		<mitre>
			<id>T1098</id>
		</mitre>
	</rule>

<rule id="111654" level="2" frequency="3" timeframe="300">
		<if_matched_sid>111653</if_matched_sid>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<description>FortiGate: Multiple guest users has been deleted.</description>
		<info type="text">
    Description: This alert indicates that multiple guest user accounts have been deleted from the system. This action could be part of routine account maintenance or could signify unauthorized activity. Further investigation is recommended to ensure it aligns with expected administrative actions.
    </info>
		<group>medium,aggregation,soar-alert,master,success,T1531,impact,</group>
		<mitre>
			<id>T1531</id>
		</mitre>
	</rule>

<rule id="111656" level="2" frequency="3" timeframe="300">
		<if_matched_sid>111655</if_matched_sid>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<description>FortiGate: Multiple guest users has been added.</description>
		<info type="text">
    Description: This alert indicates that several new guest user accounts have been created or added to the system. It may require verification to ensure the additions are legitimate and authorized.
    </info>
		<group>medium,aggregation,soar-alert,master,success,T1136,persistence,</group>
		<mitre>
			<id>T1136</id>
		</mitre>
	</rule>

<!-- FortiGate: Multiple firewall configuration change events occured. -->
	<rule id="111658" level="2" timeframe="120" frequency="3">
		<if_matched_sid>111662</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>FortiGate: Multiple firewall configuration change events occured.</description>
		<info type="text">
    Description: Several events involving changes to firewall configurations have been detected. This includes modifications to rules, policies, or settings that could impact network security. Review the changes to ensure they align with security policies and operational requirements.
    </info>
		<group>medium,aggregation,soar-alert,configuration,change,master,policy,T1562.004,T1562,defense-evasion,</group>
		<mitre>
			<id>T1562.004</id>
			<id>T1562</id>
		</mitre>
	</rule>


	<!--: Multiple Admin Login Failed from same source ip. -->
	<rule id="111666" level="2" timeframe="3600" frequency="3">
		<if_matched_sid>111665</if_matched_sid>
		<description>FortiGate: Multiple admin login failed.</description>
		<info type="text">
    Description: This rule triggers when multiple failed admin login attempts are detected within a specified time, indicating potential unauthorized access attempts or brute-force activity. The rule monitors for 3 failed login attempts within a 1-hour period (3600 seconds).
    </info>
		<same_field>src_ip</same_field>
		<same_field>method</same_field>
		<same_field>tenant</same_field>
		<same_field>device_id</same_field>
		<mitre>
			<id>T1078</id>
		</mitre>
		<group>medium,aggregation,soar-alert,login,authentication,failure,defense-evasion,T1078,kalupur,</group>
	</rule>

	<!--: Multiple Admin Login Failed from same user. -->
	<rule id="111667" level="2" timeframe="3600" frequency="3">
		<if_matched_sid>111665</if_matched_sid>
		<description>FortiGate: Multiple admin login failed.</description>
		<info type="text">
    Description:  Description: This rule triggers when multiple failed admin login attempts are detected within a specified time, indicating potential unauthorized access attempts or brute-force activity. The rule monitors for 3 failed login attempts within a 1-hour period (3600 seconds).
    </info>
		<same_field>method</same_field>
		<same_field>tenant</same_field>
		<same_field>dstuser</same_field>
		<same_field>device_id</same_field>
		<mitre>
			<id>T1110</id>
			<id>T1078</id>
		</mitre>
		<group>medium,aggregation,soar-alert,login,authentication,failure,T1110,credential-access,defense-evasion,T1078,kalupur,</group>
	</rule>
	
	<!-- Fortigate: Multiple traffic blocked detected. -->
	<rule id="111673" level="2" frequency="10" timeframe="100">
		<if_matched_sid>111672</if_matched_sid>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<description>Fortigate: Multiple traffic blocked.</description>
		<info type="text">
    Description: This alert is triggered when multiple instances of traffic are blocked by the security policy within a 100-second. The frequency threshold for this alert is set to 10 blocked traffic events, indicating potential network issues or suspicious activity.
    </info>
		<group>medium,aggregation,s-a,T1498,block,impact,</group>
		<mitre>
			<id>T1498</id>
		</mitre>
	</rule>



	<!-- spray of outbound suspected command and control (C2) traffic via UDP port-->
	<rule id="111680" level="2" timeframe="5" frequency="500">
		<if_matched_sid>111679</if_matched_sid>
		<same_field>src_ip</same_field>
		<different_field>dst_ip</different_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Spray of suspected outbound command and control (C2) traffic via UDP port.</description>
		<info type="text">
    Description: A pattern of outbound traffic detected over UDP port indicative of potential command and control (C2) communications. This may suggest unauthorized remote management or control attempts.
    </info>
		<group>medium,aggregation,soar-alert,outbound,T1095,protocol,detect,command-and-control,</group>
		<mitre>
			<id>T1095</id>
		</mitre>
	</rule>

	<rule id="111783" level="2" frequency="6" timeframe="1200">
		<if_matched_sid>111782</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple successful firewall logouts from the same source.</description>
		<mitre>
			<id>T1098</id>
		</mitre>
		<info>
        Description: Description: This alert is triggered when a single source logs out of the firewall multiple times within a short period. Specifically, 18 logout events occurred within 45 seconds from the same source. After this alert, no further logouts from this source will be considered for 240 seconds. This could indicate either normal behavior or a potential issue like repeated disconnections or logout attempts.
    </info>
		<group>medium,aggregation,s-a,T1098,persistence,</group>
	</rule>

	<rule id="111787" level="2" frequency="5" timeframe="30">
		<if_matched_sid>111786</if_matched_sid>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple user disconnected from same source.</description>
		<mitre>
			<id>T1133</id>
		</mitre>
		<info>
        Description: This alert indicates that several users connected from the same source IP address have been disconnected from the network, possibly due to network instability, session timeout, or policy enforcement.
    </info>
		<group>low,aggregation,s-a,T1133,persistence,</group>
	</rule>

	<!-- tenant : porter -->
	<rule id="111790" level="2" frequency="2" timeframe="120">
	<if_matched_sid>111594</if_matched_sid>
	<same_field>dstip</same_field>
	<different_field>dstuser</different_field>
	<field name="tenant" type="pcre2">(?i)porter</field>
	<description>Fortigate: Multiple SSL VPN login failures.</description>
	<info type="text">
    Description: This rule is triggered when a login attempt to the SSL VPN fails, indicating possible issues with authentication credentials or potential unauthorized access attempts.
    </info>
	<mitre>
	<id>T1133</id>
	</mitre>
	<group>high,aggregation,s-a,T1133,initial-access,ssl,authentication,login,failure,porter,</group>
	</rule>

<!--corelation-->

	<!-- Virus-Infected File Blocked with DLP Detection -->
<rule id="111798" level="2" timeframe="30">
	<if_matched_sid>111689</if_matched_sid>
	<if_sid>111517,111799</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Virus infected file blocked with DLP detection.</description>
	<info type="text"> Description: This alert indicates that a file containing a virus was detected and blocked by the Data Loss Prevention (DLP) system. The DLP detected that the file, potentially containing sensitive or harmful content, was attempting to move across the network or was part of an outbound communication. The combination of virus detection and DLP enforcement prevented the file from spreading or leaking sensitive information.
        </info>
	<mitre>
		<id>T1204.001</id>
		<id>T1204</id>
		<id>TA0010</id>
	</mitre>
	<group>critical,correlation,s-a,file,virus,malicious,T1204.001,T1204,TA0010,malicious,exfiltration,</group>
</rule>

<!-- login success -> tunnel up -->
<rule id="111800" level="2" timeframe="1000">
	<if_matched_sid>111507</if_matched_sid>
	<if_sid>111784</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Successful login followed by VPN tunnel activation detected.</description>
	<info type="text"> Description: This alert indicates that a file containing a virus was detected and blocked by the Data Loss Prevention (DLP) system. The DLP detected that the file, potentially containing sensitive or harmful content, was attempting to move across the network or was part of an outbound communication. The combination of virus detection and DLP enforcement prevented the file from spreading or leaking sensitive information.
        </info>
	<mitre>
		<id>T1078</id>
		<id>T1133</id>
	</mitre>
	<group>critical,correlation,s-a,authentication,vpn,T1078,defense-evasion,ssl,T1133,initial-access,login,failure,</group>
</rule>

<!-- Malicious Traffic Blocked After Network Attack Detected -->
<rule id="111801" level="2" timeframe="30">
	<if_matched_sid>111600</if_matched_sid>
	<if_sid>111519</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Malicious traffic blocked after network attack detected.</description>
	<info type="text"> Description: This rule detects and blocks malicious network traffic that occurs after a network attack is identified by a FortiGate device. It correlates events such as attack detection via UDP/TCP signatures and the subsequent traffic being blocked due to infection detected by the ICAP server.
        </info>
	<mitre>
		<id>T1204.002</id>
		<id>T1204</id>
		<id>T1095</id>
	</mitre>
	<group>critical,correlation,s-a,server,T1204.002,T1204,execution,signature,ips,malicious,T1095,command-and-control,</group>
</rule>

<!-- Successful admin login followed by firewall configuration change -->
<rule id="111802" level="2" timeframe="900">
	<if_matched_sid>111507</if_matched_sid>
	<if_sid>111662,111663</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Successful admin login followed by firewall configuration change.</description>
	<info type="text"> Description: This correlation rule triggers when a successful admin login is immediately followed by a firewall configuration change, indicating potential unauthorized or unexpected changes to the firewall settings.
        </info>
	<mitre>
		<id>T1562.004</id>
		<id>T1562</id>
		<id>T1078</id>
	</mitre>
	<group>critical,correlation,s-a,T1562.004,T1562,defense-evasion,change,policy,login,authentication,successful,T1078,defence-evasion,</group>
</rule>


<!-- SSL VPN Tunnel Established with DLP Data Leak Detection. -->
<rule id="111806" level="2" timeframe="60">
	<if_matched_sid>111784</if_matched_sid>
	<if_sid>111517,111799</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: SSL VPN tunnel established with DLP data leak detection.</description>
	<info type="text">Description: This alert indicates that an SSL VPN tunnel has been successfully established, accompanied by a data leak detected by a specified Data Loss Prevention (DLP) sensor rule. This combination of events suggests potential unauthorized data transmission over the VPN connection, warranting immediate investigation.
        </info>
	<mitre>
		<id>TA0010</id>
		<id>T1071</id>
		<id>T1071.001</id>
		<id>T1102</id>
		<id>T1078</id>
	</mitre>
	<group>high,correlation,s-a,exfiltration,TA0010,authentication,vpn,T1078,defence-evasion,T1102,defense-evasion,ssl,vpn,T1071,T1071.001,command-control,</group>
</rule>

<!-- Interface status change with traffic violation detected. -->
<rule id="111810" level="2" timeframe="30">
	<if_matched_sid>111664</if_matched_sid>
	<if_sid>111732</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Interface status change with traffic violation detected.</description>
	<info type="text">Description: A deleted user account was used in multiple failed login attempts. This could indicate an unauthorized access attempt or an issue with account management. Investigate the source of the login attempts and ensure the account is properly deactivated.
        </info>
	<mitre>
		<id>T1016</id>
		<id>T1205</id>
		<id>T1562</id>
		<id>T1562.004</id>
	</mitre>
	<group>high,correlation,s-a,local,T1205,defense-evasion,T1562,T1562.004,T1016,discovery,change,policy,</group>
</rule>

<!-- Executable File Detected in Email Attachment with Virus Blocked by Antivirus Engine. -->
<rule id="111811" level="2" timeframe="30">
	<if_matched_sid>111638</if_matched_sid>
	<if_sid>111682</if_sid>
	<same_field>tenant</same_field>
	<description>Fortigate: Executable file detected in email attachment with virus blocked by antivirus engine.</description>
	<info type="text">Description: An executable file was detected in an email attachment, followed by the identification and blocking of a virus by the antivirus engine, preventing potential infection.
        </info>
	<mitre>
		<id>T1204.002</id>
		<id>T1204</id>
	</mitre>
	<group>critical,correlation,s-a,T1204.002,T1204,execution,malicious,</group>
</rule>


<!-- moniter rule -->
	<rule id="111807" level="2">
		<if_sid>111594</if_sid>
		<match type="pcre2">(?i)aggregationParameter=aggregationAlert</match>
		<field name="tenant" type="pcre2">(?i)porter</field>
		<description>Fortigate: Multiple SSL VPN login failure.</description>
		<info type="text">
    Description: This rule is triggered when a login attempt to the SSL VPN fails, indicating possible issues with authentication credentials or potential unauthorized access attempts.
	</info>
			<mitre>
				<id>T1133</id>
			</mitre>
		<group>high,aggregation,s-a,T1133,initial-access,ssl,authentication,login,failure,</group>
		</rule>


<!-- Unauthorized application use and attempt to access a restricted URL. -->
<rule id="111803" level="2" timeframe="30">
	<if_matched_sid>111564</if_matched_sid>
	<if_sid>111553</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Unauthorized application use and attempt to access a restricted url.</description>
	<info type="text"> Description: The alert triggered due to unauthorized application use and attempts to access restricted URLs, indicating potential policy violations, malicious intent, or misconfigured security settings. It may also result from the use of unapproved software, detection of threat-related traffic patterns, or accidental actions by legitimate users.
        </info>
	<mitre>
		<id>T1071</id>
		<id>T1071.001</id>
		<id>T1102</id>
	</mitre>
	<group>critical,correlation,s-a,T1102,command-and-control,services,application,T1071.001,T1071,protocol,</group>
</rule>		

<!-- ================================================================================================================================================================================================================================================= -->

<!--Level 3 rules -->
	<rule id="111643" level="3" timeframe="120">
		<if_matched_sid>111667</if_matched_sid>
		<if_sid>111507</if_sid>
		<same_field>method</same_field>
		<same_field>dstuser</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple administrator authentication failure followed by successful login from same user.</description>
		<info type="text">
    Description: The system detected a successful admin login following five consecutive failed login attempts by the same user. This may indicate a possible brute force attempt or password guessing, requiring further investigation.
    </info>
		<mitre>
			<id>T1110</id>
			<id>T1078</id>
		</mitre>
		<group>critical,correlation,soar-alert,authentication,login,failure,T1110,credential-access,defense-evasion,T1078,</group>
	</rule>

	<rule id="111644" level="3" timeframe="120">
		<if_matched_sid>111666</if_matched_sid>
		<if_sid>111507</if_sid>
		<same_field>method</same_field>
		<same_field>src_ip</same_field>
		<same_field>tenant</same_field>
		<description>Fortigate: Multiple administrator authentication failure followed by successful login from same IP.</description>
		<info type="text">
    Description: This alert is triggered when an admin login is successful after five consecutive failed login attempts from the same IP address. This pattern may indicate a potential brute force attack or credential stuffing attempt. Immediate review is recommended to verify the legitimacy of the login.
    </info>
		<mitre>
			<id>T1110</id>
			<id>T1078</id>
		</mitre>
		<group>critical,correlation,soar-alert,authentication,login,failure,T1110,credential-access,defense-evasion,T1078,</group>
	</rule>

	<!--correlation Fortigate: Successful connection from internet IP after repetitive blocks in firewall -->
	<rule id="111675" level="3" timeframe="300">
		<if_matched_sid>111673</if_matched_sid>
		<if_sid>111674</if_sid>
		<same_field>tenant</same_field>
		<same_field>src_ip</same_field>
		<description>Fortigate: Successful connection from internet IP after repetitive blocks.</description>
		<info type="text">
    Description: This alert is triggered when a connection from an internet IP address is successfully established after multiple prior block attempts. This may indicate a persistent attacker who has bypassed security measures, or it could be a legitimate user finally passing the security checks. Further investigation is required to determine the nature of the successful connection.
    </info>
		<group>high,correlation,soar-alert,credential-access,detect,T1110,connection,kalupur,</group>
		<mitre>
			<id>T1110</id>
		</mitre>
	</rule>

	
<!-- Fortigate: Multiple SSL VPN login fail followed by login success. -->
	<rule id="111794" level="3" timeframe="120">
		<if_matched_sid>111790</if_matched_sid>
		<if_sid>111507</if_sid>
		<same_field>dstip</same_field>
		<field name="tenant" type="pcre2">(?i)porter</field>
		<description>Fortigate: Multiple SSL VPN login fail followed by login success.</description>
		<info type="text">
		Description: Detects multiple failed SSL VPN login attempts followed by a successful login, indicating potential brute force or unauthorized access attempts.
		</info>
		<mitre>
		<id>T1133</id>
		</mitre>
		<group>medium,correlation,s-a,T1133,initial-access,ssl,authentication,login,porter,</group>
	</rule>

	
<!-- Potential Unauthorized Firewall Configuration Change After Failed Login Attempts -->
<rule id="111797" level="3" timeframe="900">
	<if_matched_sid>111666</if_matched_sid>
	<if_sid>111662</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Potential unauthorized firewall configuration change after failed login attempts.</description>
	<info type="text"> Description: This alert indicates that a firewall configuration may have been altered following a series of failed login attempts. The failed logins suggest an unauthorized user may have tried to gain access, potentially succeeding in bypassing security controls, leading to changes in the firewall configuration. Such changes can compromise the firewall’s integrity, exposing the network to various security risks.
    </info>
	<mitre>
		<id>T1110</id>
		<id>T1078</id>
		<id>T1562.004</id>
		<id>T1562</id>
	</mitre>
	<group>critical,correlation,s-a,authentication,login,failure,defense-evasion,T1078,T1562.004,T1562,T1110,brute-force,configuration,unauthorized-access,suspicious-behaviour,</group>
</rule>

<!-- multiple application control port enforcements followed by outgoing ICMP attacks detected. -->
<rule id="111813" level="3" timeframe="120">
	<if_matched_sid>111586</if_matched_sid>
	<if_sid>111531,111532,111533,111534,111535</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Multiple application control port enforcements followed by outgoing ICMP attacks detected.</description>
	<info type="text"> Description: This alert indicates that a firewall configuration may have been altered following a series of failed login attempts. The failed logins suggest an unauthorized user may have tried to gain access, potentially succeeding in bypassing security controls, leading to changes in the firewall configuration. Such changes can compromise the firewall’s integrity, exposing the network to various security risks.
    </info>
	<mitre>
		<id>T1110</id>
		<id>T1078</id>
		<id>T1562.004</id>
		<id>T1562</id>
	</mitre>
	<group>critical,correlation,s-a,authentication,login,failure,defense-evasion,T1078,T1562.004,T1562,T1110,brute-force,configuration,unauthorized-access,suspicious-behaviour,</group>
</rule>	

<!-- ==================================================================================================================================================================================================== -->

<!--LEVEL 4-->
<!-- Repeated admin login failures followed by successful access and user addition detected. -->
<rule id="111804" level="4" timeframe="30">
	<if_matched_sid>111644</if_matched_sid>
	<if_sid>111780</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Repeated admin login failures followed by successful access and user addition detected.</description>
	<info type="text"> Description: This alert is triggered when there are multiple consecutive failed admin login attempts within a short timeframe, followed by a successful login and a subsequent user account creation. This pattern suggests a possible brute-force attack or password guessing attempt, where an attacker manages to gain access after repeated failures. Once access is obtained, the creation of a new user account may indicate the attacker is attempting to establish persistent access or escalate privileges.
        </info>
	<mitre>
		<id>T1136.001</id>
		<id>T1136</id>
		<id>T1078</id>
		<id>T1110</id>
	</mitre>
	<group>critical,correlation,s-a,login,authentication,failure,defense-evasion,T1078,T1136.001,T1136,T1110,impact,add,</group>
</rule>

<!-- Repeated admin login failures followed by successful access and User deletion detected -->
<rule id="111805" level="4" timeframe="30">
	<if_matched_sid>111644</if_matched_sid>
	<if_sid>111778</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Repeated admin login failures followed by successful access and User deletion detected.</description>
	<info type="text"> Description: This alert is triggered when there are multiple failed admin login attempts, followed by a successful login, and then a user account is deleted. This pattern may indicate potential unauthorized access or malicious activity after gaining access to the system.
        </info>
	<mitre>
		<id>T1136.001</id>
		<id>T1136</id>
		<id>T1078</id>
		<id>T1531</id>
		<id>T1110</id>
	</mitre>
	<group>high,correlation,s-a,login,authentication,failure,defense-evasion,T1078,T1531,T1136.001,T1136,T1110,impact,delete,</group>
</rule>


<!-- Admin Login Failures Followed by Successful Access and Configuration Changes Detected. -->
<rule id="111812" level="4" timeframe="100">
	<if_matched_sid>111644</if_matched_sid>
	<if_sid>111662</if_sid>
	<same_field>src_ip</same_field>
	<same_field>tenant</same_field>
	<description>Fortigate: Admin login failures followed by successful access and configuration changes detected.</description>
	<info type="text"> Description: This alert indicates that a firewall configuration may have been altered following a series of failed login attempts. The failed logins suggest an unauthorized user may have tried to gain access, potentially succeeding in bypassing security controls, leading to changes in the firewall configuration. Such changes can compromise the firewall’s integrity, exposing the network to various security risks.
    </info>
	<mitre>
		<id>T1110</id>
		<id>T1078</id>
		<id>T1562.004</id>
		<id>T1562</id>
	</mitre>
	<group>critical,correlation,s-a,authentication,login,failure,defense-evasion,T1078,T1562.004,T1562,T1110,brute-force,configuration,unauthorized-access,suspicious-behaviour,</group>
</rule>

</group>